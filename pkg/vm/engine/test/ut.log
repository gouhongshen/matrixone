2024/11/25 18:21:43.513387 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:21:43.514328 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:21:43.518838 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "250ns"}
2024/11/25 18:21:43.518932 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "231.584µs", "checkpointed": "0-0"}
2024/11/25 18:21:43.519032 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "3.75µs"}
2024/11/25 18:21:43.519147 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:21:43.519182 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:21:43.519231 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:21:43.519308 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "335.125µs"}
2024/11/25 18:21:43.519470 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:21:43.519632 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "5.938834ms", "err": null}
2024/11/25 18:21:43.519663 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:21:43.519691 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:21:43.519760 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "154.417µs"}
2024/11/25 18:21:43.519806 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "143.708µs"}
2024/11/25 18:21:43.519863 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:21:43.519960 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "99.542µs"}
2024/11/25 18:21:43.520009 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2"}
2024/11/25 18:21:43.520020 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "157.625µs"}
2024/11/25 18:21:43.519841 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:21:43.520308 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:43.520438 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:21:43.520564 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:21:43.520630 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:21:43.520663 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:21:43.520740 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "87.833µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:21:43.520788 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "128.5µs"}
2024/11/25 18:21:43.520929 +0800 INFO logtail/mgr.go:169 init waterline to 1732530103520691000-0
2024/11/25 18:21:43.521119 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "to": "PhysicalTime:1732530103520691000 "}
2024/11/25 18:21:43.521455 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:21:43.521656 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc000825a40"}
2024/11/25 18:21:43.521832 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc000825cc0"}
2024/11/25 18:21:43.521880 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc000ca19a0"}
2024/11/25 18:21:43.625438 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:21:43.625580 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:21:43.626247 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": ""}
2024/11/25 18:21:43.626367 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:21:43.626984 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530103624691000-0", "minTs": "0-0"}
2024/11/25 18:21:43.627127 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530103624691000 "}
2024/11/25 18:21:43.627455 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:43.627573 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:21:43.628223 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:21:43.628487 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530103626859000-0", "minTs": "0-0"}
2024/11/25 18:21:43.628559 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530103626859000 "}
2024/11/25 18:21:43.628733 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:43.628794 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:21:43.629339 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:21:43.629666 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530103628661000-0", "minTs": "0-0"}
2024/11/25 18:21:43.629756 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530103628661000 "}
2024/11/25 18:21:43.629984 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:43.630063 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:21:43.640842 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:21:43.643904 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:21:43.645779 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef326ff802b/Active/S:1732530103628661000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc004d14000"}
2024/11/25 18:21:43.647862 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:21:43.647914 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530103628661000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:43.647984 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:43.678829 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF326FF802A][1732530103628661000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:21:43.677442 UTC}"}
2024/11/25 18:21:43.679517 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF326FF802A][1732530103628661000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:21:43.694568 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "15.824ms", "cn-txn": "cbf29ce484222325180b2ef326ff802a/Active/S:1732530103628661000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF326FF802A][1732530103628661000-1->1732530103680911000-0][Committed]: <nil>"}
2024/11/25 18:21:44.710538 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:21:44.712991 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530104712638000 "}
2024/11/25 18:21:44.713598 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc004eb77c0"}
2024/11/25 18:21:44.714142 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc00023f830
2024/11/25 18:21:44.731278 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:21:44.743721 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:21:44.748861 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:21:44.754404 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:21:44.754504 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:21:44.754803 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:44.754869 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:21:44.754877 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:44.754959 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:21:44.754990 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:21:44.754899 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:21:44.755116 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:21:44.755188 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:21:44.755238 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:21:44.757196 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:21:44.757885 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:21:44.762238 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "459ns"}
2024/11/25 18:21:44.762302 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "114.958µs", "checkpointed": "0-0"}
2024/11/25 18:21:44.762379 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "8.417µs"}
2024/11/25 18:21:44.762456 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:21:44.762498 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:21:44.762538 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:21:44.762581 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "233.25µs"}
2024/11/25 18:21:44.762716 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:21:44.762832 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:21:44.762864 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "5.569959ms", "err": null}
2024/11/25 18:21:44.762881 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:21:44.762950 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "134.083µs"}
2024/11/25 18:21:44.762997 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "162.083µs"}
2024/11/25 18:21:44.763014 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:21:44.763037 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:21:44.763094 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "59.542µs"}
2024/11/25 18:21:44.763151 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "113.375µs"}
2024/11/25 18:21:44.763157 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c"}
2024/11/25 18:21:44.763423 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:44.763723 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:21:44.763794 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:21:44.763860 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:21:44.763859 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:21:44.763920 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "62.5µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:21:44.763970 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "112.208µs"}
2024/11/25 18:21:44.764277 +0800 INFO logtail/mgr.go:169 init waterline to 1732530104764188000-0
2024/11/25 18:21:44.764336 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:21:44.764380 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "to": "PhysicalTime:1732530104764188000 "}
2024/11/25 18:21:44.764420 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0059c4780"}
2024/11/25 18:21:44.764474 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0059c4820"}
2024/11/25 18:21:44.764517 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0059c48c0"}
2024/11/25 18:21:44.867363 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:21:44.867453 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:21:44.867804 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": ""}
2024/11/25 18:21:44.867911 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:21:44.868208 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530104866321000-0", "minTs": "0-0"}
2024/11/25 18:21:44.868294 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530104866321000 "}
2024/11/25 18:21:44.868739 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:44.868828 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:21:44.869891 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:21:44.870117 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530104868171000-0", "minTs": "0-0"}
2024/11/25 18:21:44.870194 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530104868171000 "}
2024/11/25 18:21:44.870392 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:44.870455 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:21:44.870921 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:21:44.871134 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530104870127000-0", "minTs": "0-0"}
2024/11/25 18:21:44.871203 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530104870127000 "}
2024/11/25 18:21:44.871367 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:44.871425 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:21:44.876198 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:21:44.878335 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:21:44.880216 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef37117ea3b/Active/S:1732530104870127000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0075c00a0"}
2024/11/25 18:21:44.882501 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:21:44.882551 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530104870127000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:44.882616 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:44.919879 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF37117EA3A][1732530104870127000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:21:44.918624 UTC}"}
2024/11/25 18:21:44.920296 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF37117EA3A][1732530104870127000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:21:44.928831 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "9.0105ms", "cn-txn": "cbf29ce484222325180b2ef37117ea3a/Active/S:1732530104870127000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF37117EA3A][1732530104870127000-1->1732530104921417000-0][Committed]: <nil>"}
2024/11/25 18:21:44.935814 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-1]16385-test1", "extra-info": {"a-objs": "ba59e7ba5ce8_0,", "a-tombstones": "19996efb354d_0,"}, "txn-info": "ctx[019362D76A677A739A57A55C5755875B][1732530104934320000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:21:44.936312 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-1]16385-test1", "sort-key": "mock_0"}
2024/11/25 18:21:44.952739 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-1]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:21:44.964580 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-1]16385-test1", "aobj-deletes": 1, "aobj-merge-rows": 9, "tombstone-rows": 1, "duration": "28.639292ms", "extra-info": {"a-objs": "ba59e7ba5ce8_0,", "a-tombstones": "19996efb354d_0,", "to-objs": "705257a49579_0,", "to-tombstones": "7698614fe857_0,"}}
2024/11/25 18:21:45.968047 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:21:45.969960 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530105968142000 "}
2024/11/25 18:21:45.970489 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc00795cbe0"}
2024/11/25 18:21:45.971002 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0071cc1b0
2024/11/25 18:21:46.016912 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:21:46.032361 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:21:46.037559 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:21:46.043146 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:21:46.043290 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:21:46.045994 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:46.045997 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:21:46.046095 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:21:46.046092 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:21:46.046048 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:46.046203 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:21:46.046130 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:21:46.056555 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:21:46.057396 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:21:46.063474 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "458ns"}
2024/11/25 18:21:46.063609 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "221.916µs", "checkpointed": "0-0"}
2024/11/25 18:21:46.063700 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.125µs"}
2024/11/25 18:21:46.063804 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:21:46.063855 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:21:46.063894 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:21:46.063958 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "290.708µs"}
2024/11/25 18:21:46.064068 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:21:46.064211 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "7.548083ms", "err": null}
2024/11/25 18:21:46.064443 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5"}
2024/11/25 18:21:46.064653 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:46.065772 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:21:46.065781 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:21:46.065778 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:21:46.065819 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:21:46.066000 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "248.083µs"}
2024/11/25 18:21:46.066072 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "297.959µs"}
2024/11/25 18:21:46.066126 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:21:46.066121 +0800 INFO logtail/mgr.go:169 init waterline to 1732530106065973000-0
2024/11/25 18:21:46.066169 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "50.5µs"}
2024/11/25 18:21:46.066106 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc004d641e0"}
2024/11/25 18:21:46.066250 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "to": "PhysicalTime:1732530106065973000 "}
2024/11/25 18:21:46.066220 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "94.25µs"}
2024/11/25 18:21:46.066308 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc004d64280"}
2024/11/25 18:21:46.066441 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc004d64320"}
2024/11/25 18:21:46.066645 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:21:46.066717 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:21:46.066782 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:21:46.066790 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:21:46.067201 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "417.25µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:21:46.067264 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "477.292µs"}
2024/11/25 18:21:46.171966 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:21:46.172199 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:21:46.172661 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": ""}
2024/11/25 18:21:46.172756 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:21:46.173044 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530106171533000-0", "minTs": "0-0"}
2024/11/25 18:21:46.173171 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530106171533000 "}
2024/11/25 18:21:46.173429 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:46.173525 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:21:46.173673 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:21:46.173921 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530106173367000-0", "minTs": "0-0"}
2024/11/25 18:21:46.174043 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530106173367000 "}
2024/11/25 18:21:46.174251 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:46.174325 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:21:46.174827 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:21:46.175037 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530106173367000-0", "minTs": "0-0"}
2024/11/25 18:21:46.175118 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530106173367000 "}
2024/11/25 18:21:46.175329 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:46.175403 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:21:46.179822 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:21:46.181993 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:21:46.184477 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef3bea723ba/Active/S:1732530106173367000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc006c42460"}
2024/11/25 18:21:46.186896 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:21:46.186947 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530106173367000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:46.187025 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:49.233223 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF3BEA723BB][1732530109231547000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:21:49.231845 UTC}"}
2024/11/25 18:21:49.233670 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF3BEA723BB][1732530109231547000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:21:49.240064 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.901208ms", "cn-txn": "cbf29ce484222325180b2ef3bea723bb/Active/S:1732530109231547000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF3BEA723BB][1732530109231547000-1->1732530109234703000-0][Committed]: <nil>"}
2024/11/25 18:21:50.280823 +0800 INFO txnimpl/cmdmgr.go:68 BIG-TXN {"wal-size": 35073932, "lsn": 0, "txn": "ctx[019362D77B38734FB324DF8C232B7699][1732530109239546000-0->1732530109598241000-0][Preparing]: <nil>"}
2024/11/25 18:21:50.548343 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-4]16385-test1", "extra-info": {"a-objs": "02f7b3c8e414_0,a9ca73092c2c_0,f910041621a3_0,c506a44463f0_0,9bb1e7c25155_0,8b43647f8759_0,a81140911644_0,ca914102ff52_0,4afed1d978a5_0,2de38d742579_0,221740fa4a07_0,f2cad3c59dde_0,0e1bbf782f6f_0,29daa9a85408_0,e21ca6e1f138_0,2227ef31ac09_0,4de82aad2a30_0,7ddca4bb12c2_0,30d98ebc6c7f_0,57aa5bdecf5c_0,", "a-tombstones": "6f99e84220b9_0,"}, "txn-info": "ctx[019362D7805471BD94F57238F304F3E2][1732530110547548000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 21}
2024/11/25 18:21:50.994085 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-4]16385-test1", "sort-key": "mock_9"}
2024/11/25 18:21:51.075818 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][389/512]: FixSizedVec[298/307] VarlenVec[91/205], Reset/Hit/totalStats:[0/(318,91)409/572]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[73/(195,67)262/262]
2024/11/25 18:21:54.731221 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:21:56.016695 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:21:56.039639 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-4]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:21:56.075375 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][370/512]: FixSizedVec[290/307] VarlenVec[80/205], Reset/Hit/totalStats:[0/(328,192)520/1429]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[73/(195,67)262/262]
2024/11/25 18:21:56.154613 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-4]16385-test1", "aobj-deletes": 20, "aobj-merge-rows": 163820, "tombstone-rows": 20, "duration": "5.606064625s", "extra-info": {"a-objs": "02f7b3c8e414_0,a9ca73092c2c_0,f910041621a3_0,c506a44463f0_0,9bb1e7c25155_0,8b43647f8759_0,a81140911644_0,ca914102ff52_0,4afed1d978a5_0,2de38d742579_0,221740fa4a07_0,f2cad3c59dde_0,0e1bbf782f6f_0,29daa9a85408_0,e21ca6e1f138_0,2227ef31ac09_0,4de82aad2a30_0,7ddca4bb12c2_0,30d98ebc6c7f_0,57aa5bdecf5c_0,", "a-tombstones": "6f99e84220b9_0,", "to-objs": "40ca4f7fbc14_0,", "to-tombstones": "ef406014615b_0,"}}
2024/11/25 18:21:57.163414 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:21:57.167630 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:9 ", "To": "PhysicalTime:1732530117165352000 "}
2024/11/25 18:21:57.168469 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc01c036460"}
2024/11/25 18:21:57.169785 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc00311e6b0
2024/11/25 18:21:57.188585 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:21:59.006710 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:21:59.011780 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:21:59.017565 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:21:59.017668 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:21:59.022809 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:21:59.022842 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:59.022851 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:21:59.022873 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:21:59.022878 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:21:59.022896 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:21:59.022912 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:21:59.022967 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:21:59.022997 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:21:59.023802 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:21:59.024433 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:21:59.030694 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "584ns"}
2024/11/25 18:21:59.030766 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "1.265625ms", "checkpointed": "0-0"}
2024/11/25 18:21:59.030854 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "5.708µs"}
2024/11/25 18:21:59.030920 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:21:59.030956 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:21:59.031005 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:21:59.031053 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "246.958µs"}
2024/11/25 18:21:59.031134 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:21:59.031219 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:21:59.031256 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "7.397375ms", "err": null}
2024/11/25 18:21:59.031269 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "60.292µs"}
2024/11/25 18:21:59.031271 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:21:59.031305 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "85.875µs"}
2024/11/25 18:21:59.031339 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:21:59.031372 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "35.583µs"}
2024/11/25 18:21:59.031365 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:21:59.031396 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "56.958µs"}
2024/11/25 18:21:59.031466 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed"}
2024/11/25 18:21:59.031502 +0800 INFO logtail/mgr.go:169 init waterline to 1732530119031447000-0
2024/11/25 18:21:59.031564 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "to": "PhysicalTime:1732530119031447000 "}
2024/11/25 18:21:59.031735 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:21:59.031782 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:59.031809 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:21:59.031861 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:21:59.031865 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:21:59.031913 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "51.083µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:21:59.031951 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "90.292µs"}
2024/11/25 18:21:59.032549 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:21:59.032599 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc02572f720"}
2024/11/25 18:21:59.032642 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc02572f7c0"}
2024/11/25 18:21:59.032676 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc02572f860"}
2024/11/25 18:21:59.135365 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:21:59.135420 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:21:59.135789 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": ""}
2024/11/25 18:21:59.135857 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:21:59.136043 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530119135459000-0", "minTs": "0-0"}
2024/11/25 18:21:59.136117 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530119135459000 "}
2024/11/25 18:21:59.136318 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:59.136392 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:21:59.136740 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:21:59.136895 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530119135459000-0", "minTs": "0-0"}
2024/11/25 18:21:59.136946 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530119135459000 "}
2024/11/25 18:21:59.137072 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:59.137110 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:21:59.137770 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:21:59.137932 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530119137484000-0", "minTs": "0-0"}
2024/11/25 18:21:59.137985 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530119137484000 "}
2024/11/25 18:21:59.138121 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:59.138163 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:21:59.142670 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:21:59.144422 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:21:59.145924 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef6c38dbfdb/Active/S:1732530119137484000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0133d0960"}
2024/11/25 18:21:59.148152 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:21:59.148189 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530119137484000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:21:59.148244 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:21:59.188791 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF6C38DBFDA][1732530119137484000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:21:59.187897 UTC}"}
2024/11/25 18:21:59.189080 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF6C38DBFDA][1732530119137484000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:21:59.193342 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "4.601041ms", "cn-txn": "cbf29ce484222325180b2ef6c38dbfda/Active/S:1732530119137484000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF6C38DBFDA][1732530119137484000-1->1732530119190023000-0][Committed]: <nil>"}
2024/11/25 18:21:59.872256 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef6c38dbfdc/Active/S:1732530119399546000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["4bea573c7b5b_0"]}
2024/11/25 18:21:59.872374 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef6c38dbfdc/Active/S:1732530119399546000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397.1KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["47ceeeab82d6_0"]}
2024/11/25 18:21:59.872442 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef6c38dbfdc/Active/S:1732530119399546000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "264.3KiB", "obj-size": "198.8KiB", "blk-cnt": 2, "row-cnt": 16384, "names": ["398646ea6e76_0"]}
2024/11/25 18:22:00.899830 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:00.901098 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530120899700000 "}
2024/11/25 18:22:00.901536 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc01765aa00"}
2024/11/25 18:22:00.901850 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc000c1cbb0
2024/11/25 18:22:00.952283 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:22:01.035319 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:01.040444 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:01.045976 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:01.046078 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:01.046324 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:01.046338 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:01.046339 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:01.046347 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:01.046423 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:01.046447 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:01.046539 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:01.046576 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:01.046608 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:01.048589 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:01.049249 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:01.054200 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "375ns"}
2024/11/25 18:22:01.054283 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "466.542µs", "checkpointed": "0-0"}
2024/11/25 18:22:01.054366 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "7.792µs"}
2024/11/25 18:22:01.054442 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:01.054479 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:01.054518 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:01.054558 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "232.417µs"}
2024/11/25 18:22:01.054683 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:01.054761 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:01.054809 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "6.161ms", "err": null}
2024/11/25 18:22:01.054815 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:01.054923 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:01.054980 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "232.791µs"}
2024/11/25 18:22:01.055018 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "257.708µs"}
2024/11/25 18:22:01.055058 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:01.055063 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c"}
2024/11/25 18:22:01.055089 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "34.917µs"}
2024/11/25 18:22:01.055119 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "61.542µs"}
2024/11/25 18:22:01.055279 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:01.055333 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:01.055377 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:01.055385 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:01.055396 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:01.055416 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "40µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:01.055461 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "83.958µs"}
2024/11/25 18:22:01.056071 +0800 INFO logtail/mgr.go:169 init waterline to 1732530121056007000-0
2024/11/25 18:22:01.056143 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "to": "PhysicalTime:1732530121056007000 "}
2024/11/25 18:22:01.056152 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:01.056207 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc013658dc0"}
2024/11/25 18:22:01.056261 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc013658e60"}
2024/11/25 18:22:01.056296 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc013658f00"}
2024/11/25 18:22:01.159545 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:01.159641 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:01.159920 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": ""}
2024/11/25 18:22:01.160036 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:01.160335 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530121159773000-0", "minTs": "0-0"}
2024/11/25 18:22:01.160416 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530121159773000 "}
2024/11/25 18:22:01.160638 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:01.160708 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:01.161040 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:01.161847 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530121159773000-0", "minTs": "0-0"}
2024/11/25 18:22:01.161921 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530121159773000 "}
2024/11/25 18:22:01.162088 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:01.162145 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:01.163187 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:01.163373 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530121161783000-0", "minTs": "0-0"}
2024/11/25 18:22:01.163444 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530121161783000 "}
2024/11/25 18:22:01.163631 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:01.163709 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:01.168114 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:01.170343 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:01.172412 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef73c2bc163/Active/S:1732530121161783000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0181dcfa0"}
2024/11/25 18:22:01.174618 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:01.174714 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530121161783000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:01.174828 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:01.211326 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF73C2BC162][1732530121161783000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:01.210300 UTC}"}
2024/11/25 18:22:01.211704 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF73C2BC162][1732530121161783000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:22:01.219059 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.801208ms", "cn-txn": "cbf29ce484222325180b2ef73c2bc162/Active/S:1732530121161783000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF73C2BC162][1732530121161783000-1->1732530121212722000-0][Committed]: <nil>"}
2024/11/25 18:22:01.434710 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-26]16385-test_reader_table", "extra-info": {"a-objs": "c1c8344f876a_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D7AADA79B4BEBFAEBCAE17785F][1732530121433981000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:01.437207 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-26]16385-test_reader_table", "sort-key": "mock_3"}
2024/11/25 18:22:01.526577 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-26]16385-test_reader_table", "aobj-deletes": 0, "aobj-merge-rows": 4096, "tombstone-rows": 0, "duration": "91.761083ms", "extra-info": {"a-objs": "c1c8344f876a_0,", "a-tombstones": "", "to-objs": "9d347da1219b_0,"}}
2024/11/25 18:22:02.035167 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef73c2bc164/Active/S:1732530121595982000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "462.5KiB", "obj-size": "348KiB", "blk-cnt": 4, "row-cnt": 28672, "names": ["8bbe42e286a0_0"]}
2024/11/25 18:22:02.035276 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef73c2bc164/Active/S:1732530121595982000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "462.5KiB", "obj-size": "348KiB", "blk-cnt": 4, "row-cnt": 28672, "names": ["a2a0f834642e_0"]}
2024/11/25 18:22:02.035352 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef73c2bc164/Active/S:1732530121595982000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "199.3KiB", "obj-size": "149.8KiB", "blk-cnt": 2, "row-cnt": 12288, "names": ["c2ed44adc489_0"]}
2024/11/25 18:22:03.087746 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:03.095000 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530123093838000 "}
2024/11/25 18:22:03.095597 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "chunk-number": 13, "chunk-limit": 16351, "message-size": 211534}
2024/11/25 18:22:03.096693 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc02572ea00"}
2024/11/25 18:22:03.146051 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc019e521b0
2024/11/25 18:22:03.164666 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "chunk-number": 13, "chunk-limit": 16351, "message-size": 209221}
2024/11/25 18:22:03.216331 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:22:03.270127 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:03.275303 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:03.280663 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:03.280743 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:03.284564 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:03.284582 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:03.284572 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:03.284582 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:03.284666 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:03.284717 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:03.284648 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:03.286512 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:03.287091 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:03.292367 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "333ns"}
2024/11/25 18:22:03.292422 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "96.541µs", "checkpointed": "0-0"}
2024/11/25 18:22:03.292485 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "4.958µs"}
2024/11/25 18:22:03.292560 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:03.292610 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:03.292644 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:03.292695 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "235.709µs"}
2024/11/25 18:22:03.292798 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:03.292922 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:03.292938 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "6.364833ms", "err": null}
2024/11/25 18:22:03.292972 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "64.791µs"}
2024/11/25 18:22:03.293005 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "87.042µs"}
2024/11/25 18:22:03.293006 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:03.293040 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:03.293071 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:03.293118 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "78µs"}
2024/11/25 18:22:03.293168 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "127.25µs"}
2024/11/25 18:22:03.293199 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b"}
2024/11/25 18:22:03.293483 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:03.293534 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:03.293580 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:03.293582 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:03.293643 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "59.75µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:03.293686 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "104.333µs"}
2024/11/25 18:22:03.293899 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:03.294642 +0800 INFO logtail/mgr.go:169 init waterline to 1732530123294553000-0
2024/11/25 18:22:03.294703 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "to": "PhysicalTime:1732530123294553000 "}
2024/11/25 18:22:03.294717 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:03.294788 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc01c0363c0"}
2024/11/25 18:22:03.294830 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc01c036460"}
2024/11/25 18:22:03.294868 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc01c0365a0"}
2024/11/25 18:22:03.397847 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:03.397930 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:03.398366 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": ""}
2024/11/25 18:22:03.398464 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:03.398730 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530123398418000-0", "minTs": "0-0"}
2024/11/25 18:22:03.398837 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530123398418000 "}
2024/11/25 18:22:03.399099 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:03.399205 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:03.399335 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:03.399602 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530123398418000-0", "minTs": "0-0"}
2024/11/25 18:22:03.399712 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530123398418000 "}
2024/11/25 18:22:03.399928 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:03.399985 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:03.400366 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:03.400584 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530123400345000-0", "minTs": "0-0"}
2024/11/25 18:22:03.400669 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530123400345000 "}
2024/11/25 18:22:03.400831 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:03.400917 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:03.405660 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:03.408115 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:03.410353 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef7c1988a1b/Active/S:1732530123400345000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc013658320"}
2024/11/25 18:22:03.413139 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:03.413197 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530123400345000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:03.413284 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:03.450369 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF7C1988A1A][1732530123400345000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:03.448831 UTC}"}
2024/11/25 18:22:03.450785 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF7C1988A1A][1732530123400345000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:03.457470 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.164208ms", "cn-txn": "cbf29ce484222325180b2ef7c1988a1a/Active/S:1732530123400345000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF7C1988A1A][1732530123400345000-1->1732530123452002000-0][Committed]: <nil>"}
2024/11/25 18:22:03.464681 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-28]16385-test1", "extra-info": {"a-objs": "aed07c3d46aa_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D7B2C57962BBC041BD5803C62D][1732530123460525000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:03.465152 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-28]16385-test1", "sort-key": "mock_0"}
2024/11/25 18:22:03.492531 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-28]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "27.744458ms", "extra-info": {"a-objs": "aed07c3d46aa_0,", "a-tombstones": "", "to-objs": "d7525debcca3_0,"}}
2024/11/25 18:22:03.492952 +0800 INFO txnentries/flushTableTail.go:270 [FLUSH-PREPARE-COMMIT] {"task": "[FT-28]16385-test1", "commit-ts": "1732530123492873000-0", "ablks": 1, "transfer-rows": 1, "in-queue-transfers": 0}
2024/11/25 18:22:04.496927 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:04.499033 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530124498359000 "}
2024/11/25 18:22:04.499668 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc00da17b80"}
2024/11/25 18:22:04.500150 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc019e52430
2024/11/25 18:22:04.545126 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:22:04.558045 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:04.563185 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:04.568957 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:04.569099 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:04.574205 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:04.574361 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:04.574342 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:04.574490 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:04.574531 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:04.574568 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:04.574624 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:04.578264 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:04.579397 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:04.590861 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "708ns"}
2024/11/25 18:22:04.590959 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "166.333µs", "checkpointed": "0-0"}
2024/11/25 18:22:04.591051 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "7.042µs"}
2024/11/25 18:22:04.591154 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:04.591226 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:04.591286 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:04.591358 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "343.292µs"}
2024/11/25 18:22:04.591543 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:04.591821 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:04.591943 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "13.561208ms", "err": null}
2024/11/25 18:22:04.591970 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "190.541µs"}
2024/11/25 18:22:04.591965 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:04.592036 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "224.083µs"}
2024/11/25 18:22:04.592088 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:04.592123 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:04.592142 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "57.375µs"}
2024/11/25 18:22:04.592198 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "110.083µs"}
2024/11/25 18:22:04.592385 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0"}
2024/11/25 18:22:04.592650 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:04.592752 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:04.592825 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:04.592870 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:04.592939 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "75.625µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:04.592957 +0800 INFO logtail/mgr.go:169 init waterline to 1732530124592843000-0
2024/11/25 18:22:04.592997 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "126.75µs"}
2024/11/25 18:22:04.593068 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "to": "PhysicalTime:1732530124592843000 "}
2024/11/25 18:22:04.593232 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:04.594230 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:04.594326 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc00f798140"}
2024/11/25 18:22:04.594393 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc00f7981e0"}
2024/11/25 18:22:04.594443 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc00f798280"}
2024/11/25 18:22:04.698481 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:04.698598 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:04.699157 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": ""}
2024/11/25 18:22:04.699276 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:04.699609 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530124698749000-0", "minTs": "0-0"}
2024/11/25 18:22:04.699723 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530124698749000 "}
2024/11/25 18:22:04.699973 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:04.700063 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:04.700956 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:04.701245 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530124700728000-0", "minTs": "0-0"}
2024/11/25 18:22:04.701358 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530124700728000 "}
2024/11/25 18:22:04.701599 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:04.701693 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:04.702064 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:04.702310 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530124700728000-0", "minTs": "0-0"}
2024/11/25 18:22:04.702415 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530124700728000 "}
2024/11/25 18:22:04.702631 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:04.702702 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:04.707555 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:04.710270 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:04.712706 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef80f0a9eab/Active/S:1732530124700728000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc00d5ce960"}
2024/11/25 18:22:04.715653 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:04.715718 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530124700728000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:04.715799 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:04.731380 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:04.791691 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF80F0A9EAA][1732530124700728000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:04.751364 UTC}"}
2024/11/25 18:22:04.792096 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF80F0A9EAA][1732530124700728000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:04.797168 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "5.5365ms", "cn-txn": "cbf29ce484222325180b2ef80f0a9eaa/Active/S:1732530124700728000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF80F0A9EAA][1732530124700728000-1->1732530124793200000-0][Committed]: <nil>"}
2024/11/25 18:22:04.803512 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-30]16385-test1", "extra-info": {"a-objs": "f712eaa41658_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D7B7FF7C58B0CB0A9614119A1C][1732530124798717000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:04.803882 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-30]16385-test1", "sort-key": "mock_0"}
2024/11/25 18:22:04.825409 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-30]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "21.806083ms", "extra-info": {"a-objs": "f712eaa41658_0,", "a-tombstones": "", "to-objs": "4d00868540da_0,"}}
2024/11/25 18:22:04.825683 +0800 INFO txnentries/flushTableTail.go:270 [FLUSH-PREPARE-COMMIT] {"task": "[FT-30]16385-test1", "commit-ts": "1732530124825630000-0", "ablks": 1, "transfer-rows": 1, "in-queue-transfers": 0}
2024/11/25 18:22:04.828636 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-32]16385-test1", "extra-info": {"a-objs": "", "a-tombstones": "e3f344693580_0,"}, "txn-info": "ctx[019362D7B81C788F8B6BB442F49A51B0][1732530124826858000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:04.828830 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-32]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:04.839858 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-32]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 2, "duration": "11.14225ms", "extra-info": {"a-objs": "", "a-tombstones": "e3f344693580_0,", "to-tombstones": "5631d589bf61_0,"}}
2024/11/25 18:22:05.841441 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:05.843588 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530125842674000 "}
2024/11/25 18:22:05.844097 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc010ee4f00"}
2024/11/25 18:22:05.844536 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc000c1d5b0
2024/11/25 18:22:05.881405 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:22:05.899592 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:05.904886 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:05.910822 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:05.910983 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:05.917219 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:05.917275 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:05.917280 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:05.917364 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:05.917350 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:05.917397 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:05.917556 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:05.920169 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:05.921402 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:05.930355 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "625ns"}
2024/11/25 18:22:05.930451 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "176.958µs", "checkpointed": "0-0"}
2024/11/25 18:22:05.930565 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "9.958µs"}
2024/11/25 18:22:05.930690 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:05.930788 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:05.930852 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:05.930932 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "415.166µs"}
2024/11/25 18:22:05.931172 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:05.931334 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:05.931384 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "11.079209ms", "err": null}
2024/11/25 18:22:05.931388 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:05.931424 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "107.458µs"}
2024/11/25 18:22:05.931573 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:05.931541 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "205.75µs"}
2024/11/25 18:22:05.931719 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:05.931798 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "83.833µs"}
2024/11/25 18:22:05.931838 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9"}
2024/11/25 18:22:05.931861 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "142.625µs"}
2024/11/25 18:22:05.932208 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:05.932307 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:05.932371 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:05.932394 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:05.932483 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "108.417µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:05.932549 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "179.292µs"}
2024/11/25 18:22:05.932573 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:05.932577 +0800 INFO logtail/mgr.go:169 init waterline to 1732530125932421000-0
2024/11/25 18:22:05.932724 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "to": "PhysicalTime:1732530125932421000 "}
2024/11/25 18:22:05.933928 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:05.934028 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc00e094b40"}
2024/11/25 18:22:05.934106 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc00e094be0"}
2024/11/25 18:22:05.934178 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc00e094c80"}
2024/11/25 18:22:06.016845 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:06.038725 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:06.038880 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:06.039537 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": ""}
2024/11/25 18:22:06.039666 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:06.040080 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530126038168000-0", "minTs": "0-0"}
2024/11/25 18:22:06.040221 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530126038168000 "}
2024/11/25 18:22:06.040597 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:06.040749 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:06.041487 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:06.041825 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530126040244000-0", "minTs": "0-0"}
2024/11/25 18:22:06.041950 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530126040244000 "}
2024/11/25 18:22:06.042256 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:06.042371 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:06.042528 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:06.042847 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530126042185000-0", "minTs": "0-0"}
2024/11/25 18:22:06.042982 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530126042185000 "}
2024/11/25 18:22:06.043288 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:06.043422 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:06.049078 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:06.052618 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:06.055552 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef85edf3c1b/Active/S:1732530126042185000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc00e33f040"}
2024/11/25 18:22:06.058897 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:06.058965 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530126042185000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:06.059078 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:06.092842 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF85EDF3C1A][1732530126090381000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:06.090737 UTC}"}
2024/11/25 18:22:06.093346 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF85EDF3C1A][1732530126090381000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:06.102809 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.063292ms", "cn-txn": "cbf29ce484222325180b2ef85edf3c1a/Active/S:1732530126090381000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF85EDF3C1A][1732530126090381000-1->1732530126094989000-0][Committed]: <nil>"}
2024/11/25 18:22:06.107700 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-34]16385-test1", "extra-info": {"a-objs": "c6215748f620_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D7BD1B7923BA8939DF4453657B][1732530126106389000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:06.108204 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-34]16385-test1", "sort-key": "mock_0"}
2024/11/25 18:22:06.132394 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-34]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "24.575167ms", "extra-info": {"a-objs": "c6215748f620_0,", "a-tombstones": "", "to-objs": "5e8b97a46bc6_0,"}}
2024/11/25 18:22:07.136041 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:07.138838 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530127138203000 "}
2024/11/25 18:22:07.139537 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc0154eb0e0"}
2024/11/25 18:22:07.140046 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc019e526b0
2024/11/25 18:22:07.191371 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:22:07.192375 +0800 INFO logtailreplay/change_handle.go:369 ChangesHandle-FileNotFound {"err": "file 019362d7-bd17-76ed-88a6-c6215748f620_00000 is not found"}
2024/11/25 18:22:07.203114 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:07.208447 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:07.214955 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:07.215333 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:07.218731 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:07.218749 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:07.218867 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:07.218869 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:07.218922 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:07.218996 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:07.218995 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:07.219089 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:07.219164 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:07.223443 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:07.225047 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:07.236374 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "625ns"}
2024/11/25 18:22:07.236505 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "222.542µs", "checkpointed": "0-0"}
2024/11/25 18:22:07.236651 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.042µs"}
2024/11/25 18:22:07.236782 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:07.236893 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:07.236974 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:07.237058 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "462.708µs"}
2024/11/25 18:22:07.237261 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:07.237428 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:07.237484 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "13.901375ms", "err": null}
2024/11/25 18:22:07.237502 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:07.237643 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "238.167µs"}
2024/11/25 18:22:07.237737 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:07.237895 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "467.75µs"}
2024/11/25 18:22:07.237990 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:07.238029 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57"}
2024/11/25 18:22:07.238067 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "85.792µs"}
2024/11/25 18:22:07.238136 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "149.458µs"}
2024/11/25 18:22:07.238421 +0800 INFO logtail/mgr.go:169 init waterline to 1732530127238218000-0
2024/11/25 18:22:07.238453 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:07.238574 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "to": "PhysicalTime:1732530127238218000 "}
2024/11/25 18:22:07.238592 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:07.238698 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:07.238698 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:07.238778 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:07.238824 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "131.875µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:07.238909 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "209.542µs"}
2024/11/25 18:22:07.240479 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:07.240592 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc01574e1e0"}
2024/11/25 18:22:07.240685 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc01574e280"}
2024/11/25 18:22:07.240752 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc01574e320"}
2024/11/25 18:22:07.345616 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:07.345937 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:07.346741 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": ""}
2024/11/25 18:22:07.346969 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:07.347637 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530127346193000-0", "minTs": "0-0"}
2024/11/25 18:22:07.347796 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530127346193000 "}
2024/11/25 18:22:07.348290 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:07.348469 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:07.348673 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:07.349082 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530127348159000-0", "minTs": "0-0"}
2024/11/25 18:22:07.349213 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530127348159000 "}
2024/11/25 18:22:07.349550 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:07.349665 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:07.350774 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:07.351257 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530127350280000-0", "minTs": "0-0"}
2024/11/25 18:22:07.351436 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530127350280000 "}
2024/11/25 18:22:07.351821 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:07.351986 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:07.359166 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:07.361618 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:07.364968 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef8acba6703/Active/S:1732530127350280000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc01574f220"}
2024/11/25 18:22:07.368691 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:07.368765 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530127350280000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:07.368873 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:07.400338 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF8ACBA6702][1732530127350280000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:07.398805 UTC}"}
2024/11/25 18:22:07.400984 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF8ACBA6702][1732530127350280000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:22:07.409130 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.913666ms", "cn-txn": "cbf29ce484222325180b2ef8acba6702/Active/S:1732530127350280000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF8ACBA6702][1732530127350280000-1->1732530127402639000-0][Committed]: <nil>"}
2024/11/25 18:22:08.153724 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef8acba6704/Active/S:1732530127668369000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["c4f2751b8d81_0"]}
2024/11/25 18:22:08.153869 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef8acba6704/Active/S:1732530127668369000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397.1KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["2f3fdd6195a8_0"]}
2024/11/25 18:22:08.153935 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2ef8acba6704/Active/S:1732530127668369000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "264.3KiB", "obj-size": "198.8KiB", "blk-cnt": 2, "row-cnt": 16384, "names": ["3769f91d3a14_0"]}
2024/11/25 18:22:09.001908 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:09.178842 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:09.180826 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530129180198000 "}
2024/11/25 18:22:09.181336 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc004d159a0"}
2024/11/25 18:22:09.181850 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0071cd830
2024/11/25 18:22:09.225039 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:22:09.323272 +0800 INFO logtailreplay/change_handle.go:236 ChangesHandle-FileNotFound {"err": "file 019362d7-c341-7599-acdd-c4f2751b8d81_00000 is not found"}
2024/11/25 18:22:09.333661 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:09.338732 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:09.344365 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:09.344468 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:09.344732 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:09.344740 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:09.344801 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:09.344874 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:09.344885 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:09.344900 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:09.345013 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:09.345080 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:09.345117 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:09.360346 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:09.361133 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:09.366540 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "334ns"}
2024/11/25 18:22:09.366619 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "128µs", "checkpointed": "0-0"}
2024/11/25 18:22:09.366710 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6µs"}
2024/11/25 18:22:09.366791 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:09.366841 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:09.366880 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:09.366929 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "261.167µs"}
2024/11/25 18:22:09.367037 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:09.367138 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:09.367168 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "6.713125ms", "err": null}
2024/11/25 18:22:09.367190 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:09.367212 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "92.708µs"}
2024/11/25 18:22:09.367279 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:09.367293 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "154.5µs"}
2024/11/25 18:22:09.367353 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796"}
2024/11/25 18:22:09.367367 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:09.367427 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "64.791µs"}
2024/11/25 18:22:09.367458 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "92.042µs"}
2024/11/25 18:22:09.367691 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:09.367734 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:09.367764 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:09.367821 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:09.367816 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:09.367883 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "68.625µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:09.367941 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "121.042µs"}
2024/11/25 18:22:09.368553 +0800 INFO logtail/mgr.go:169 init waterline to 1732530129368488000-0
2024/11/25 18:22:09.368616 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:09.368632 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "to": "PhysicalTime:1732530129368488000 "}
2024/11/25 18:22:09.368681 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc013659900"}
2024/11/25 18:22:09.368728 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0136599a0"}
2024/11/25 18:22:09.368765 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc013659a40"}
2024/11/25 18:22:09.471680 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:09.471833 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:09.472113 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": ""}
2024/11/25 18:22:09.472205 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:09.472435 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530129470656000-0", "minTs": "0-0"}
2024/11/25 18:22:09.472509 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530129470656000 "}
2024/11/25 18:22:09.472700 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:09.472783 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:09.473157 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:09.473345 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530129472582000-0", "minTs": "0-0"}
2024/11/25 18:22:09.473411 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530129472582000 "}
2024/11/25 18:22:09.473565 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:09.473627 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:09.474188 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:09.474352 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530129472582000-0", "minTs": "0-0"}
2024/11/25 18:22:09.474412 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530129472582000 "}
2024/11/25 18:22:09.474577 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:09.474638 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:09.479217 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:09.481129 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:09.482853 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2ef92b9fd0a2/Active/S:1732530129472582000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0059c4aa0"}
2024/11/25 18:22:09.485170 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:09.485257 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530129472582000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:09.485333 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:11.003947 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:22:12.534188 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EF92B9FD0A3][1732530132532636000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:12.532953 UTC}"}
2024/11/25 18:22:12.534578 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EF92B9FD0A3][1732530132532636000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:12.546954 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "12.809167ms", "cn-txn": "cbf29ce484222325180b2ef92b9fd0a3/Active/S:1732530132532636000-1", "tn-txn": "ctx[CBF29CE484222325180B2EF92B9FD0A3][1732530132532636000-1->1732530132535573000-0][Committed]: <nil>"}
2024/11/25 18:22:13.268340 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:22:13.546231 +0800 INFO txnimpl/cmdmgr.go:68 BIG-TXN {"wal-size": 35073932, "lsn": 0, "txn": "ctx[019362D7D6437186867B738BD0AEDA58][1732530132546648000-0->1732530132906478000-0][Preparing]: <nil>"}
2024/11/25 18:22:13.810581 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-36]16385-test1", "extra-info": {"a-objs": "41d507e9272d_0,ad7aa34a2a2b_0,8469c89464d8_0,f3adc9b2675e_0,9c8126a36b9d_0,11833bed7ffb_0,4bd5bde3a778_0,7c9be84477ed_0,2e8383f0e0ee_0,dad5c4445b20_0,d2c9714d04aa_0,8899d5b196df_0,64d3156b522f_0,c50e9af4d4ff_0,022ab0e86abb_0,c935f23b9d0e_0,be3a1734f1f9_0,2514ab40ac37_0,4b9e9cad0352_0,2e6d7a6253ca_0,", "a-tombstones": "5387642e6b35_0,"}, "txn-info": "ctx[019362D7DB327566A9781D85BFA10CB6][1732530133808642000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 21}
2024/11/25 18:22:14.185523 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-36]16385-test1", "sort-key": "mock_9"}
2024/11/25 18:22:14.390328 +0800 INFO dbutils/mem.go:108 HeapInfo:TotalAlloc:3532MB Sys:1056MB HeapAlloc:953MB HeapSys:1036MB HeapIdle:70MB HeapReleased:16MB HeapInuse:965MB NextGC:1173MB NumGC:18 PauseNs:4855459
2024/11/25 18:22:14.390551 +0800 INFO merge/utils.go:86 MergeExecutorMemoryInfo {"container-limit": "0B", "host-memory": "16GiB", "merge-limit": "12GiB", "transfer-page-limit": "8EiB", "error": "cgroups is not supported on this system"}
2024/11/25 18:22:14.391165 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][415/512]: FixSizedVec[305/307] VarlenVec[110/205], Reset/Hit/totalStats:[0/(325,110)435/687]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[73/(195,67)262/262]
2024/11/25 18:22:14.583068 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:14.741674 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:15.881128 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:16.017021 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:17.190960 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:19.002721 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:19.328661 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:22:19.367395 +0800 INFO dbutils/mem.go:108 HeapInfo:TotalAlloc:3962MB Sys:1206MB HeapAlloc:830MB HeapSys:1184MB HeapIdle:342MB HeapReleased:4MB HeapInuse:841MB NextGC:1227MB NumGC:19 PauseNs:5097126
2024/11/25 18:22:19.367458 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530131377460000-1", "minTs": "1732530132535567000-0"}
2024/11/25 18:22:19.368764 +0800 INFO checkpoint/runner.go:1022 Flush-CollectMemUsage {"pressure": 0.032665531150996685, "size": "33.45MiB"}
2024/11/25 18:22:19.368850 +0800 INFO checkpoint/runner.go:1078 Flush-Tabletail {"name": "test1", "size": "33.44MiB", "dsize": "1.195KiB", "count-down": "5m29.999240875s", "ready": true}
2024/11/25 18:22:19.369496 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-58]16385-test1", "extra-info": {"a-objs": "7c9be84477ed_0,9c8126a36b9d_0,41d507e9272d_0,64d3156b522f_0,8469c89464d8_0,ad7aa34a2a2b_0,2e6d7a6253ca_0,f3adc9b2675e_0,4b9e9cad0352_0,c935f23b9d0e_0,022ab0e86abb_0,be3a1734f1f9_0,2514ab40ac37_0,11833bed7ffb_0,d2c9714d04aa_0,4bd5bde3a778_0,c50e9af4d4ff_0,dad5c4445b20_0,8899d5b196df_0,2e8383f0e0ee_0,", "a-tombstones": "5387642e6b35_0,"}, "txn-info": "ctx[019362D7F0E972CEB5384D61F58A8DD6][1732530139368541000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 21}
2024/11/25 18:22:19.392206 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][498/512]: FixSizedVec[307/307] VarlenVec[191/205], Reset/Hit/totalStats:[0/(327,191)518/1460]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[73/(195,67)262/262]
2024/11/25 18:22:19.706418 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-36]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:19.891747 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-58]16385-test1", "sort-key": "mock_9"}
2024/11/25 18:22:19.971921 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-36]16385-test1", "aobj-deletes": 20, "aobj-merge-rows": 163820, "tombstone-rows": 20, "duration": "6.161137875s", "extra-info": {"a-objs": "41d507e9272d_0,ad7aa34a2a2b_0,8469c89464d8_0,f3adc9b2675e_0,9c8126a36b9d_0,11833bed7ffb_0,4bd5bde3a778_0,7c9be84477ed_0,2e8383f0e0ee_0,dad5c4445b20_0,d2c9714d04aa_0,8899d5b196df_0,64d3156b522f_0,c50e9af4d4ff_0,022ab0e86abb_0,c935f23b9d0e_0,be3a1734f1f9_0,2514ab40ac37_0,4b9e9cad0352_0,2e6d7a6253ca_0,", "a-tombstones": "5387642e6b35_0,", "to-objs": "44d84b515be7_0,", "to-tombstones": "f5cf36b3339d_0,"}}
2024/11/25 18:22:20.680559 +0800 INFO jobs/flushTableTail.go:856 [FLUSH-AOBJ-ERR] {"error": "file 019362d7-db2e-7d42-a7d8-5387642e6b35_00000 is not found", "task": "[FT-58]16385-test1"}
2024/11/25 18:22:20.683067 +0800 INFO jobs/flushTableTail.go:856 [FLUSH-AOBJ-ERR] {"error": "file 019362d7-db2e-7d42-a7d8-5387642e6b35_00000 is not found", "task": "[FT-58]16385-test1"}
2024/11/25 18:22:20.992806 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:20.994147 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:9 ", "To": "PhysicalTime:1732530140992605000 "}
2024/11/25 18:22:20.994457 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc007b10960"}
2024/11/25 18:22:20.994957 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc019e52bb0
2024/11/25 18:22:21.000860 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:22:21.040287 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:22:21.163563 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 8192/0, read 43.201208ms, copy 108.751837ms, update 844.626µs, total 118.616375ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.249889 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 16384/0, read 43.201208ms, copy 185.869525ms, update 1.248293ms, total 204.642959ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.336140 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 24576/0, read 43.201208ms, copy 263.035568ms, update 1.658459ms, total 290.590417ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.399398 +0800 ERROR jobs/flushTableTail.go:306 [FLUSH-ERR] {"task": "[FT-58]16385-test1", "error": "file 019362d7-db2e-7d42-a7d8-5387642e6b35_00000 is not found", "phase": "1-merge aobjects"}
2024/11/25 18:22:21.399500 +0800 WARN db/task.go:66 Task[58] exec error: file 019362d7-db2e-7d42-a7d8-5387642e6b35_00000 is not found
2024/11/25 18:22:21.420136 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 32768/0, read 43.201208ms, copy 338.019921ms, update 2.072251ms, total 374.327626ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.503910 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 40960/0, read 43.201208ms, copy 412.984406ms, update 2.475334ms, total 457.865668ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.583328 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 49152/0, read 43.201208ms, copy 483.708337ms, update 2.863125ms, total 537.008668ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.669178 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 57344/0, read 43.201208ms, copy 561.013962ms, update 3.278375ms, total 622.613418ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.751300 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 65536/0, read 43.201208ms, copy 634.394301ms, update 3.699709ms, total 704.482002ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.830904 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 73728/0, read 43.201208ms, copy 705.255718ms, update 4.105376ms, total 783.820668ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.910160 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 81920/0, read 43.201208ms, copy 775.745797ms, update 4.525418ms, total 862.813543ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:21.991061 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 90112/0, read 43.201208ms, copy 847.761768ms, update 4.969127ms, total 943.439335ms, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.074549 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 98304/0, read 43.201208ms, copy 922.365713ms, update 5.389294ms, total 1.02654771s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.152655 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 106496/0, read 43.201208ms, copy 991.769687ms, update 5.818919ms, total 1.10436446s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.239322 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 114688/0, read 43.201208ms, copy 1.06954869s, update 6.248127ms, total 1.190776835s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.323919 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 122880/0, read 43.201208ms, copy 1.145250941s, update 6.662877ms, total 1.275095668s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.408000 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 131072/0, read 43.201208ms, copy 1.220444767s, update 7.120877ms, total 1.358880876s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.487796 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 139264/0, read 43.201208ms, copy 1.291364757s, update 7.526044ms, total 1.438413792s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.573204 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 147456/0, read 43.201208ms, copy 1.367935087s, update 7.994669ms, total 1.523587167s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.652559 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 155648/0, read 43.201208ms, copy 1.438453017s, update 8.448294ms, total 1.602695s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.735191 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 163840/0, read 43.201208ms, copy 1.512591949s, update 8.448294ms, total 1.684996416s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.736046 +0800 INFO logtailreplay/change_handle.go:805 ChangesHandle-Slow, 163840/20, read 43.201208ms, copy 1.512645491s, update 8.448294ms, total 1.685558625s, start 1732530129471945000-0, minTS 0-0, gcTS 0-0
2024/11/25 18:22:22.746586 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:22.751758 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:22.757519 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:22.757611 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:22.764107 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:22.764132 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:22.764179 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:22.764225 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:22.764203 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:22.764225 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:22.764247 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:22.765461 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:22.766071 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:22.773078 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "334ns"}
2024/11/25 18:22:22.773141 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "96.375µs", "checkpointed": "0-0"}
2024/11/25 18:22:22.773221 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "8.084µs"}
2024/11/25 18:22:22.773283 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:22.773324 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:22.773353 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:22.773402 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "217.125µs"}
2024/11/25 18:22:22.773550 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:22.773677 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:22.773750 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "92.167µs"}
2024/11/25 18:22:22.773738 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "8.221709ms", "err": null}
2024/11/25 18:22:22.773748 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:22.773790 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "113.708µs"}
2024/11/25 18:22:22.773826 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:22.773862 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "39.125µs"}
2024/11/25 18:22:22.773889 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "63.958µs"}
2024/11/25 18:22:22.773958 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:22.774168 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf"}
2024/11/25 18:22:22.774221 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:22.774318 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:22.774364 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:22.774374 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:22.774401 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:22.774429 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "65µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:22.774486 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "121.542µs"}
2024/11/25 18:22:22.775316 +0800 INFO logtail/mgr.go:169 init waterline to 1732530142775226000-0
2024/11/25 18:22:22.775398 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "to": "PhysicalTime:1732530142775226000 "}
2024/11/25 18:22:22.775595 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:22.775675 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc048645540"}
2024/11/25 18:22:22.775727 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0486455e0"}
2024/11/25 18:22:22.775765 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc048645680"}
2024/11/25 18:22:22.878983 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:22.879068 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:22.879727 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": ""}
2024/11/25 18:22:22.879835 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:22.880140 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530142878955000-0", "minTs": "0-0"}
2024/11/25 18:22:22.880220 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530142878955000 "}
2024/11/25 18:22:22.880461 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:22.880545 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:22.881531 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:22.881812 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530142880996000-0", "minTs": "0-0"}
2024/11/25 18:22:22.881906 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530142880996000 "}
2024/11/25 18:22:22.882119 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:22.882202 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:22.882610 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:22.882843 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530142880996000-0", "minTs": "0-0"}
2024/11/25 18:22:22.882934 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530142880996000 "}
2024/11/25 18:22:22.883185 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:22.883273 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:22.888632 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:22.896586 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:22.899393 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efc4ab96cf3/Active/S:1732530142880996000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc01574ea00"}
2024/11/25 18:22:22.904325 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:22.904391 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530142880996000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:22.904585 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:22.933663 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFC4AB96CF2][1732530142880996000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:22.931560 UTC}"}
2024/11/25 18:22:22.934111 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFC4AB96CF2][1732530142880996000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:22.941530 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.995917ms", "cn-txn": "cbf29ce484222325180b2efc4ab96cf2/Active/S:1732530142880996000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFC4AB96CF2][1732530142880996000-1->1732530142935653000-0][Committed]: <nil>"}
2024/11/25 18:22:23.268547 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:22:23.509990 +0800 INFO blockio/pipeline.go:458 Runtime-State-BitmapPool-Report: [0/64]
2024/11/25 18:22:23.942010 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:23.943694 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530143943012000 "}
2024/11/25 18:22:23.944236 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc032dc2140"}
2024/11/25 18:22:23.944673 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03e7806b0
2024/11/25 18:22:24.583277 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:24.742836 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:24.945252 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:24.92308 +0000 UTC, targetTS: 2024-11-25 10:22:23.944981 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-0, iblk-0, irow-0; dobj-0, dblk-0, drow-0};
InmemRows:{visible-10, invisible-0};
checkpoint:{0};
visible objects:   []
invisible objects: []
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:24.946148 +0800 INFO checkpoint/runner.go:1022 Flush-CollectMemUsage {"pressure": 0.0000007115304470062256, "size": "764B"}
2024/11/25 18:22:24.946284 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 16385, "name": "test1"}
2024/11/25 18:22:24.946787 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-80]16385-test1", "extra-info": {"a-objs": "19eb72981124_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D806B2786C976AAE29C0A58BE1][1732530144945261000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:24.947530 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-80]16385-test1", "sort-key": "mock_0"}
2024/11/25 18:22:24.982050 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-80]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "35.082916ms", "extra-info": {"a-objs": "19eb72981124_0,", "a-tombstones": "", "to-objs": "d1f88454d27c_0,"}}
2024/11/25 18:22:25.911786 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:26.017366 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:26.350481 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:26.333227 +0000 UTC, targetTS: 2024-11-25 10:22:25.346307 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-1, irow-10; dobj-1, dblk-1, drow-10};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-06b3-7e92-876e-d1f88454d27c_00000)|Ext(1_1320_741_3071)|Rows(10)|Blks(1)|Size(2125)|OSize(4775)]; appendable: false; sorted: true; createTS: 1732530144982578000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d7-fed7-7858-a87b-19eb72981124_00000)|Ext(1_1492_798_3567)|Rows(10)|Blks(1)|Size(2354)|OSize(5835)]; appendable: true; sorted: false; createTS: 1732530142935653000-0; deleteTS: 1732530144982578000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:26.361871 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:26.367360 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:26.373563 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:26.374013 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:26.378289 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:26.378361 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:26.378561 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:26.378691 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:26.378708 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:26.378811 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:26.378789 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:26.381489 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:26.382887 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:26.416471 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "417ns"}
2024/11/25 18:22:26.416583 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "199.209µs", "checkpointed": "0-0"}
2024/11/25 18:22:26.416701 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.459µs"}
2024/11/25 18:22:26.416825 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:26.416886 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:26.417117 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:26.417185 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "523.208µs"}
2024/11/25 18:22:26.417510 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:26.417852 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:26.418107 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "272.791µs"}
2024/11/25 18:22:26.418151 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "299.583µs"}
2024/11/25 18:22:26.418200 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:26.418267 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "68.709µs"}
2024/11/25 18:22:26.418280 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:26.418273 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "36.584834ms", "err": null}
2024/11/25 18:22:26.418331 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "130.125µs"}
2024/11/25 18:22:26.419330 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:26.419393 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:26.419445 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:26.419442 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:26.419594 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "155.958µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:26.419657 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "215.042µs"}
2024/11/25 18:22:26.419662 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:26.423059 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2"}
2024/11/25 18:22:26.423796 +0800 INFO logtail/mgr.go:169 init waterline to 1732530146423731000-0
2024/11/25 18:22:26.423856 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:26.423938 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "to": "PhysicalTime:1732530146423731000 "}
2024/11/25 18:22:26.425789 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:26.425888 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0336b7720"}
2024/11/25 18:22:26.425950 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0336b77c0"}
2024/11/25 18:22:26.426013 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0336b7860"}
2024/11/25 18:22:26.530835 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:26.531118 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:26.532697 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": ""}
2024/11/25 18:22:26.532977 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:26.533707 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146531619000-0", "minTs": "0-0"}
2024/11/25 18:22:26.533909 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530146531619000 "}
2024/11/25 18:22:26.534517 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.534688 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:26.535168 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:26.535598 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146533585000-0", "minTs": "0-0"}
2024/11/25 18:22:26.535755 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530146533585000 "}
2024/11/25 18:22:26.536043 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.536141 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:26.536333 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:26.536808 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146535520000-0", "minTs": "0-0"}
2024/11/25 18:22:26.536921 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530146535520000 "}
2024/11/25 18:22:26.537224 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.537332 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:26.545609 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:26.550092 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:26.554694 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd243f75f3/Active/S:1732530146535520000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc033917680"}
2024/11/25 18:22:26.559304 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:26.559484 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530146535520000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.559698 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:26.590730 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD243F75F2][1732530146535520000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:26.584545 UTC}"}
2024/11/25 18:22:26.591611 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD243F75F2][1732530146535520000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16385 Name:db2 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:26.584811 UTC}"}
2024/11/25 18:22:26.592126 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD243F75F2][1732530146535520000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16385-db2:16386-test1inDb2"}
2024/11/25 18:22:26.600751 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.13925ms", "cn-txn": "cbf29ce484222325180b2efd243f75f2/Active/S:1732530146535520000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD243F75F2][1732530146535520000-1->1732530146594291000-0][Committed]: <nil>"}
2024/11/25 18:22:26.658740 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:26.658903 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:26.659031 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:26.659124 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:26.659201 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:26.658969 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:26.659188 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:26.658829 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:26.659108 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:26.669071 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:26.674279 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:26.680401 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:26.680706 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:26.689142 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:26.690826 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 30\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:26.710537 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "666ns"}
2024/11/25 18:22:26.710706 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "299.875µs", "checkpointed": "0-0"}
2024/11/25 18:22:26.710844 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "8.958µs"}
2024/11/25 18:22:26.710980 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:26.711060 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:26.711134 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:26.711221 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "437.375µs"}
2024/11/25 18:22:26.711661 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:26.711883 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:26.711992 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "22.67225ms", "err": null}
2024/11/25 18:22:26.711992 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:26.712089 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "238.084µs"}
2024/11/25 18:22:26.712173 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "293.25µs"}
2024/11/25 18:22:26.712253 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:26.712329 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "82.666µs"}
2024/11/25 18:22:26.712384 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:26.712390 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "136.833µs"}
2024/11/25 18:22:26.712871 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b"}
2024/11/25 18:22:26.712917 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:26.713070 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:26.713140 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:26.713254 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:26.713193 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:26.713450 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "315.291µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:26.713525 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "345.084µs"}
2024/11/25 18:22:26.714441 +0800 INFO logtail/mgr.go:169 init waterline to 1732530146714375000-0
2024/11/25 18:22:26.714565 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "to": "PhysicalTime:1732530146714375000 "}
2024/11/25 18:22:26.714981 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:26.715102 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0357afcc0"}
2024/11/25 18:22:26.715174 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0357afd60"}
2024/11/25 18:22:26.715263 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0357afe00"}
2024/11/25 18:22:26.820089 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:26.820360 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:26.822102 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "stream-id": 1, "remote": ""}
2024/11/25 18:22:26.822341 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:26.823066 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146822347000-0", "minTs": "0-0"}
2024/11/25 18:22:26.823227 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530146822347000 "}
2024/11/25 18:22:26.823715 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.823909 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:26.824435 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:26.824824 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146824165000-0", "minTs": "0-0"}
2024/11/25 18:22:26.824977 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530146824165000 "}
2024/11/25 18:22:26.825408 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.825512 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:26.826502 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:26.826914 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530146826229000-0", "minTs": "0-0"}
2024/11/25 18:22:26.827084 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-0d98-7582-a5f1-108730dfdc1b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530146826229000 "}
2024/11/25 18:22:26.827368 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.827475 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:26.833852 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:26.838165 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:26.841962 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd357f4efb/Active/S:1732530146826229000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0368750e0"}
2024/11/25 18:22:26.846637 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:26.846818 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530146826229000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:26.846967 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:26.876099 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFA][1732530146826229000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:todrop CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:26.873106 UTC}"}
2024/11/25 18:22:26.876911 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFA][1732530146826229000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-todrop:16385-test"}
2024/11/25 18:22:26.878516 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFA][1732530146826229000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16386 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:26.873777 UTC}"}
2024/11/25 18:22:26.879007 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFA][1732530146826229000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16386-db:16387-test"}
2024/11/25 18:22:26.887832 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "12.016791ms", "cn-txn": "cbf29ce484222325180b2efd357f4efa/Active/S:1732530146826229000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD357F4EFA][1732530146826229000-1->1732530146880558000-0][Committed]: <nil>"}
2024/11/25 18:22:26.948367 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd357f4efc/Active/S:1732530146938355000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 66", "pointer": "0xc0368755e0"}
2024/11/25 18:22:26.953452 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFC][1732530146938355000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16385 NewId:0 Name:test DatabaseId:16384 DatabaseName:todrop}"}
2024/11/25 18:22:26.954464 +0800 INFO rpc/handle.go:623 PreCommit-DropDB {"txn": "ctx[CBF29CE484222325180B2EFD357F4EFC][1732530146938355000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{Id:16384 Name:todrop}"}
2024/11/25 18:22:26.960516 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.203167ms", "cn-txn": "cbf29ce484222325180b2efd357f4efc/Active/S:1732530146938355000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD357F4EFC][1732530146938355000-1->1732530146955639000-0][Committed]: <nil>"}
2024/11/25 18:22:27.191262 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:27.356319 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:27.356602 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:27.356845 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:27.356944 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:27.357227 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:27.357644 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:27.357778 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:27.357896 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:27.357962 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:27.366561 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:27.371862 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:27.377775 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:27.378069 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:27.381728 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:27.383192 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:27.430289 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "792ns"}
2024/11/25 18:22:27.430512 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "366.75µs", "checkpointed": "0-0"}
2024/11/25 18:22:27.430682 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.875µs"}
2024/11/25 18:22:27.430854 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:27.430943 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:27.431007 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:27.431090 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "481.5µs"}
2024/11/25 18:22:27.431629 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:27.432117 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:27.432311 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "226.25µs"}
2024/11/25 18:22:27.432410 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "292.166µs"}
2024/11/25 18:22:27.432390 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "50.449917ms", "err": null}
2024/11/25 18:22:27.432409 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:27.432479 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:27.432633 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "159.708µs"}
2024/11/25 18:22:27.432715 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "236.708µs"}
2024/11/25 18:22:27.432733 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:27.433324 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c"}
2024/11/25 18:22:27.433790 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:27.433987 +0800 INFO logtail/mgr.go:169 init waterline to 1732530147433879000-0
2024/11/25 18:22:27.434076 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:27.434133 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "to": "PhysicalTime:1732530147433879000 "}
2024/11/25 18:22:27.434340 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:27.434492 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:27.434484 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:27.434648 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "170.208µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:27.434757 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "253.958µs"}
2024/11/25 18:22:27.436201 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:27.436359 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0385720a0"}
2024/11/25 18:22:27.436448 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc038572140"}
2024/11/25 18:22:27.436562 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0385721e0"}
2024/11/25 18:22:27.542024 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:27.542361 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:27.544170 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": ""}
2024/11/25 18:22:27.544439 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:27.545165 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147543882000-0", "minTs": "0-0"}
2024/11/25 18:22:27.545357 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530147543882000 "}
2024/11/25 18:22:27.545886 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.546047 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:27.546417 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:27.546812 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147545928000-0", "minTs": "0-0"}
2024/11/25 18:22:27.546973 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530147545928000 "}
2024/11/25 18:22:27.547328 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.547462 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:27.547623 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:27.548064 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147545928000-0", "minTs": "0-0"}
2024/11/25 18:22:27.548207 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530147545928000 "}
2024/11/25 18:22:27.548606 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.548743 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:27.556542 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:27.561314 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:27.565491 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd6071c11b/Active/S:1732530147545928000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc038572dc0"}
2024/11/25 18:22:27.570392 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:27.570545 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530147545928000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.570734 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:27.598919 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD6071C11A][1732530147545928000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:27.596954 UTC}"}
2024/11/25 18:22:27.599738 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD6071C11A][1732530147545928000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-test"}
2024/11/25 18:22:27.609574 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.791417ms", "cn-txn": "cbf29ce484222325180b2efd6071c11a/Active/S:1732530147545928000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD6071C11A][1732530147545928000-1->1732530147602168000-0][Committed]: <nil>"}
2024/11/25 18:22:27.675164 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd6071c11c/Active/S:1732530147661030000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 62", "pointer": "0xc037770fa0"}
2024/11/25 18:22:27.683257 +0800 INFO rpc/handle.go:990 PreCommit-AlterTBL {"req": "table_id:16385 db_id:16384 kind:UpdateConstraint update_cstr:<constraints:\"\\001\\000\\000\\000\\000\\000\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000\\001\" > ", "txn": "ctx[CBF29CE484222325180B2EFD6071C11C][1732530147661030000-1->9223372036854775807-4294967295][Active]: <nil>"}
2024/11/25 18:22:27.684059 +0800 INFO rpc/handle.go:990 PreCommit-AlterTBL {"req": "table_id:16385 db_id:16384 kind:UpdateComment update_comment:<comment:\"comment version 1\" > ", "txn": "ctx[CBF29CE484222325180B2EFD6071C11C][1732530147661030000-1->9223372036854775807-4294967295][Active]: <nil>"}
2024/11/25 18:22:27.692278 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "9.691125ms", "cn-txn": "cbf29ce484222325180b2efd6071c11c/Active/S:1732530147661030000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD6071C11C][1732530147661030000-1->1732530147686035000-0][Committed]: <nil>"}
2024/11/25 18:22:27.749964 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd6071c11d/Active/S:1732530147743876000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 70", "pointer": "0xc038aa23c0"}
2024/11/25 18:22:27.753295 +0800 INFO rpc/handle.go:990 PreCommit-AlterTBL {"req": "table_id:16385 db_id:16384 kind:UpdateConstraint update_cstr:<constraints:\"\\001\\000\\000\\000\\000\\000\\000\\000\\002\\000\\000\\000\\000\\000\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000\\002\" > ", "txn": "ctx[CBF29CE484222325180B2EFD6071C11D][1732530147743876000-1->9223372036854775807-4294967295][Active]: <nil>"}
2024/11/25 18:22:27.763988 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "11.1325ms", "cn-txn": "cbf29ce484222325180b2efd6071c11d/Active/S:1732530147743876000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD6071C11D][1732530147743876000-1->1732530147759461000-0][Committed]: <nil>"}
2024/11/25 18:22:27.820513 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd6071c11e/Active/S:1732530147814089000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 78", "pointer": "0xc038d7c1e0"}
2024/11/25 18:22:27.823206 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFD6071C11E][1732530147814089000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16385 NewId:0 Name:test DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:27.827363 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "4.23225ms", "cn-txn": "cbf29ce484222325180b2efd6071c11e/Active/S:1732530147814089000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD6071C11E][1732530147814089000-1->1732530147824464000-0][Committed]: <nil>"}
2024/11/25 18:22:27.831074 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:27.831214 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:27.831253 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:27.831292 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:27.831319 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:27.831172 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:27.831362 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:27.831431 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:27.831502 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:27.841386 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:27.846504 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:27.852695 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:27.853007 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:27.857250 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:27.859451 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:27.878533 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "917ns"}
2024/11/25 18:22:27.878717 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "319.541µs", "checkpointed": "0-0"}
2024/11/25 18:22:27.878888 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.167µs"}
2024/11/25 18:22:27.879114 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:27.879225 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:27.879327 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:27.879437 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "602µs"}
2024/11/25 18:22:27.879703 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:27.879955 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:27.880109 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "22.316459ms", "err": null}
2024/11/25 18:22:27.880148 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "231.625µs"}
2024/11/25 18:22:27.880160 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:27.880286 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "331.292µs"}
2024/11/25 18:22:27.880452 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:27.880569 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "127.667µs"}
2024/11/25 18:22:27.880557 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:27.880710 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "257.375µs"}
2024/11/25 18:22:27.881466 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860"}
2024/11/25 18:22:27.881696 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:27.881838 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:27.881945 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:27.881948 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:27.881976 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:27.882052 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "117.75µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:27.882143 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "197.375µs"}
2024/11/25 18:22:27.882243 +0800 INFO logtail/mgr.go:169 init waterline to 1732530147882123000-0
2024/11/25 18:22:27.882411 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "to": "PhysicalTime:1732530147882123000 "}
2024/11/25 18:22:27.884341 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:27.884524 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc038cccbe0"}
2024/11/25 18:22:27.884641 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc038cccc80"}
2024/11/25 18:22:27.884739 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc038cccd20"}
2024/11/25 18:22:27.990872 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:27.991113 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:27.992382 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "stream-id": 1, "remote": ""}
2024/11/25 18:22:27.992571 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:27.993203 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147992349000-0", "minTs": "0-0"}
2024/11/25 18:22:27.993379 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530147992349000 "}
2024/11/25 18:22:27.994383 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.994555 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:27.994920 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:27.995578 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147994117000-0", "minTs": "0-0"}
2024/11/25 18:22:27.995729 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530147994117000 "}
2024/11/25 18:22:27.996258 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.996361 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:27.996983 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:27.997772 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530147996316000-0", "minTs": "0-0"}
2024/11/25 18:22:27.997896 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530147996316000 "}
2024/11/25 18:22:27.998410 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:27.998511 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:28.006057 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:28.009295 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:28.012725 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd7b28a302/Active/S:1732530147996316000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0390681e0"}
2024/11/25 18:22:28.015532 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:28.015613 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530147996316000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:28.015706 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:28.215556 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFD7B28A303][1732530148044277000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:28.044913 UTC}"}
2024/11/25 18:22:28.216223 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD7B28A303][1732530148044277000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-test"}
2024/11/25 18:22:28.317337 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFD7B28A303][1732530148044277000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16386-todrop"}
2024/11/25 18:22:28.480172 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "264.683667ms", "cn-txn": "cbf29ce484222325180b2efd7b28a303/Active/S:1732530148044277000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD7B28A303][1732530148044277000-1->1732530148333759000-0][Committed]: <nil>"}
2024/11/25 18:22:28.483758 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "chunk-number": 183, "chunk-limit": 16351, "message-size": 2989934}
2024/11/25 18:22:28.620059 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd7b28a304/Active/S:1732530148530261000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 8262", "pointer": "0xc013336460"}
2024/11/25 18:22:28.624039 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-82]3-mo_columns", "extra-info": {"a-objs": "e32f6460725c_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D8150F7C9E9101C1DE2A2F2399][1732530148622260000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:28.667405 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-82]3-mo_columns", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:28.971614 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-82]3-mo_columns", "aobj-deletes": 0, "aobj-merge-rows": 8192, "tombstone-rows": 0, "duration": "347.504833ms", "extra-info": {"a-objs": "e32f6460725c_0,", "a-tombstones": "", "to-objs": "aff53674af7b_0,"}}
2024/11/25 18:22:29.002929 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:29.175010 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efd7b28a304/Active/S:1732530149130290000-1", "desc": "PartitionState(tid:3) objLen 2, rowsLen 70", "pointer": "0xc02572f860"}
2024/11/25 18:22:29.183545 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFD7B28A304][1732530149130290000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16386 NewId:0 Name:todrop DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:29.194132 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.651125ms", "cn-txn": "cbf29ce484222325180b2efd7b28a304/Active/S:1732530149130290000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFD7B28A304][1732530149130290000-1->1732530149188376000-0][Committed]: <nil>"}
2024/11/25 18:22:29.194336 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-1228-791c-b304-ff58a5e7c860", "chunk-number": 2, "chunk-limit": 16351, "message-size": 24007}
2024/11/25 18:22:29.194349 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:29.194481 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:29.194542 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:29.194549 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:29.194510 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:29.194637 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:29.194567 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:29.194703 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:29.194770 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:29.204618 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:29.209866 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:29.215560 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:29.215696 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:29.221693 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:29.222679 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:29.239274 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "500ns"}
2024/11/25 18:22:29.239367 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "141.292µs", "checkpointed": "0-0"}
2024/11/25 18:22:29.239465 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "5.417µs"}
2024/11/25 18:22:29.239587 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:29.239681 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:29.239731 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:29.239794 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "370.167µs"}
2024/11/25 18:22:29.239957 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:29.240192 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:29.240304 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "136.25µs"}
2024/11/25 18:22:29.240307 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:29.240349 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "161.459µs"}
2024/11/25 18:22:29.240305 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "18.516208ms", "err": null}
2024/11/25 18:22:29.240409 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:29.240469 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "58.334µs"}
2024/11/25 18:22:29.240513 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "104.084µs"}
2024/11/25 18:22:29.240656 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:29.241052 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235"}
2024/11/25 18:22:29.241138 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:29.241197 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:29.241262 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:29.241257 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:29.241284 +0800 INFO logtail/mgr.go:169 init waterline to 1732530149241144000-0
2024/11/25 18:22:29.241360 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "105.167µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:29.241421 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "163.958µs"}
2024/11/25 18:22:29.241466 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "to": "PhysicalTime:1732530149241144000 "}
2024/11/25 18:22:29.243079 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:29.244699 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:29.244779 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0133d0460"}
2024/11/25 18:22:29.244854 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0133d0500"}
2024/11/25 18:22:29.244913 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0133d05a0"}
2024/11/25 18:22:29.328985 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:22:29.348293 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:29.348378 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:29.349277 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": ""}
2024/11/25 18:22:29.349388 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:29.349661 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530149349241000-0", "minTs": "0-0"}
2024/11/25 18:22:29.349762 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530149349241000 "}
2024/11/25 18:22:29.350013 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:29.350108 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:29.351026 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:29.351218 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530149351076000-0", "minTs": "0-0"}
2024/11/25 18:22:29.351290 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530149351076000 "}
2024/11/25 18:22:29.351462 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:29.351526 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:29.352054 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:29.352216 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530149351076000-0", "minTs": "0-0"}
2024/11/25 18:22:29.352291 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530149351076000 "}
2024/11/25 18:22:29.352500 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:29.352557 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:29.356944 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:29.358894 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:29.360514 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efdcc4967b3/Active/S:1732530149351076000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc007725cc0"}
2024/11/25 18:22:29.362602 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:29.362645 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530149351076000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:29.362728 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:29.402918 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFDCC4967B2][1732530149351076000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:29.399901 UTC}"}
2024/11/25 18:22:29.403680 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFDCC4967B2][1732530149351076000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-test"}
2024/11/25 18:22:29.413640 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.845333ms", "cn-txn": "cbf29ce484222325180b2efdcc4967b2/Active/S:1732530149351076000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFDCC4967B2][1732530149351076000-1->1732530149406053000-0][Committed]: <nil>"}
2024/11/25 18:22:30.414088 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:30.416282 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db\" tb_name:\"test\" primary_seqnum:3 ", "To": "PhysicalTime:1732530150415123000 "}
2024/11/25 18:22:30.417110 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc012f90b40"}
2024/11/25 18:22:30.417753 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03e7801b0
2024/11/25 18:22:30.507174 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-84]16385-test", "extra-info": {"a-objs": "30e7fe902da3_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D81C6A7C7F8A6BC1B43056FF3C][1732530150505196000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:30.508013 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-84]16385-test", "sort-key": "mock_3"}
2024/11/25 18:22:30.532499 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-84]16385-test", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "24.97575ms", "extra-info": {"a-objs": "30e7fe902da3_0,", "a-tombstones": "", "to-objs": "c2d9dfba71b7_0,"}}
2024/11/25 18:22:30.539364 +0800 INFO txnentries/flushTableTail.go:270 [FLUSH-PREPARE-COMMIT] {"task": "[FT-84]16385-test", "commit-ts": "1732530150538722000-0", "ablks": 1, "transfer-rows": 1, "in-queue-transfers": 1}
2024/11/25 18:22:30.742680 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test] succeed
2024/11/25 18:22:30.747492 +0800 INFO rpc/handle.go:961 op2 {"txn": "ctx[CBF29CE484222325180B2EFDCC4967B4][1732530150697304000-1->9223372036854775807-4294967295][Active]: <nil>", "pk": "[1]: ", "rowid": "019362d8-1c86-7572-93bd-ea1949e534d0-0-0-0"}
2024/11/25 18:22:30.753536 +0800 WARN rpc/handle.go:441 HandleCommit-SLOW-LOG {"commit-latency": "6.252916ms", "cn-txn": "cbf29ce484222325180b2efdcc4967b4/Active/S:1732530150697304000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFDCC4967B4][1732530150697304000-1->1732530150749073000-0][Committed]: <nil>"}
2024/11/25 18:22:30.754390 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-86]16385-test", "extra-info": {"a-objs": "ea1949e534d0_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D81D6270949F21ABCBC5DA6EB1][1732530150753244000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:30.754990 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-86]16385-test", "sort-key": "mock_3"}
2024/11/25 18:22:30.773195 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-86]16385-test", "aobj-deletes": 1, "aobj-merge-rows": 1, "tombstone-rows": 0, "duration": "18.599833ms", "extra-info": {"a-objs": "ea1949e534d0_0,", "a-tombstones": "", "to-objs": "048b5bf95ca5_0,"}}
2024/11/25 18:22:30.979950 +0800 INFO rpc/handle.go:961 op2 {"txn": "ctx[CBF29CE484222325180B2EFDCC4967B5][1732530150931301000-1->9223372036854775807-4294967295][Active]: <nil>", "pk": "[1]: ", "rowid": "019362d8-1d63-74b7-9817-048b5bf95ca5-0-0-0"}
2024/11/25 18:22:30.985269 +0800 WARN rpc/handle.go:441 HandleCommit-SLOW-LOG {"commit-latency": "5.581ms", "cn-txn": "cbf29ce484222325180b2efdcc4967b5/Active/S:1732530150931301000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFDCC4967B5][1732530150931301000-1->1732530150980835000-0][Committed]: <nil>"}
2024/11/25 18:22:30.985756 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:30.985775 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:30.985806 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:30.985901 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:30.986035 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:30.996545 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:31.001651 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:31.015365 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:31.015697 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:31.042015 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:31.042163 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:22:31.043885 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:31.069321 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "458ns"}
2024/11/25 18:22:31.069430 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "208.75µs", "checkpointed": "0-0"}
2024/11/25 18:22:31.069510 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.75µs"}
2024/11/25 18:22:31.069608 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:31.069678 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:31.069724 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:31.069779 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "302.042µs"}
2024/11/25 18:22:31.069930 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:31.070122 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:31.070250 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "137.875µs"}
2024/11/25 18:22:31.070272 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "27.81ms", "err": null}
2024/11/25 18:22:31.070296 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:31.070305 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "175.084µs"}
2024/11/25 18:22:31.070402 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:31.070439 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "40.416µs"}
2024/11/25 18:22:31.070487 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "85.5µs"}
2024/11/25 18:22:31.070627 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:31.070996 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:31.071081 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:31.071091 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572"}
2024/11/25 18:22:31.071133 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:31.071137 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:31.071215 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "78.125µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:31.071253 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "121.042µs"}
2024/11/25 18:22:31.071322 +0800 INFO logtail/mgr.go:169 init waterline to 1732530151071172000-0
2024/11/25 18:22:31.071463 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "to": "PhysicalTime:1732530151071172000 "}
2024/11/25 18:22:31.073633 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:31.075073 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:31.075181 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc00f68c960"}
2024/11/25 18:22:31.075229 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc00f68ca00"}
2024/11/25 18:22:31.075295 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc00f68caa0"}
2024/11/25 18:22:31.179327 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:31.179631 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:31.181596 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": ""}
2024/11/25 18:22:31.181966 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:31.182739 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151181363000-0", "minTs": "0-0"}
2024/11/25 18:22:31.182962 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530151181363000 "}
2024/11/25 18:22:31.183551 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.183714 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:31.183929 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:31.184540 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151183095000-0", "minTs": "0-0"}
2024/11/25 18:22:31.184751 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530151183095000 "}
2024/11/25 18:22:31.185248 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.185402 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:31.186084 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:31.186643 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151185051000-0", "minTs": "0-0"}
2024/11/25 18:22:31.186790 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530151185051000 "}
2024/11/25 18:22:31.187217 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.187353 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:31.194652 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:31.198898 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:31.202482 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe396584cb/Active/S:1732530151185051000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc00f68dc20"}
2024/11/25 18:22:31.206517 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:31.206660 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530151185051000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.206832 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:31.241196 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFE396584CA][1732530151185051000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:31.234147 UTC}"}
2024/11/25 18:22:31.241911 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CA][1732530151185051000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-test1"}
2024/11/25 18:22:31.243401 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CA][1732530151185051000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16386-test2"}
2024/11/25 18:22:31.244697 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CA][1732530151185051000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16387-test3"}
2024/11/25 18:22:31.254195 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "13.152542ms", "cn-txn": "cbf29ce484222325180b2efe396584ca/Active/S:1732530151185051000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584CA][1732530151185051000-1->1732530151246220000-0][Committed]: <nil>"}
2024/11/25 18:22:31.254478 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "chunk-number": 2, "chunk-limit": 16351, "message-size": 20176}
2024/11/25 18:22:31.310859 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe396584cc/Active/S:1732530151305342000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 100", "pointer": "0xc0335e8280"}
2024/11/25 18:22:31.313150 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CC][1732530151305342000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16385 NewId:0 Name:test1 DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:31.319449 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.36275ms", "cn-txn": "cbf29ce484222325180b2efe396584cc/Active/S:1732530151305342000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584CC][1732530151305342000-1->1732530151314936000-0][Committed]: <nil>"}
2024/11/25 18:22:31.374137 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CD][1732530151371316000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16388-test1"}
2024/11/25 18:22:31.384920 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.819417ms", "cn-txn": "cbf29ce484222325180b2efe396584cd/Active/S:1732530151371316000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584CD][1732530151371316000-1->1732530151378010000-0][Committed]: <nil>"}
2024/11/25 18:22:31.441584 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe396584ce/Active/S:1732530151435251000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 128", "pointer": "0xc003143220"}
2024/11/25 18:22:31.443898 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CE][1732530151435251000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16386 NewId:0 Name:test2 DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:31.450115 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.309042ms", "cn-txn": "cbf29ce484222325180b2efe396584ce/Active/S:1732530151435251000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584CE][1732530151435251000-1->1732530151445475000-0][Committed]: <nil>"}
2024/11/25 18:22:31.503512 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584CF][1732530151501260000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16389-test4"}
2024/11/25 18:22:31.514368 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.917125ms", "cn-txn": "cbf29ce484222325180b2efe396584cf/Active/S:1732530151501260000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584CF][1732530151501260000-1->1732530151506436000-0][Committed]: <nil>"}
2024/11/25 18:22:31.574279 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe396584d0/Active/S:1732530151565316000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 156", "pointer": "0xc0336b7d60"}
2024/11/25 18:22:31.580127 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFE396584D0][1732530151565316000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16389 NewId:0 Name:test4 DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:31.586446 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.392875ms", "cn-txn": "cbf29ce484222325180b2efe396584d0/Active/S:1732530151565316000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE396584D0][1732530151565316000-1->1732530151581536000-0][Committed]: <nil>"}
2024/11/25 18:22:31.638809 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530151445475000-1", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.639118 +0800 INFO cache/catalog.go:201 FIND_TABLE CACHE gc {"report": {"TScanItem":11,"TStaleItem":4,"TStaleCpk":2,"DScanItem":2,"DStaleItem":0,"DStaleCpk":0}, "cost": "453.375µs"}
2024/11/25 18:22:31.639904 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:31.639936 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:31.639951 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:31.639957 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:31.640041 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:31.640073 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:31.640098 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:31.640203 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:31.640258 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:31.650458 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:31.655549 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:31.661742 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:31.662063 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:31.666772 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:31.669653 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:31.690595 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "417ns"}
2024/11/25 18:22:31.690711 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "193.083µs", "checkpointed": "0-0"}
2024/11/25 18:22:31.690809 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "13.291µs"}
2024/11/25 18:22:31.690902 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:31.691012 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:31.691077 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:31.691153 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "385.667µs"}
2024/11/25 18:22:31.691296 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:31.691492 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:31.691565 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "89.708µs"}
2024/11/25 18:22:31.691576 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "24.55375ms", "err": null}
2024/11/25 18:22:31.691580 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:31.691611 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "118.625µs"}
2024/11/25 18:22:31.691681 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:31.691741 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "64.167µs"}
2024/11/25 18:22:31.691781 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "99.875µs"}
2024/11/25 18:22:31.691840 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:31.692083 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a"}
2024/11/25 18:22:31.692197 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:31.692264 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:31.692326 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:31.692328 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:31.692394 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "69.916µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:31.692484 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "156.042µs"}
2024/11/25 18:22:31.692510 +0800 INFO logtail/mgr.go:169 init waterline to 1732530151692400000-0
2024/11/25 18:22:31.692646 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "to": "PhysicalTime:1732530151692400000 "}
2024/11/25 18:22:31.693677 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:31.694962 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:31.695059 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc036ebda40"}
2024/11/25 18:22:31.695119 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc036ebdae0"}
2024/11/25 18:22:31.695157 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc036ebdb80"}
2024/11/25 18:22:31.798999 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:31.799167 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:31.800235 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": ""}
2024/11/25 18:22:31.800401 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:31.800862 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151800407000-0", "minTs": "0-0"}
2024/11/25 18:22:31.801006 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530151800407000 "}
2024/11/25 18:22:31.801362 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.801507 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:31.801949 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:31.802305 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151800407000-0", "minTs": "0-0"}
2024/11/25 18:22:31.802644 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530151800407000 "}
2024/11/25 18:22:31.803406 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.803650 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:31.804213 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:31.804987 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530151802719000-0", "minTs": "0-0"}
2024/11/25 18:22:31.805291 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530151804524000 "}
2024/11/25 18:22:31.805930 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.806193 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:31.815459 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:31.822434 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:31.827348 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe5e5aaf63/Active/S:1732530151804524000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc037673220"}
2024/11/25 18:22:31.831867 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:31.831965 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530151804524000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:31.832092 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:31.853555 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFE5E5AAF62][1732530151804524000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:31.851296 UTC}"}
2024/11/25 18:22:31.854269 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE5E5AAF62][1732530151804524000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-test"}
2024/11/25 18:22:31.863095 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "9.679125ms", "cn-txn": "cbf29ce484222325180b2efe5e5aaf62/Active/S:1732530151804524000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE5E5AAF62][1732530151804524000-1->1732530151856214000-0][Committed]: <nil>"}
2024/11/25 18:22:31.919296 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFE5E5AAF64][1732530151914653000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16386 Name:db2 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:31.915694 UTC}"}
2024/11/25 18:22:31.920612 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFE5E5AAF64][1732530151914653000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16386-db2:16387-test"}
2024/11/25 18:22:31.931417 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "12.314125ms", "cn-txn": "cbf29ce484222325180b2efe5e5aaf64/Active/S:1732530151914653000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFE5E5AAF64][1732530151914653000-1->1732530151924297000-0][Committed]: <nil>"}
2024/11/25 18:22:31.932227 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-88]1-mo_database", "extra-info": {"a-objs": "23b2d7b5383e_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D821FB7B0CA62ECD1BB09CFDED][1732530151930662000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:31.933039 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-88]1-mo_database", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:31.951051 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-88]1-mo_database", "aobj-deletes": 0, "aobj-merge-rows": 2, "tombstone-rows": 0, "duration": "18.611167ms", "extra-info": {"a-objs": "23b2d7b5383e_0,", "a-tombstones": "", "to-objs": "cbee45f61c99_0,"}}
2024/11/25 18:22:32.019472 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe5e5aaf65/Active/S:1732530152004739000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 82", "pointer": "0xc038caadc0"}
2024/11/25 18:22:32.026940 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe5e5aaf65/Active/S:1732530152004739000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 82", "pointer": "0xc038caadc0"}
2024/11/25 18:22:32.031337 +0800 INFO disttae/db.go:456 getOrCreateSnapPart:reuse latest partition state:0xc038da0aa0, tbl:0xc023b17980, table name:mo_database, tid:1, txn:cbf29ce484222325180b2efe5e5aaf65/Active/S:1732530151863304000-0
2024/11/25 18:22:32.031454 +0800 INFO disttae/txn_table.go:1887 Get partition state for snapshot read, tbl:0xc023b17980, table name:mo_database, tid:1, txn:cbf29ce484222325180b2efe5e5aaf65/Active/S:1732530151863304000-0, ps:0xc038da0aa0
2024/11/25 18:22:32.033763 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "show databases {MO_TS=1732530151863304000}", "txn-id": "cbf29ce484222325180b2efe5e5aaf65", "duration": "7.211542ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:22:32.034103 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:32.034178 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:32.034156 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:32.034273 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:32.034173 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:32.034250 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:32.034416 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:32.044507 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:32.049700 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:32.055463 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:32.055677 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:32.063040 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:32.064742 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:32.083130 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "750ns"}
2024/11/25 18:22:32.083295 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "290.167µs", "checkpointed": "0-0"}
2024/11/25 18:22:32.083446 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.75µs"}
2024/11/25 18:22:32.083590 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:32.083674 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:32.083739 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:32.083854 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "448.958µs"}
2024/11/25 18:22:32.084069 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:32.084329 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:32.084409 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "21.208625ms", "err": null}
2024/11/25 18:22:32.084416 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:32.084510 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "196µs"}
2024/11/25 18:22:32.084591 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "262.458µs"}
2024/11/25 18:22:32.084682 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:32.084709 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:32.084758 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "82.083µs"}
2024/11/25 18:22:32.084843 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "160.375µs"}
2024/11/25 18:22:32.085265 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9"}
2024/11/25 18:22:32.085610 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:32.085761 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:32.085873 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:32.085884 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:32.086013 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "150.042µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:32.086119 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "247.25µs"}
2024/11/25 18:22:32.087186 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:32.087173 +0800 INFO logtail/mgr.go:169 init waterline to 1732530152087064000-0
2024/11/25 18:22:32.087354 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "to": "PhysicalTime:1732530152087064000 "}
2024/11/25 18:22:32.089143 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:32.089268 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc038da1c20"}
2024/11/25 18:22:32.089370 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc038da1cc0"}
2024/11/25 18:22:32.089455 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc038da1d60"}
2024/11/25 18:22:32.194492 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:32.194675 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:32.195674 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": ""}
2024/11/25 18:22:32.195900 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:32.196396 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530152194866000-0", "minTs": "1732530152196217000-0"}
2024/11/25 18:22:32.196550 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530152194866000 "}
2024/11/25 18:22:32.196942 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:32.197085 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:32.197268 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:32.198592 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530152194866000-0", "minTs": "1732530152196217000-0"}
2024/11/25 18:22:32.200905 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530152194866000 "}
2024/11/25 18:22:32.201256 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:32.201356 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:32.202326 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:32.202922 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530152200861000 "}
2024/11/25 18:22:32.205017 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:32.205113 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:32.205168 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-90]1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "extra-info": {"a-objs": "4c3cb9c9d397_0,", "a-tombstones": "0f21776bc82e_0,"}, "txn-info": "ctx[019362D8230D7007ADFEF01BCE750D5B][1732530152204822000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:32.205869 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-90]1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "sort-key": "mock_0"}
2024/11/25 18:22:32.212169 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:32.220987 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:32.223227 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-90]1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:32.227589 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efe75cf1c32/Active/S:1732530152200861000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0171c5540"}
2024/11/25 18:22:32.232874 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:32.232989 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530152200861000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:32.233282 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:32.238787 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-90]1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "aobj-deletes": 1, "aobj-merge-rows": 9, "tombstone-rows": 1, "duration": "33.470125ms", "extra-info": {"a-objs": "4c3cb9c9d397_0,", "a-tombstones": "0f21776bc82e_0,", "to-objs": "7b28b38a946f_0,", "to-tombstones": "f9eb53240d48_0,"}}
2024/11/25 18:22:32.709014 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:22:33.242291 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "table": "db_id:1000 tb_id:1000 "}
2024/11/25 18:22:33.244236 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "table": "db_id:1000 tb_id:1000 db_name:\"db\" tb_name:\"2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751\" ", "To": "PhysicalTime:1732530153242910000 "}
2024/11/25 18:22:33.244779 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1000, "service": "", "addr": "0xc0263b9ea0"}
2024/11/25 18:22:33.245249 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 1000, tbl: 1000] resp received, 0xc01f90a930
2024/11/25 18:22:33.246877 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-93]-1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "txn-info": "ctx[019362D8271E793B8531DB211E114E9B][1732530153244868000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530153244868000-0", "from-objs": "7b28b38a946f_0(1, 4.622KiB)Rows(9),", "from-size": "4.622KiB", "est-size": "180B", "num-obj": 1, "num-blk": 1, "rows": 9}
2024/11/25 18:22:33.261055 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-93]-1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "to-objs": "2a970ab8e4e4_0(1, 4.622KiB)Rows(9),", "to-size": "4.622KiB", "duration": "14.256083ms"}
2024/11/25 18:22:33.268894 +0800 INFO txnentries/mergeobjects.go:445 [MERGE-PREPARE-COMMIT] {"table-id": 1000, "task": "[MT-93]-1000-2024-11-25 18:22:32.194821 +0800 CST m=+48.776201751", "total-transfer": 0, "in-queue-transfer": 0, "total-cost": "19.167µs", "this-tran-cost": "1.875µs", "commit-ts": "1732530153268789000-0"}
2024/11/25 18:22:33.269013 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:22:33.272758 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-94]-1000-tombstone", "txn-info": "ctx[019362D8273873DCA7BD732163B78B87][1732530153271038000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530153271038000-0", "from-objs": "f9eb53240d48_0(1, 1.945KiB)Rows(1),", "from-size": "1.945KiB", "est-size": "20B", "num-obj": 1, "num-blk": 1, "rows": 1}
2024/11/25 18:22:33.275607 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-94]-1000-tombstone", "to-objs": "", "to-size": "0B", "duration": "2.976667ms"}
2024/11/25 18:22:33.276251 +0800 INFO txnentries/mergeobjects.go:404 [MERGE-PREPARE-COMMIT] {"table-id": 1000, "created-objs": 0, "skip-transfer": true, "task": "[MT-94]-1000-tombstone", "commit-ts": "1732530153276177000-0"}
2024/11/25 18:22:33.293128 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:33.298379 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:33.304669 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:33.304824 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:33.310134 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:33.310149 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:33.310259 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:33.310213 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:33.310389 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:33.310464 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:33.310697 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:33.315216 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:33.318468 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:33.338758 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "542ns"}
2024/11/25 18:22:33.338908 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "248.042µs", "checkpointed": "0-0"}
2024/11/25 18:22:33.339021 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.125µs"}
2024/11/25 18:22:33.339113 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:33.339157 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:33.339200 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:33.339249 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "264.167µs"}
2024/11/25 18:22:33.339352 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:33.339469 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:33.339542 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "24.064ms", "err": null}
2024/11/25 18:22:33.339552 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "97.833µs"}
2024/11/25 18:22:33.339605 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "135.5µs"}
2024/11/25 18:22:33.339568 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:33.339638 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:33.339683 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "47.958µs"}
2024/11/25 18:22:33.339712 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:33.339760 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "122.042µs"}
2024/11/25 18:22:33.340015 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a"}
2024/11/25 18:22:33.340081 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:33.340154 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:33.340201 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:33.340200 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:33.340270 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "75.166µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:33.340310 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "110.333µs"}
2024/11/25 18:22:33.340850 +0800 INFO logtail/mgr.go:169 init waterline to 1732530153340755000-0
2024/11/25 18:22:33.340932 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "to": "PhysicalTime:1732530153340755000 "}
2024/11/25 18:22:33.340988 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:33.341993 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:33.342069 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc027ec2320"}
2024/11/25 18:22:33.342117 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc027ec23c0"}
2024/11/25 18:22:33.342161 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc027ec2460"}
2024/11/25 18:22:33.346833 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:33.346887 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:33.347992 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": ""}
2024/11/25 18:22:33.348225 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:33.348645 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530153346777000-0", "minTs": "0-0"}
2024/11/25 18:22:33.348896 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530153346777000 "}
2024/11/25 18:22:33.349502 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:33.349707 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:33.350435 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:33.350912 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530153346777000-0", "minTs": "1732530153348781000-0"}
2024/11/25 18:22:33.350985 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530153346777000 "}
2024/11/25 18:22:33.351189 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:33.351248 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:33.351562 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:33.354054 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530153346777000-0", "minTs": "1732530153348781000-0"}
2024/11/25 18:22:33.354286 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530153346777000 "}
2024/11/25 18:22:33.354807 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:33.354871 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:33.358132 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-95]1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "extra-info": {"a-objs": "90266194635c_0,", "a-tombstones": "3c3868bdc1fb_0,"}, "txn-info": "ctx[019362D8278E70A4A54D022259FCAB88][1732530153356600000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:33.359298 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:33.361099 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:33.364016 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efec08ac352/Active/S:1732530153346777000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc027ec2d20"}
2024/11/25 18:22:33.368669 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:33.371103 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530153346777000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:33.371235 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:33.374047 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-95]1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:33.387897 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-95]1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "aobj-deletes": 1, "aobj-merge-rows": 9, "tombstone-rows": 1, "duration": "29.671708ms", "extra-info": {"a-objs": "90266194635c_0,", "a-tombstones": "3c3868bdc1fb_0,", "to-objs": "8d02e43f9799_0,", "to-tombstones": "2af465599def_0,"}}
2024/11/25 18:22:34.391323 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "table": "db_id:1000 tb_id:1000 "}
2024/11/25 18:22:34.394392 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "table": "db_id:1000 tb_id:1000 db_name:\"db\" tb_name:\"2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835\" primary_seqnum:10 ", "To": "PhysicalTime:1732530154392533000 "}
2024/11/25 18:22:34.395105 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1000, "service": "", "addr": "0xc02979d220"}
2024/11/25 18:22:34.395774 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 1000, tbl: 1000] resp received, 0xc01f90abb0
2024/11/25 18:22:34.396929 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-98]-1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "txn-info": "ctx[019362D82B9C79278E256B22DEC5C404][1732530154396532000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530154396532000-0", "from-objs": "8d02e43f9799_0(1, 4.964KiB)Rows(9),", "from-size": "4.964KiB", "est-size": "180B", "num-obj": 1, "num-blk": 1, "rows": 9}
2024/11/25 18:22:34.412776 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-98]-1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "to-objs": "d1ea91e67624_0(1, 4.964KiB)Rows(9),", "to-size": "4.964KiB", "duration": "15.944167ms"}
2024/11/25 18:22:34.419826 +0800 INFO txnentries/mergeobjects.go:445 [MERGE-PREPARE-COMMIT] {"table-id": 1000, "task": "[MT-98]-1000-2024-11-25 18:22:33.346966 +0800 CST m=+49.928351835", "total-transfer": 0, "in-queue-transfer": 0, "total-cost": "32.208µs", "this-tran-cost": "3.208µs", "commit-ts": "1732530154419643000-0"}
2024/11/25 18:22:34.423858 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-99]-1000-tombstone", "txn-info": "ctx[019362D82BB774328AF22458AA34310F][1732530154422719000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530154422719000-0", "from-objs": "2af465599def_0(1, 1.952KiB)Rows(1),", "from-size": "1.952KiB", "est-size": "20B", "num-obj": 1, "num-blk": 1, "rows": 1}
2024/11/25 18:22:34.426364 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-99]-1000-tombstone", "to-objs": "", "to-size": "0B", "duration": "2.656458ms"}
2024/11/25 18:22:34.426953 +0800 INFO txnentries/mergeobjects.go:404 [MERGE-PREPARE-COMMIT] {"table-id": 1000, "created-objs": 0, "skip-transfer": true, "task": "[MT-99]-1000-tombstone", "commit-ts": "1732530154426896000-0"}
2024/11/25 18:22:34.438231 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:34.443438 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:34.449473 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:34.449800 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:34.455686 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:34.455729 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:34.455977 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:34.456204 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:34.456204 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:34.456294 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:34.456329 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:34.456411 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:34.456399 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:34.459291 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:34.460898 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:34.506064 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "417ns"}
2024/11/25 18:22:34.506173 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "178.542µs", "checkpointed": "0-0"}
2024/11/25 18:22:34.506284 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "5.667µs"}
2024/11/25 18:22:34.506408 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:34.506538 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:34.506586 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:34.506766 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "523.334µs"}
2024/11/25 18:22:34.506955 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:34.507179 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:34.507302 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "47.798417ms", "err": null}
2024/11/25 18:22:34.507312 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:34.507306 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "145.333µs"}
2024/11/25 18:22:34.507436 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "256.292µs"}
2024/11/25 18:22:34.507532 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:34.507590 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "61.375µs"}
2024/11/25 18:22:34.507665 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:34.507640 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "108.208µs"}
2024/11/25 18:22:34.508270 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:34.508276 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769"}
2024/11/25 18:22:34.508350 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:34.508410 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:34.508420 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:34.508502 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "91.125µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:34.508576 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "156.334µs"}
2024/11/25 18:22:34.509965 +0800 INFO logtail/mgr.go:169 init waterline to 1732530154509895000-0
2024/11/25 18:22:34.510105 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "to": "PhysicalTime:1732530154509895000 "}
2024/11/25 18:22:34.511217 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:34.512739 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:34.512848 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc02970fd60"}
2024/11/25 18:22:34.512912 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc02970fe00"}
2024/11/25 18:22:34.512976 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc02970fea0"}
2024/11/25 18:22:34.583826 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:34.617943 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:34.618191 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:34.619606 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": ""}
2024/11/25 18:22:34.619797 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:34.620352 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530154617882000-0", "minTs": "0-0"}
2024/11/25 18:22:34.620544 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530154617882000 "}
2024/11/25 18:22:34.620987 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:34.621124 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:34.622039 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:34.622502 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530154621983000-0", "minTs": "0-0"}
2024/11/25 18:22:34.622668 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530154621983000 "}
2024/11/25 18:22:34.623044 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:34.623166 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:34.624141 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:34.624725 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530154624013000-0", "minTs": "0-0"}
2024/11/25 18:22:34.624883 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530154624013000 "}
2024/11/25 18:22:34.625239 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:34.625355 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:34.631518 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:34.635905 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:34.639976 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2eff064ad3ab/Active/S:1732530154624013000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc020176aa0"}
2024/11/25 18:22:34.645214 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:34.645331 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530154624013000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:34.645510 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:34.672091 +0800 INFO disttae/txn.go:167 INJECT-LOG-WORKSPACE {"table": "mo_account", "db": "db", "txn": "cbf29ce484222325180b2eff064ad3aa/Active/S:1732530154624013000-1", "typ": "insert", "offset": 3, "data": "[__mo_rowid] = [2]: 019362d8-2cae-7897-b7ba-b4d73d87262e-4-0-0,019362d8-2cae-7897-b7ba-b4d73d87262e-4-0-1\n[mock_0] = [2]: 22,25\n[mock_1] = [2]: 0,1\n[mock_2] = [2]: 982757099,54476854\n[mock_3] = [2]: 4721783381234499943,4608451028177135156\n[mock_4] = [2]: 147,89\n"}
2024/11/25 18:22:34.673624 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFF064AD3AA][1732530154624013000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:34.670810 UTC}"}
2024/11/25 18:22:34.674347 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFF064AD3AA][1732530154624013000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-mo_account"}
2024/11/25 18:22:34.685135 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "11.631083ms", "cn-txn": "cbf29ce484222325180b2eff064ad3aa/Active/S:1732530154624013000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFF064AD3AA][1732530154624013000-1->1732530154676843000-0][Committed]: <nil>"}
2024/11/25 18:22:34.743783 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:35.685803 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:35.687912 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db\" tb_name:\"mo_account\" primary_seqnum:1 ", "To": "PhysicalTime:1732530155685893000 "}
2024/11/25 18:22:35.688612 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc02debf0e0"}
2024/11/25 18:22:35.689243 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_account", "table-id": 16385, "ps": "0xc02debf180", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530154676843000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 16384\n[table_id] = [1]: 16385\n[create_at] = [1]: 1732530154676843000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530154624013000-1\n[prepare_ts] = [1]: 1732530154676843000-0\n[commit_ts] = [1]: 1732530154676843000-0\n"}
2024/11/25 18:22:35.689827 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_account", "table-id": 16385, "ps": "0xc02debf180", "data": "[__mo_rowid] = [2]: 019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-0,019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-1\n[__mo_%1_commit_time] = [2]: 1732530154676843000-0,1732530154676843000-0\n[mock_0] = [2]: 22,25\n[mock_1] = [2]: 0,1\n[mock_2] = [2]: 982757099,54476854\n[mock_3] = [2]: 4721783381234499943,4608451028177135156\n[mock_4] = [2]: 147,89\n"}
2024/11/25 18:22:35.690159 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc02a347d30
2024/11/25 18:22:35.722222 +0800 INFO plan/build_util.go:61 Row lock upgraded to table lock for SQL : delete from db.mo_account where mock_1 in (0, 1)
2024/11/25 18:22:35.722535 +0800 INFO plan/build_util.go:62 the outcnt stats is 50.000000
2024/11/25 18:22:35.726832 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, mo_account] succeed
2024/11/25 18:22:35.727768 +0800 INFO disttae/local_disttae_datasource.go:319 LOGREADER-INJECTED-2 {"table": "mo_account", "txn": "cbf29ce484222325180b2eff064ad3ac/Active/S:1732530155718105000-1", "data": "[mock_1] = [2]: 0,1\n[__mo_rowid] = [2]: 019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-0,019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-1\n", "ps": "0xc02debf180"}
2024/11/25 18:22:35.728101 +0800 INFO engine_util/reader.go:436 LOGREADER-INJECTED-1 {"name": "mo_account", "data": "[mock_1] = [2]: 0,1\n[__mo_rowid] = [2]: 019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-0,019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-1\n"}
2024/11/25 18:22:35.728803 +0800 INFO disttae/txn.go:167 INJECT-LOG-WORKSPACE {"table": "mo_account", "db": "db", "txn": "cbf29ce484222325180b2eff064ad3ac/Active/S:1732530155718105000-1", "typ": "delete", "offset": 0, "data": "[__mo_rowid] = [2]: 019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-0,019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-1\n[pk] = [2]: 0,1\n"}
2024/11/25 18:22:35.729288 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "delete from db.mo_account where mock_1 in (0, 1)", "txn-id": "cbf29ce484222325180b2eff064ad3ac", "duration": "10.30325ms", "BatchSize": 0, "retry-times": 0, "AffectedRows": 2}
2024/11/25 18:22:35.737966 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-100]16385-mo_account", "extra-info": {"a-objs": "", "a-tombstones": "53c1016bd760_0,"}, "txn-info": "ctx[019362D830D976BEBFBA29E19393425F][1732530155736120000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:35.738196 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-DEL {"table-name": "mo_account", "table-id": 16385, "ps": "0xc02d360960", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530155730493000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 16384\n[table_id] = [1]: 16385\n[create_at] = [1]: 1732530155730493000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530155718105000-1\n[prepare_ts] = [1]: 1732530155730493000-0\n[commit_ts] = [1]: 1732530155730493000-0\n"}
2024/11/25 18:22:35.738558 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-100]16385-mo_account", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:35.738623 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-DEL {"table-name": "mo_account", "table-id": 16385, "ps": "0xc02d360960", "data": "[__mo_%1_delete_rowid] = [2]: 019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-0,019362d8-2cb4-74c6-89c9-5e2eb21d82f4-0-0-1\n[__mo_%1_commit_time] = [2]: 1732530155730493000-0,1732530155730493000-0\n[__mo_%1_pk_val] = [2]: 0,1\n[__mo_rowid] = [2]: 019362d8-30d2-73ff-b344-53c1016bd760-0-0-0,019362d8-30d2-73ff-b344-53c1016bd760-0-0-1\n"}
2024/11/25 18:22:35.759264 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-100]16385-mo_account", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 2, "duration": "21.034ms", "extra-info": {"a-objs": "", "a-tombstones": "53c1016bd760_0,", "to-tombstones": "7739fa07b84f_0,"}}
2024/11/25 18:22:35.766408 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-DEL {"table-name": "mo_account", "table-id": 16385, "ps": "0xc02df37900", "data": "[__mo_rowid] = [2]: 00000000-0000-0000-0000-000000000000-0-0-0,00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [2]: 1732530155759989000-0,1732530155759989000-0\n[object_stats] = [2]: binary[154],binary[154]\n[db_id] = [2]: 16384,16384\n[table_id] = [2]: 16385,16385\n[create_at] = [2]: 1732530155759989000-0,1732530155730493000-0\n[delete_at] = [2]: 0-0,1732530155759989000-0\n[start_ts] = [2]: 1732530155736120000-0,1732530155736120000-0\n[prepare_ts] = [2]: 1732530155759989000-0,1732530155759989000-0\n[commit_ts] = [2]: 1732530155759989000-0,1732530155759989000-0\n"}
2024/11/25 18:22:35.817640 +0800 INFO disttae/txn.go:167 INJECT-LOG-WORKSPACE {"table": "mo_account", "db": "db", "txn": "cbf29ce484222325180b2eff064ad3ad/Active/S:1732530155816159000-1", "typ": "insert", "offset": 0, "data": "[__mo_rowid] = [2]: 019362d8-3128-7dcb-b51b-277568115bf3-1-0-0,019362d8-3128-7dcb-b51b-277568115bf3-1-0-1\n[mock_0] = [2]: 93,20\n[mock_1] = [2]: 2,3\n[mock_2] = [2]: 802098577,1039516876\n[mock_3] = [2]: 8574715364487941221,270730877653781482\n[mock_4] = [2]: 13,82\n"}
2024/11/25 18:22:35.823037 +0800 INFO disttae/local_disttae_datasource.go:319 LOGREADER-INJECTED-2 {"table": "mo_account", "txn": "cbf29ce484222325180b2eff064ad3ad/Active/S:1732530155816159000-1", "data": "[mock_0] = [2]: 93,20\n[mock_1] = [2]: 2,3\n[mock_2] = [2]: 802098577,1039516876\n[mock_3] = [2]: 8574715364487941221,270730877653781482\n[mock_4] = [2]: 13,82\n", "ps": "0xc02df37900"}
2024/11/25 18:22:35.823455 +0800 INFO engine_util/reader.go:436 LOGREADER-INJECTED-1 {"name": "mo_account", "data": "[mock_0] = [2]: 93,20\n[mock_1] = [2]: 2,3\n[mock_2] = [2]: 802098577,1039516876\n[mock_3] = [2]: 8574715364487941221,270730877653781482\n[mock_4] = [2]: 13,82\n"}
2024/11/25 18:22:35.823947 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select * from db.mo_account", "txn-id": "cbf29ce484222325180b2eff064ad3ad", "duration": "5.866917ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:22:35.824438 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:35.824534 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:35.824510 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:35.824456 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:35.824698 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:35.824767 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:35.824878 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:35.835254 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:35.840358 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:35.846811 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:35.846998 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:35.854509 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:35.856639 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:35.875355 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "500ns"}
2024/11/25 18:22:35.875521 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "299.875µs", "checkpointed": "0-0"}
2024/11/25 18:22:35.875665 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "13µs"}
2024/11/25 18:22:35.875798 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:35.875880 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:35.875932 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:35.876040 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "433.792µs"}
2024/11/25 18:22:35.876239 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:35.876445 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:35.876521 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "21.250375ms", "err": null}
2024/11/25 18:22:35.876523 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:35.876582 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "160.75µs"}
2024/11/25 18:22:35.876669 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "224.375µs"}
2024/11/25 18:22:35.876816 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:35.876819 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:35.876976 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "183.625µs"}
2024/11/25 18:22:35.877042 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "224.25µs"}
2024/11/25 18:22:35.877176 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242"}
2024/11/25 18:22:35.877279 +0800 INFO logtail/mgr.go:169 init waterline to 1732530155877154000-0
2024/11/25 18:22:35.877392 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "to": "PhysicalTime:1732530155877154000 "}
2024/11/25 18:22:35.877936 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:35.878147 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:35.878258 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:35.878253 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:35.878268 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:35.878382 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "132.25µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:35.878467 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "215.792µs"}
2024/11/25 18:22:35.879858 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:35.879961 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc02df68960"}
2024/11/25 18:22:35.880122 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc02df68a00"}
2024/11/25 18:22:35.880226 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc02df68aa0"}
2024/11/25 18:22:35.912842 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:35.986600 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:35.986876 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:35.988568 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "stream-id": 1, "remote": ""}
2024/11/25 18:22:35.988893 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:35.989593 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530155987226000-0", "minTs": "0-0"}
2024/11/25 18:22:35.989829 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530155989133000 "}
2024/11/25 18:22:35.990383 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:35.990543 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:35.991044 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:35.991556 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530155991117000-0", "minTs": "0-0"}
2024/11/25 18:22:35.991726 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530155991117000 "}
2024/11/25 18:22:35.992146 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:35.992309 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:35.993202 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:35.993671 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530155993143000-0", "minTs": "0-0"}
2024/11/25 18:22:35.993821 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530155993143000 "}
2024/11/25 18:22:35.994185 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:35.994303 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:36.002553 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:36.007871 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:36.012474 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2eff57c65aba/Active/S:1732530155993143000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc02deefcc0"}
2024/11/25 18:22:36.017614 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:36.017759 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530155993143000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:36.017923 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:36.017931 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:36.238716 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABB][1732530156091308000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:36.091990 UTC}"}
2024/11/25 18:22:36.239002 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABB][1732530156091308000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16385-padding"}
2024/11/25 18:22:36.271006 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABB][1732530156091308000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16386-table2"}
2024/11/25 18:22:36.333694 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:22:36.382503 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "143.832667ms", "cn-txn": "cbf29ce484222325180b2eff57c65abb/Active/S:1732530156091308000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFF57C65ABB][1732530156091308000-1->1732530156279025000-0][Committed]: <nil>"}
2024/11/25 18:22:36.385600 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "chunk-number": 185, "chunk-limit": 16351, "message-size": 3011400}
2024/11/25 18:22:36.508962 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2eff57c65abc/Active/S:1732530156433261000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 8253", "pointer": "0xc0059c4960"}
2024/11/25 18:22:36.634857 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABC][1732530156433261000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16385 NewId:0 Name:padding DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:36.665970 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:22:36.725766 +0800 INFO rpc/handle.go:704 PreCommit-DropTBL {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABC][1732530156433261000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{IsDrop:true Id:16386 NewId:0 Name:table2 DatabaseId:16384 DatabaseName:db}"}
2024/11/25 18:22:36.821421 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "186.587083ms", "cn-txn": "cbf29ce484222325180b2eff57c65abc/Active/S:1732530156433261000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFF57C65ABC][1732530156433261000-1->1732530156762983000-0][Committed]: <nil>"}
2024/11/25 18:22:36.822161 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-3164-7d13-a927-c505916f4242", "chunk-number": 57, "chunk-limit": 16351, "message-size": 926978}
2024/11/25 18:22:36.954799 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFF57C65ABD][1732530156873258000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db:16387-table2"}
2024/11/25 18:22:36.958696 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "3.915458ms", "cn-txn": "cbf29ce484222325180b2eff57c65abd/Active/S:1732530156873258000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFF57C65ABD][1732530156873258000-1->1732530156955639000-0][Committed]: <nil>"}
2024/11/25 18:22:36.959013 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-102]3-mo_columns", "extra-info": {"a-objs": "", "a-tombstones": "7fb2e37c2951_0,1dba103e8e63_0,"}, "txn-info": "ctx[019362D8359E7C44BEFD535B33E2392B][1732530156957262000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:36.974921 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-102]3-mo_columns", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:37.068442 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-102]3-mo_columns", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 8195, "duration": "109.363917ms", "extra-info": {"a-objs": "", "a-tombstones": "7fb2e37c2951_0,1dba103e8e63_0,", "to-tombstones": "3d6e1bece305_0,"}}
2024/11/25 18:22:37.193323 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:37.215073 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2eff57c65abe/Active/S:1732530157123257000-1", "desc": "PartitionState(tid:3) objLen 0, rowsLen 8258", "pointer": "0xc0059c55e0"}
2024/11/25 18:22:37.218472 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select __mo_rowid from `mo_catalog`.`mo_columns` where account_id = 0 and att_database = \"db\" and att_relname = \"table2\" and att_relname_id = 16387 order by attnum", "txn-id": "cbf29ce484222325180b2eff57c65abe", "duration": "4.5335ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:22:37.218654 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.218686 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:37.218687 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:37.218701 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.218729 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:37.218782 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:37.218813 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:37.218765 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:37.218848 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:37.223745 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:37.228983 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:37.234542 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:37.234628 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:37.235519 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:37.236104 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:37.243102 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "375ns"}
2024/11/25 18:22:37.243154 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "81.958µs", "checkpointed": "0-0"}
2024/11/25 18:22:37.243206 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "2.875µs"}
2024/11/25 18:22:37.243272 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:37.243315 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:37.243350 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:37.243394 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "208.084µs"}
2024/11/25 18:22:37.243485 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:37.243731 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "8.144167ms", "err": null}
2024/11/25 18:22:37.243697 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:37.243738 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:37.243808 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "121.209µs"}
2024/11/25 18:22:37.243849 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "151.583µs"}
2024/11/25 18:22:37.243881 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:37.243893 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:37.243918 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "39.917µs"}
2024/11/25 18:22:37.243964 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "82.875µs"}
2024/11/25 18:22:37.244179 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2"}
2024/11/25 18:22:37.244331 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:37.244382 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:37.244425 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:37.244433 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:37.244471 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "49.333µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:37.244510 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "85.875µs"}
2024/11/25 18:22:37.245102 +0800 INFO logtail/mgr.go:169 init waterline to 1732530157245035000-0
2024/11/25 18:22:37.245175 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "to": "PhysicalTime:1732530157245035000 "}
2024/11/25 18:22:37.245704 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:37.246563 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:37.246625 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc033a06960"}
2024/11/25 18:22:37.246662 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc033a07180"}
2024/11/25 18:22:37.246703 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc033a07220"}
2024/11/25 18:22:37.349440 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:37.349524 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:37.350057 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": ""}
2024/11/25 18:22:37.350137 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:37.350419 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157349090000-0", "minTs": "0-0"}
2024/11/25 18:22:37.350518 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530157349090000 "}
2024/11/25 18:22:37.350745 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.350821 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:37.350910 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:37.351147 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157349090000-0", "minTs": "0-0"}
2024/11/25 18:22:37.351236 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530157351018000 "}
2024/11/25 18:22:37.351424 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.351496 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:37.352038 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:37.352253 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157351018000-0", "minTs": "0-0"}
2024/11/25 18:22:37.352336 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530157351018000 "}
2024/11/25 18:22:37.352512 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.352583 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:37.357155 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:37.359740 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:37.362029 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2effa947e0f3/Active/S:1732530157351018000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc007b103c0"}
2024/11/25 18:22:37.364821 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:37.364877 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530157351018000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.364958 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:37.401712 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.401740 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.401727 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:37.401755 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:37.401792 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:37.401788 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:37.401966 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:37.402079 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:37.402149 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:37.412083 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:37.417245 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:37.423051 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:37.423191 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:37.424818 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:37.426096 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:37.436392 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "667ns"}
2024/11/25 18:22:37.436505 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "161.5µs", "checkpointed": "0-0"}
2024/11/25 18:22:37.436634 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.75µs"}
2024/11/25 18:22:37.436757 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:37.436820 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:37.436861 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:37.436936 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "337.916µs"}
2024/11/25 18:22:37.437089 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:37.437282 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:37.437322 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "12.417ms", "err": null}
2024/11/25 18:22:37.437344 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:37.437386 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "127.459µs"}
2024/11/25 18:22:37.437449 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "166.625µs"}
2024/11/25 18:22:37.437501 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:37.437519 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:37.437568 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "72.625µs"}
2024/11/25 18:22:37.437672 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e"}
2024/11/25 18:22:37.437681 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "180.834µs"}
2024/11/25 18:22:37.438162 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:37.438315 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:37.438418 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:37.438503 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:37.438513 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:37.438584 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "76.875µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:37.438655 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "142.875µs"}
2024/11/25 18:22:37.438668 +0800 INFO logtail/mgr.go:169 init waterline to 1732530157438523000-0
2024/11/25 18:22:37.438819 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "to": "PhysicalTime:1732530157438523000 "}
2024/11/25 18:22:37.439696 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:37.439815 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc00dbb7220"}
2024/11/25 18:22:37.439880 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc00dbb72c0"}
2024/11/25 18:22:37.439933 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc00dbb7360"}
2024/11/25 18:22:37.544874 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:37.545179 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:37.546280 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": ""}
2024/11/25 18:22:37.546566 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:37.548439 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157546396000-0", "minTs": "0-0"}
2024/11/25 18:22:37.548745 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530157546396000 "}
2024/11/25 18:22:37.549363 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.549503 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:37.550173 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:37.550623 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157548614000-0", "minTs": "0-0"}
2024/11/25 18:22:37.550761 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530157550302000 "}
2024/11/25 18:22:37.551263 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.551411 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:37.552342 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:37.553288 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530157552298000-0", "minTs": "0-0"}
2024/11/25 18:22:37.553469 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530157552298000 "}
2024/11/25 18:22:37.554610 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.554775 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:37.562182 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:37.566877 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:37.571207 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2effb4c091eb/Active/S:1732530157552298000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0133fe0a0"}
2024/11/25 18:22:37.575587 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:37.575692 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530157552298000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:37.575840 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:37.600008 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFFB4C091EA][1732530157552298000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:37.597840 UTC}"}
2024/11/25 18:22:37.600908 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFFB4C091EA][1732530157552298000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:37.610199 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "10.390209ms", "cn-txn": "cbf29ce484222325180b2effb4c091ea/Active/S:1732530157552298000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFFB4C091EA][1732530157552298000-1->1732530157603105000-0][Committed]: <nil>"}
2024/11/25 18:22:37.610531 +0800 INFO disttae/mo_table_stats.go:512 MO-TABLE-STATS-TASK {"source": "set move on", "state": "move on: true to false"}
2024/11/25 18:22:37.662804 +0800 INFO plan/build_util.go:61 Row lock upgraded to table lock for SQL : insert into `db1`.`test1` values(1,1,1),(2,2,2),(3,3,3),(4,4,4);
2024/11/25 18:22:37.663014 +0800 INFO plan/build_util.go:62 the outcnt stats is 4.000000
2024/11/25 18:22:37.665351 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "insert into `db1`.`test1` values(1,1,1),(2,2,2),(3,3,3),(4,4,4);", "txn-id": "cbf29ce484222325180b2effb4c091ec", "duration": "4.283ms", "BatchSize": 0, "retry-times": 0, "AffectedRows": 4}
2024/11/25 18:22:37.714077 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3891-7dcf-82b7-e963901f1abe"}
2024/11/25 18:22:37.763975 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3891-7dcf-82b7-e963901f1abe", "statement_id": "019362d8-3892-7b94-bfea-f10865c0dc63", "txn_id": "cbf29ce484222325180b2effb4c091ee"}
2024/11/25 18:22:37.764170 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3891-7dcf-82b7-e963901f1abe", "statement_id": "019362d8-3892-7b94-bfea-f10865c0dc63", "txn_id": "cbf29ce484222325180b2effb4c091ee"}
2024/11/25 18:22:37.764472 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3891-7dcf-82b7-e963901f1abe", "statement_id": "019362d8-3892-7b94-bfea-f10865c0dc63", "txn_id": "cbf29ce484222325180b2effb4c091ee"}
2024/11/25 18:22:37.764688 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effb4c091ee:1732530157762352000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3891-7dcf-82b7-e963901f1abe", "statement_id": "019362d8-3892-7b94-bfea-f10865c0dc63"}
2024/11/25 18:22:37.764852 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "normal query", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect \n    \t\t\t\ttable_id, update_time, COALESCE(table_stats, CAST('{}' AS JSON)) from  mo_catalog.mo_table_stats_alpha\n              \twhere \n                \taccount_id in (0) and \n                \tdatabase_id in (16384) and \n                  \ttable_id in (16385) \n\t\t\t  \torder by table_id asc;"}
2024/11/25 18:22:37.765033 +0800 ERROR function/func_mo.go:272 MoTableSizeRows {"error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "db": "db1", "table": "test1", "account id": 0, "tbl list": "[db1-test1]; "}
2024/11/25 18:22:37.765460 +0800 ERROR compile/sql_executor.go:140 internal sql executor error: SQL parser error: table "mo_table_stats_alpha" does not exist
2024/11/25 18:22:37.765621 +0800 INFO disttae/mo_table_stats.go:544 MO-TABLE-STATS-TASK {"source": "set force update", "state": "force update: false to true"}
2024/11/25 18:22:37.816164 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-38f8-718e-918f-ebc3d0299fba"}
2024/11/25 18:22:37.827738 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:22:37.867196 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-38f8-718e-918f-ebc3d0299fba", "statement_id": "019362d8-38f8-7835-b965-c4f80fd4edb5", "txn_id": "cbf29ce484222325180b2effb4c091f0"}
2024/11/25 18:22:37.867419 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-38f8-718e-918f-ebc3d0299fba", "statement_id": "019362d8-38f8-7835-b965-c4f80fd4edb5", "txn_id": "cbf29ce484222325180b2effb4c091f0"}
2024/11/25 18:22:37.867719 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-38f8-718e-918f-ebc3d0299fba", "statement_id": "019362d8-38f8-7835-b965-c4f80fd4edb5", "txn_id": "cbf29ce484222325180b2effb4c091f0"}
2024/11/25 18:22:37.867965 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effb4c091f0:1732530157866332000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-38f8-718e-918f-ebc3d0299fba", "statement_id": "019362d8-38f8-7835-b965-c4f80fd4edb5"}
2024/11/25 18:22:37.868126 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "force update query", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect\n\t\t\t\t\ttable_id, update_time\n\t\t\t\tfrom \n\t\t\t\t\tmo_catalog.mo_table_stats_alpha\n\t\t\t\twhere \n\t\t\t\t\taccount_id in (0) and\n\t\t\t\t    database_id in (16384) and\n\t\t\t\t    table_id in (16385);"}
2024/11/25 18:22:37.868269 +0800 ERROR function/func_mo.go:272 MoTableSizeRows {"error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "db": "db1", "table": "test1", "account id": 0, "tbl list": "[db1-test1]; "}
2024/11/25 18:22:37.868699 +0800 ERROR compile/sql_executor.go:140 internal sql executor error: SQL parser error: table "mo_table_stats_alpha" does not exist
2024/11/25 18:22:37.868891 +0800 INFO disttae/mo_table_stats.go:528 MO-TABLE-STATS-TASK {"source": "set use old impl", "state": "use old impl: false to true"}
2024/11/25 18:22:37.921193 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:37.923065 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530157922276000 "}
2024/11/25 18:22:37.923908 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc019f5e140"}
2024/11/25 18:22:37.924441 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc02a3461b0
2024/11/25 18:22:37.925220 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:22:37.925714 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select mo_table_rows('db1','test1');", "txn-id": "cbf29ce484222325180b2effb4c091f1", "duration": "6.451416ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:22:37.926074 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:37.926069 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.926197 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:37.926251 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:37.926213 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:37.926318 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:37.926044 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:37.926392 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:37.926512 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:37.936188 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:37.941388 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:37.947425 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:37.947727 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:37.950092 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:37.951339 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:37.965165 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "750ns"}
2024/11/25 18:22:37.965381 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "342.292µs", "checkpointed": "0-0"}
2024/11/25 18:22:37.965628 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "18.834µs"}
2024/11/25 18:22:37.965876 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:37.966082 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:37.966181 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:37.966335 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "819.833µs"}
2024/11/25 18:22:37.966606 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:37.966873 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:37.966950 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "16.740459ms", "err": null}
2024/11/25 18:22:37.967047 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "204.125µs"}
2024/11/25 18:22:37.967127 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:37.967262 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "390.792µs"}
2024/11/25 18:22:37.967358 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:37.967376 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:37.967429 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "76.125µs"}
2024/11/25 18:22:37.967489 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "131.25µs"}
2024/11/25 18:22:37.967503 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6"}
2024/11/25 18:22:37.968062 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:37.968207 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:37.968318 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:37.968325 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:37.968447 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "137.292µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:37.968486 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:37.968568 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "251.375µs"}
2024/11/25 18:22:37.969248 +0800 INFO logtail/mgr.go:169 init waterline to 1732530157969093000-0
2024/11/25 18:22:37.969409 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "to": "PhysicalTime:1732530157969093000 "}
2024/11/25 18:22:37.970556 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:37.970696 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0133d1d60"}
2024/11/25 18:22:37.970812 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc000202b40"}
2024/11/25 18:22:37.970904 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc000202dc0"}
2024/11/25 18:22:38.077296 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:38.077549 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:38.078446 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74f9-aff6-ac71db0ff12d"}
2024/11/25 18:22:38.078659 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74da-b5ce-a1d57bf4c255"}
2024/11/25 18:22:38.079003 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": ""}
2024/11/25 18:22:38.079311 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:38.080294 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158079198000-0", "minTs": "0-0"}
2024/11/25 18:22:38.080543 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530158079198000 "}
2024/11/25 18:22:38.081149 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.081315 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:38.081495 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:38.081941 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158080952000-0", "minTs": "0-0"}
2024/11/25 18:22:38.082125 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530158080952000 "}
2024/11/25 18:22:38.082484 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.082600 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:38.083596 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:38.083921 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158082921000-0", "minTs": "0-0"}
2024/11/25 18:22:38.084046 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530158082921000 "}
2024/11/25 18:22:38.084338 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.084450 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:38.091277 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:38.097011 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:38.101572 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2effd45c8ccd/Active/S:1732530158082921000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc038edec80"}
2024/11/25 18:22:38.107482 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:38.107731 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530158082921000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.107918 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:38.130456 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74da-b5ce-a1d57bf4c255", "statement_id": "019362d8-3a00-72fd-a482-24637ba11653", "txn_id": "cbf29ce484222325180b2effd45c8ccc"}
2024/11/25 18:22:38.130455 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74f9-aff6-ac71db0ff12d", "statement_id": "019362d8-39ff-7eb5-98a6-c2c32f1f08eb", "txn_id": "cbf29ce484222325180b2effd45c8ccb"}
2024/11/25 18:22:38.130692 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74da-b5ce-a1d57bf4c255", "statement_id": "019362d8-3a00-72fd-a482-24637ba11653", "txn_id": "cbf29ce484222325180b2effd45c8ccc"}
2024/11/25 18:22:38.130744 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74f9-aff6-ac71db0ff12d", "statement_id": "019362d8-39ff-7eb5-98a6-c2c32f1f08eb", "txn_id": "cbf29ce484222325180b2effd45c8ccb"}
2024/11/25 18:22:38.131020 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74f9-aff6-ac71db0ff12d", "statement_id": "019362d8-39ff-7eb5-98a6-c2c32f1f08eb", "txn_id": "cbf29ce484222325180b2effd45c8ccb"}
2024/11/25 18:22:38.131020 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74da-b5ce-a1d57bf4c255", "statement_id": "019362d8-3a00-72fd-a482-24637ba11653", "txn_id": "cbf29ce484222325180b2effd45c8ccc"}
2024/11/25 18:22:38.131304 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8ccb:1732530158129125000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74f9-aff6-ac71db0ff12d", "statement_id": "019362d8-39ff-7eb5-98a6-c2c32f1f08eb"}
2024/11/25 18:22:38.131464 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8ccc:1732530158082921000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-39fe-74da-b5ce-a1d57bf4c255", "statement_id": "019362d8-3a00-72fd-a482-24637ba11653"}
2024/11/25 18:22:38.131559 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "gama task: get null stats list", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect \n\t\t\t\t\taccount_id, database_id, table_id \n\t\t\t\tfrom \n\t\t\t\t    mo_catalog.mo_table_stats_alpha\n\t\t\t\twhere \n\t\t\t\t    table_stats = \"{}\"\n\t\t\t\tlimit\n\t\t\t\t\t100;"}
2024/11/25 18:22:38.131660 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "gama task-0-0", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect\n\t\t\t\t\taccount_id\n\t\t\t\tfrom (\n\t\t\t\t\tselect\n\t\t\t\t\t\taccount_id, min(update_time) as min_update\n\t\t\t\t\tfrom\n\t\t\t\t\t\tmo_catalog.mo_table_stats_alpha\n\t\t\t\t\tgroup by\n\t\t\t\t\t\taccount_id\n\t\t\t\t) sub\n\t\t\t\torder by\n\t\t\t\t    min_update asc\n\t\t\t\tlimit 8192;"}
2024/11/25 18:22:38.131962 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a33-7dda-8181-a535aa30e17e"}
2024/11/25 18:22:38.132508 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2EFFD45C8CCA][1732530158082921000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:38.129929 UTC}"}
2024/11/25 18:22:38.133160 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2EFFD45C8CCA][1732530158082921000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:38.143925 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "11.663875ms", "cn-txn": "cbf29ce484222325180b2effd45c8cca/Active/S:1732530158082921000-1", "tn-txn": "ctx[CBF29CE484222325180B2EFFD45C8CCA][1732530158082921000-1->1732530158134993000-0][Committed]: <nil>"}
2024/11/25 18:22:38.144429 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a40-75b4-91e3-b5ee8c257023"}
2024/11/25 18:22:38.146597 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a33-7dda-8181-a535aa30e17e", "statement_id": "019362d8-3a34-7874-855f-d0bc299647e3", "txn_id": "cbf29ce484222325180b2effd45c8cce"}
2024/11/25 18:22:38.146772 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a33-7dda-8181-a535aa30e17e", "statement_id": "019362d8-3a34-7874-855f-d0bc299647e3", "txn_id": "cbf29ce484222325180b2effd45c8cce"}
2024/11/25 18:22:38.147060 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a33-7dda-8181-a535aa30e17e", "statement_id": "019362d8-3a34-7874-855f-d0bc299647e3", "txn_id": "cbf29ce484222325180b2effd45c8cce"}
2024/11/25 18:22:38.147287 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8cce:1732530158134993000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a33-7dda-8181-a535aa30e17e", "statement_id": "019362d8-3a34-7874-855f-d0bc299647e3"}
2024/11/25 18:22:38.147474 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "gama task-1-0", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect\n\t\t\t\t\tdatabase_id\n\t\t\t\tfrom (\n\t\t\t\t\tselect\n\t\t\t\t\t\tdatabase_id, min(update_time) as min_update\n\t\t\t\t\tfrom\n\t\t\t\t\t\tmo_catalog.mo_table_stats_alpha\n\t\t\t\t\tgroup by\n\t\t\t\t\t\tdatabase_id\n\t\t\t\t) sub\n\t\t\t\torder by\n\t\t\t\t    min_update asc\n\t\t\t\tlimit 8192;"}
2024/11/25 18:22:38.147756 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a43-7ad5-9298-471572a6e4ce"}
2024/11/25 18:22:38.196659 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a40-75b4-91e3-b5ee8c257023", "statement_id": "019362d8-3a41-75b1-85be-fd694a242fae", "txn_id": "cbf29ce484222325180b2effd45c8ccf"}
2024/11/25 18:22:38.196643 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a43-7ad5-9298-471572a6e4ce", "statement_id": "019362d8-3a44-723a-b6ea-489154aca0f0", "txn_id": "cbf29ce484222325180b2effd45c8cd0"}
2024/11/25 18:22:38.197001 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a40-75b4-91e3-b5ee8c257023", "statement_id": "019362d8-3a41-75b1-85be-fd694a242fae", "txn_id": "cbf29ce484222325180b2effd45c8ccf"}
2024/11/25 18:22:38.197063 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a43-7ad5-9298-471572a6e4ce", "statement_id": "019362d8-3a44-723a-b6ea-489154aca0f0", "txn_id": "cbf29ce484222325180b2effd45c8cd0"}
2024/11/25 18:22:38.197365 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a40-75b4-91e3-b5ee8c257023", "statement_id": "019362d8-3a41-75b1-85be-fd694a242fae", "txn_id": "cbf29ce484222325180b2effd45c8ccf"}
2024/11/25 18:22:38.197397 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a43-7ad5-9298-471572a6e4ce", "statement_id": "019362d8-3a44-723a-b6ea-489154aca0f0", "txn_id": "cbf29ce484222325180b2effd45c8cd0"}
2024/11/25 18:22:38.197689 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8cd0:1732530158195015000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a43-7ad5-9298-471572a6e4ce", "statement_id": "019362d8-3a44-723a-b6ea-489154aca0f0"}
2024/11/25 18:22:38.197711 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8ccf:1732530158195015000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a40-75b4-91e3-b5ee8c257023", "statement_id": "019362d8-3a41-75b1-85be-fd694a242fae"}
2024/11/25 18:22:38.197936 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "gama task-2-0", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect\n\t\t\t\t\ttable_id\n\t\t\t\tfrom (\n\t\t\t\t\tselect\n\t\t\t\t\t\ttable_id, min(update_time) as min_update\n\t\t\t\t\tfrom\n\t\t\t\t\t\tmo_catalog.mo_table_stats_alpha\n\t\t\t\t\tgroup by\n\t\t\t\t\t\ttable_id\n\t\t\t\t) sub\n\t\t\t\torder by\n\t\t\t\t    min_update asc\n\t\t\t\tlimit 8192;"}
2024/11/25 18:22:38.197936 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "normal query", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect \n    \t\t\t\ttable_id, update_time, COALESCE(table_stats, CAST('{}' AS JSON)) from  mo_catalog.mo_table_stats_alpha\n              \twhere \n                \taccount_id in (0) and \n                \tdatabase_id in (16384) and \n                  \ttable_id in (16385) \n\t\t\t  \torder by table_id asc;"}
2024/11/25 18:22:38.198228 +0800 INFO disttae/mo_table_stats.go:528 MO-TABLE-STATS-TASK {"source": "set use old impl", "state": "use old impl: false to true"}
2024/11/25 18:22:38.198385 +0800 INFO disttae/mo_table_stats.go:528 MO-TABLE-STATS-TASK {"source": "set use old impl", "state": "use old impl: true to false"}
2024/11/25 18:22:38.198550 +0800 INFO disttae/mo_table_stats.go:544 MO-TABLE-STATS-TASK {"source": "set force update", "state": "force update: false to true"}
2024/11/25 18:22:38.198920 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a76-7ce8-9392-f0c42e1d1c9f"}
2024/11/25 18:22:38.248675 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a76-7ce8-9392-f0c42e1d1c9f", "statement_id": "019362d8-3a77-799c-85b7-516ec7e744ab", "txn_id": "cbf29ce484222325180b2effd45c8cd1"}
2024/11/25 18:22:38.249078 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a76-7ce8-9392-f0c42e1d1c9f", "statement_id": "019362d8-3a77-799c-85b7-516ec7e744ab", "txn_id": "cbf29ce484222325180b2effd45c8cd1"}
2024/11/25 18:22:38.249564 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a76-7ce8-9392-f0c42e1d1c9f", "statement_id": "019362d8-3a77-799c-85b7-516ec7e744ab", "txn_id": "cbf29ce484222325180b2effd45c8cd1"}
2024/11/25 18:22:38.249907 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8cd1:1732530158246938000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3a76-7ce8-9392-f0c42e1d1c9f", "statement_id": "019362d8-3a77-799c-85b7-516ec7e744ab"}
2024/11/25 18:22:38.250196 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "force update query", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect\n\t\t\t\t\ttable_id, update_time\n\t\t\t\tfrom \n\t\t\t\t\tmo_catalog.mo_table_stats_alpha\n\t\t\t\twhere \n\t\t\t\t\taccount_id in (0) and\n\t\t\t\t    database_id in (16384) and\n\t\t\t\t    table_id in (16385);"}
2024/11/25 18:22:38.250490 +0800 INFO disttae/mo_table_stats.go:512 MO-TABLE-STATS-TASK {"source": "set move on", "state": "move on: true to false"}
2024/11/25 18:22:38.311291 +0800 INFO disttae/mo_table_stats.go:353 MO-TABLE-STATS-TASK {"source": "launch beta task", "times": 1}
2024/11/25 18:22:38.311765 +0800 WARN disttae/mo_table_stats.go:1309 MO-TABLE-STATS-TASK {"source": "alpha task", "event": "waited err another 10s", "caller": "forceUpdateQuery", "total": 1, "left": 1}
2024/11/25 18:22:38.312962 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3ae8-7c92-b8f3-b41bd4b9b31d"}
2024/11/25 18:22:38.352840 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3ae8-7c92-b8f3-b41bd4b9b31d", "statement_id": "019362d8-3aea-7bee-921c-81fb080cec75", "txn_id": "cbf29ce484222325180b2effd45c8cd2"}
2024/11/25 18:22:38.353358 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3ae8-7c92-b8f3-b41bd4b9b31d", "statement_id": "019362d8-3aea-7bee-921c-81fb080cec75", "txn_id": "cbf29ce484222325180b2effd45c8cd2"}
2024/11/25 18:22:38.353839 +0800 ERROR cn-service no such table mo_catalog.mo_table_stats_alpha {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3ae8-7c92-b8f3-b41bd4b9b31d", "statement_id": "019362d8-3aea-7bee-921c-81fb080cec75", "txn_id": "cbf29ce484222325180b2effd45c8cd2"}
2024/11/25 18:22:38.354350 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "no such table mo_catalog.mo_table_stats_alpha", "txn_info": "cbf29ce484222325180b2effd45c8cd2:1732530158351145000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3ae8-7c92-b8f3-b41bd4b9b31d", "statement_id": "019362d8-3aea-7bee-921c-81fb080cec75"}
2024/11/25 18:22:38.354620 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "bulk update table stats", "error": "no such table mo_catalog.mo_table_stats_alpha", "sql": "\n\t\t\t\tinsert into \n\t\t\t\t    mo_catalog.mo_table_stats_alpha (account_id, database_id, table_id, database_name, table_name, table_stats, update_time, takes)\n\t\t\t\t\tvalues (0,16384,16385,'db1','test1','{\"dblock_cnt\":0,\"dobject_cnt\":0,\"table_rows\":9,\"table_size\":1971,\"tblock_cnt\":0,\"tobject_cnt\":0}','2024-11-25 10:22:38.250653',257) \n\t\t\t\ton duplicate key update\n\t\t\t\t\ttable_stats = values(table_stats), update_time = values(update_time), takes = values(takes);"}
2024/11/25 18:22:38.354915 +0800 ERROR disttae/mo_table_stats.go:1277 MO-TABLE-STATS-TASK {"source": "alpha task received err", "error": "no such table mo_catalog.mo_table_stats_alpha"}
2024/11/25 18:22:38.355135 +0800 INFO disttae/mo_table_stats.go:1248 MO-TABLE-STATS-TASK {"source": "alpha task", "processed": 1, "takes": "104.422791ms", "wait err": "0s", "caller": "forceUpdateQuery"}
2024/11/25 18:22:38.355637 +0800 INFO cn-service internalExecutor new session {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3b13-7816-ac75-9df9ff2751a2"}
2024/11/25 18:22:38.404652 +0800 ERROR cn-service Failed to get temp database {"uuid": "", "error": "internal error: temporary engine not init yet", "session_info": "", "role": "moadmin", "session_id": "019362d8-3b13-7816-ac75-9df9ff2751a2", "statement_id": "019362d8-3b14-793b-9e65-6d5b603b5dc2", "txn_id": "cbf29ce484222325180b2effd45c8cd3"}
2024/11/25 18:22:38.404947 +0800 ERROR cn-service Failed to get table {"uuid": "", "tableName": "mo_table_stats_alpha", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "session_info": "", "role": "moadmin", "session_id": "019362d8-3b13-7816-ac75-9df9ff2751a2", "statement_id": "019362d8-3b14-793b-9e65-6d5b603b5dc2", "txn_id": "cbf29ce484222325180b2effd45c8cd3"}
2024/11/25 18:22:38.405277 +0800 ERROR cn-service SQL parser error: table "mo_table_stats_alpha" does not exist {"uuid": "", "session_info": "", "role": "moadmin", "session_id": "019362d8-3b13-7816-ac75-9df9ff2751a2", "statement_id": "019362d8-3b14-793b-9e65-6d5b603b5dc2", "txn_id": "cbf29ce484222325180b2effd45c8cd3"}
2024/11/25 18:22:38.405581 +0800 ERROR cn-service query trace status {"uuid": "", "statement": "", "status": "fail", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "txn_info": "cbf29ce484222325180b2effd45c8cd3:1732530158403099000-1", "session_info": "", "role": "moadmin", "session_id": "019362d8-3b13-7816-ac75-9df9ff2751a2", "statement_id": "019362d8-3b14-793b-9e65-6d5b603b5dc2"}
2024/11/25 18:22:38.405836 +0800 INFO disttae/mo_table_stats.go:567 MO-TABLE-STATS-TASK {"source": "normal query", "error": "SQL parser error: table \"mo_table_stats_alpha\" does not exist", "sql": "\n\t\t\t\tselect \n    \t\t\t\ttable_id, update_time, COALESCE(table_stats, CAST('{}' AS JSON)) from  mo_catalog.mo_table_stats_alpha\n              \twhere \n                \taccount_id in (0) and \n                \tdatabase_id in (16384) and \n                  \ttable_id in (16385) \n\t\t\t  \torder by table_id asc;"}
2024/11/25 18:22:38.406201 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:38.406195 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:38.406241 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:38.406255 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:38.406315 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:38.406402 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:38.406395 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:38.406501 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:38.406577 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:38.416497 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:38.421706 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:38.428056 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:38.428386 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:38.438716 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:38.441115 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:38.459911 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "959ns"}
2024/11/25 18:22:38.460124 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "436.041µs", "checkpointed": "0-0"}
2024/11/25 18:22:38.460301 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "12.5µs"}
2024/11/25 18:22:38.460455 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:38.460599 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:38.460686 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:38.460804 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "570.917µs"}
2024/11/25 18:22:38.461021 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:38.461330 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:38.461372 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "22.456208ms", "err": null}
2024/11/25 18:22:38.461391 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:38.461581 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "286.583µs"}
2024/11/25 18:22:38.461681 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "351.875µs"}
2024/11/25 18:22:38.461803 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:38.461818 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:38.461874 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "80.75µs"}
2024/11/25 18:22:38.461980 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042"}
2024/11/25 18:22:38.462009 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "206.083µs"}
2024/11/25 18:22:38.462593 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:38.462823 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:38.462940 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:38.462957 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:38.463118 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:38.463086 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "139.791µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:38.463202 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "248.833µs"}
2024/11/25 18:22:38.463897 +0800 INFO logtail/mgr.go:169 init waterline to 1732530158463778000-0
2024/11/25 18:22:38.464067 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "to": "PhysicalTime:1732530158463778000 "}
2024/11/25 18:22:38.465005 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:38.465150 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc033450640"}
2024/11/25 18:22:38.465255 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0334506e0"}
2024/11/25 18:22:38.465336 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc033450780"}
2024/11/25 18:22:38.571260 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:38.571575 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:38.572951 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": ""}
2024/11/25 18:22:38.573340 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:38.574378 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158571709000-0", "minTs": "0-0"}
2024/11/25 18:22:38.574696 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530158573588000 "}
2024/11/25 18:22:38.575744 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.576068 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:38.576595 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:38.577298 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158575625000-0", "minTs": "0-0"}
2024/11/25 18:22:38.577569 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530158575625000 "}
2024/11/25 18:22:38.578138 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.578310 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:38.578608 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:38.579203 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530158577678000-0", "minTs": "0-0"}
2024/11/25 18:22:38.579414 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530158577678000 "}
2024/11/25 18:22:38.580013 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.580169 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:38.588816 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:38.593923 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:38.598369 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2efff1d80cf2/Active/S:1732530158577678000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc033451e00"}
2024/11/25 18:22:38.603316 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:38.603429 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530158577678000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:38.603610 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:39.003189 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:39.329366 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:22:39.934317 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "table": "db_id:1000 tb_id:1000 "}
2024/11/25 18:22:40.035354 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "table": "db_id:1000 tb_id:1000 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530160033524000 "}
2024/11/25 18:22:40.038274 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "chunk-number": 236, "chunk-limit": 16351, "message-size": 3842815}
2024/11/25 18:22:40.049530 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1000, "service": "", "addr": "0xc038cab360"}
2024/11/25 18:22:40.985766 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:22:40.999724 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 1000, tbl: 1000] resp received, 0xc03d3346b0
2024/11/25 18:22:41.042597 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:22:41.638092 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:22:42.000397 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:41.991768 +0000 UTC, targetTS: 2024-11-25 10:22:41.000248 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:22:42.005666 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
dataObjects:{iobj-0, iblk-0, irow-0; dobj-0, dblk-0, drow-0};
InmemRows:{visible-80000, invisible-0};
checkpoint:{0};
visible objects:   []
invisible objects: []
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:42.093967 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-105]1000-test1", "extra-info": {"a-objs": "f8d45968517d_0,c1e346ea9502_0,438d083e2ef7_0,61d15c61171f_0,a6a2d04b4806_0,dc9f42b28c7d_0,714b9945fc44_0,f9e2a8005b02_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D849AD7C11BBDCE8C0D5F2FDA8][1732530162093709000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 8}
2024/11/25 18:22:42.144025 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-105]1000-test1", "sort-key": "mock_2"}
2024/11/25 18:22:42.496941 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-105]1000-test1", "aobj-deletes": 0, "aobj-merge-rows": 80000, "tombstone-rows": 0, "duration": "402.725666ms", "extra-info": {"a-objs": "f8d45968517d_0,c1e346ea9502_0,438d083e2ef7_0,61d15c61171f_0,a6a2d04b4806_0,dc9f42b28c7d_0,714b9945fc44_0,f9e2a8005b02_0,", "a-tombstones": "", "to-objs": "161c2339b093_0,"}}
2024/11/25 18:22:42.709430 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:22:43.269355 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:22:43.280826 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:43.462286 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[1/(84,0)84/84]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[164/(284,20)304/304]
2024/11/25 18:22:43.503017 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:42.45771 +0000 UTC, targetTS: 2024-11-25 10:22:42.502835 +0000 UTC, done: false, subscriberReady: true

2024/11/25 18:22:44.432331 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:44.503088 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:44.473802 +0000 UTC, targetTS: 2024-11-25 10:22:42.502835 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-8, irow-80000; dobj-8, dblk-8, drow-80000};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-4a75-766c-ac94-161c2339b093_00000)|Ext(1_1067981_1192_5248)|Rows(80000)|Blks(8)|Size(1069237)|OSize(1070592)]; appendable: false; sorted: true; createTS: 1732530162498210000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d8-3ca2-7af8-b02c-f8d45968517d_00000)|Ext(1_184244_419_1831)|Rows(10000)|Blks(1)|Size(184727)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158756171000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3cb2-7e3c-8328-c1e346ea9502_00000)|Ext(1_184258_409_1831)|Rows(10000)|Blks(1)|Size(184731)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158771754000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3ccf-7aec-b8f5-438d083e2ef7_00000)|Ext(1_184259_411_1831)|Rows(10000)|Blks(1)|Size(184734)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158801208000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3ce0-7991-a182-61d15c61171f_00000)|Ext(1_184261_414_1831)|Rows(10000)|Blks(1)|Size(184739)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158817489000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3cf9-740f-a27b-a6a2d04b4806_00000)|Ext(1_184256_413_1831)|Rows(10000)|Blks(1)|Size(184733)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158842737000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3d0a-70a0-a431-dc9f42b28c7d_00000)|Ext(1_184264_416_1831)|Rows(10000)|Blks(1)|Size(184744)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158858849000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3d27-7b33-a6f9-714b9945fc44_00000)|Ext(1_184262_415_1831)|Rows(10000)|Blks(1)|Size(184741)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158889203000-0; deleteTS: 1732530162498210000-0 [OBJ(100)-(019362d8-3d38-7c38-90ca-f9e2a8005b02_00000)|Ext(1_184265_414_1831)|Rows(10000)|Blks(1)|Size(184743)|OSize(495357)]; appendable: true; sorted: false; createTS: 1732530158905658000-0; deleteTS: 1732530162498210000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:44.509772 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:44.515017 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:44.521676 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:44.522051 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:44.531004 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:44.532490 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:44.561052 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "667ns"}
2024/11/25 18:22:44.561410 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "522.083µs", "checkpointed": "0-0"}
2024/11/25 18:22:44.562187 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "17.75µs"}
2024/11/25 18:22:44.563897 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:44.564023 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:44.564548 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:44.565382 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "3.28825ms"}
2024/11/25 18:22:44.565809 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:44.566090 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:44.566220 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "35.052458ms", "err": null}
2024/11/25 18:22:44.566264 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:44.566342 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "291.625µs"}
2024/11/25 18:22:44.566431 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "331.167µs"}
2024/11/25 18:22:44.566534 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:44.566543 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:44.566620 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "90.417µs"}
2024/11/25 18:22:44.566687 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "153.209µs"}
2024/11/25 18:22:44.566977 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995"}
2024/11/25 18:22:44.567525 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:44.567658 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:44.567769 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:44.567784 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:44.567882 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "118µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:44.567971 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "203.166µs"}
2024/11/25 18:22:44.568620 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:44.568792 +0800 INFO logtail/mgr.go:169 init waterline to 1732530164568683000-0
2024/11/25 18:22:44.568974 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "to": "PhysicalTime:1732530164568683000 "}
2024/11/25 18:22:44.571061 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:44.571235 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc04b1ebd60"}
2024/11/25 18:22:44.571346 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc04b1ebe00"}
2024/11/25 18:22:44.571426 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc04b1ebea0"}
2024/11/25 18:22:44.584458 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:44.679659 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:44.680120 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:44.682007 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": ""}
2024/11/25 18:22:44.682239 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:44.682919 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530164680711000-0", "minTs": "0-0"}
2024/11/25 18:22:44.683098 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530164680711000 "}
2024/11/25 18:22:44.683587 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:44.683719 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:44.684586 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:44.684951 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530164682674000-0", "minTs": "0-0"}
2024/11/25 18:22:44.685090 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530164684675000 "}
2024/11/25 18:22:44.685578 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:44.685923 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:44.686763 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:44.687203 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530164686729000-0", "minTs": "0-0"}
2024/11/25 18:22:44.687375 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530164686729000 "}
2024/11/25 18:22:44.687799 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:44.687963 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:44.695523 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:44.704189 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:44.708688 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f015dc286b3/Active/S:1732530164686729000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc04acb72c0"}
2024/11/25 18:22:44.714724 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:44.714930 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530164686729000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:44.715144 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:44.736495 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F015DC286B2][1732530164686729000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:44.733649 UTC}"}
2024/11/25 18:22:44.737349 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F015DC286B2][1732530164686729000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:44.744161 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:44.749573 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "13.421875ms", "cn-txn": "cbf29ce484222325180b2f015dc286b2/Active/S:1732530164686729000-1", "tn-txn": "ctx[CBF29CE484222325180B2F015DC286B2][1732530164686729000-1->1732530164740163000-0][Committed]: <nil>"}
2024/11/25 18:22:44.750257 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-114]16385-test1", "extra-info": {"a-objs": "88919b0d7a23_0,f09a53f9ba91_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D8540E70DE9F37A2AE28DD201E][1732530164748928000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:44.750956 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-114]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:22:44.772259 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-114]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 40, "tombstone-rows": 0, "duration": "21.826417ms", "extra-info": {"a-objs": "88919b0d7a23_0,f09a53f9ba91_0,", "a-tombstones": "", "to-objs": "d42e037ac580_0,"}}
2024/11/25 18:22:44.776775 +0800 INFO checkpoint/runner.go:1022 Flush-CollectMemUsage {"pressure": 0.0000020954757928848267, "size": "2.197KiB"}
2024/11/25 18:22:44.776982 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 3, "name": "mo_columns"}
2024/11/25 18:22:44.777195 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 2, "name": "mo_tables"}
2024/11/25 18:22:44.777369 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 1, "name": "mo_database"}
2024/11/25 18:22:44.777490 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-117]3-mo_columns", "extra-info": {"a-objs": "555d2f7777ae_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D85429742AB392843EFC197A13][1732530164776833000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:44.777696 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-119]1-mo_database", "extra-info": {"a-objs": "819d63c37ca0_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D854297839AABCBFCBB0D32169][1732530164776833000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:44.777828 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-118]2-mo_tables", "extra-info": {"a-objs": "807c93ebc182_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D854297A60B93750A6AE0BE231][1732530164776833000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:44.778240 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-119]1-mo_database", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:44.778594 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-117]3-mo_columns", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:44.778599 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-118]2-mo_tables", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:44.820028 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-118]2-mo_tables", "aobj-deletes": 0, "aobj-merge-rows": 1, "tombstone-rows": 0, "duration": "42.024834ms", "extra-info": {"a-objs": "807c93ebc182_0,", "a-tombstones": "", "to-objs": "68312abe42c9_0,"}}
2024/11/25 18:22:44.823075 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-119]1-mo_database", "aobj-deletes": 0, "aobj-merge-rows": 1, "tombstone-rows": 0, "duration": "45.218417ms", "extra-info": {"a-objs": "819d63c37ca0_0,", "a-tombstones": "", "to-objs": "4d9871b2a14c_0,"}}
2024/11/25 18:22:44.832012 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-117]3-mo_columns", "aobj-deletes": 0, "aobj-merge-rows": 4, "tombstone-rows": 0, "duration": "54.368416ms", "extra-info": {"a-objs": "555d2f7777ae_0,", "a-tombstones": "", "to-objs": "ff1d360fe6aa_0,"}}
2024/11/25 18:22:45.177101 +0800 INFO db/db.go:104 [Force Checkpoint] flush takes 400.774292ms: <nil>
2024/11/25 18:22:45.177642 +0800 INFO checkpoint/testutils.go:242 Checkpoint-Start-Force {"entry": "CKP[I][1][ckp 0, truncate 0](0-0->1732530164774905000-1)"}
2024/11/25 18:22:45.179518 +0800 INFO logtail/storage_usage.go:1132 storage usage [I] {"cache mem used": 0.00054163486328125, "applied deletes": "", "storage usage summary when ckp": "\nCKP[I]\t2024-11-25 10:22:45.179436 +0000 UTC\naccumulated size in this ckp:            0.001431mb, "}
2024/11/25 18:22:45.220759 +0800 INFO store/checkpoint.go:53 TRACE-WAL-TRUNCATE-RangeCheckpoint {"group": 11, "lsn": 2}
2024/11/25 18:22:45.223673 +0800 INFO store/checkpoint.go:101 TRACE-WAL-TRUNCATE-CKP-Entry {"group": 11, "lsn": 2}
2024/11/25 18:22:45.223898 +0800 INFO checkpoint/testutils.go:263 Checkpoint-End-Force {"ObjectInfoIDX-Size": 2816, "ObjectInfoIDX-Row": 8, "totalSize": 2816, "totalRow": 8, "cost": "46.286208ms", "entry": "CKP[I][2][ckp 2, truncate 2](0-0->1732530164774905000-1)"}
2024/11/25 18:22:45.224236 +0800 INFO store/checkpoint.go:124 TRACE-WAL-TRUNCATE-Internal-Entry {"duration": "42.208µs"}
2024/11/25 18:22:45.225247 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-123]-16385-test1", "txn-info": "ctx[019362D855E87BFEB268D4768E04238B][1732530165222900000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530165222900000-0", "from-objs": "d42e037ac580_0(2, 3.064KiB)Rows(40),", "from-size": "3.064KiB", "est-size": "800B", "num-obj": 1, "num-blk": 2, "rows": 40}
2024/11/25 18:22:45.229695 +0800 INFO store/checkpoint.go:148 TRACE-WAL-TRUNCATE {"wait truncating entry takes": "2.95725ms", "get driver lsn takes": "60.5µs", "driver lsn": 2}
2024/11/25 18:22:45.230019 +0800 INFO store/checkpoint.go:172 TRACE-WAL-TRUNCATE-GC-Store {"duration": "19.542µs"}
2024/11/25 18:22:45.238956 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-123]-16385-test1", "to-objs": "d0b4cf2bb837_0(2, 3.064KiB)Rows(40),", "to-size": "3.064KiB", "duration": "13.826542ms"}
2024/11/25 18:22:45.244168 +0800 INFO txnentries/mergeobjects.go:445 [MERGE-PREPARE-COMMIT] {"table-id": 16385, "task": "[MT-123]-16385-test1", "total-transfer": 0, "in-queue-transfer": 0, "total-cost": "23.417µs", "this-tran-cost": "15.542µs", "commit-ts": "1732530165243992000-0"}
2024/11/25 18:22:45.816870 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:45.913339 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:46.018303 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:46.248436 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:46.251499 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530166250743000 "}
2024/11/25 18:22:46.252545 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc0529b3a40"}
2024/11/25 18:22:46.253440 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03e780930
2024/11/25 18:22:46.333914 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:22:46.666362 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:22:47.193508 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:47.254851 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:47.228898 +0000 UTC, targetTS: 2024-11-25 10:22:46.254484 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-2, irow-40; dobj-1, dblk-2, drow-40};
InmemRows:{visible-0, invisible-0};
checkpoint:{1};
visible objects:   [[OBJ(010)-(019362d8-55e8-7ebd-9c90-d0b4cf2bb837_00000)|Ext(1_938_498_1894)|Rows(40)|Blks(2)|Size(1500)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530165243992000-0; deleteTS: 0-0]
invisible objects: [[OBJ(010)-(019362d8-540f-76c6-addd-d42e037ac580_00000)|Ext(1_938_498_1894)|Rows(40)|Blks(2)|Size(1500)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530164772786000-0; deleteTS: 1732530165243992000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:47.401614 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:22:47.828043 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:22:47.924183 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:22:48.289785 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:48.26888 +0000 UTC, targetTS: 2024-11-25 10:22:47.289546 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-2, irow-40; dobj-3, dblk-4, drow-80};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-55e8-7ebd-9c90-d0b4cf2bb837_00000)|Ext(1_938_498_1894)|Rows(40)|Blks(2)|Size(1500)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530165243992000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d8-5403-7c9a-8d0d-88919b0d7a23_00000)|Ext(1_756_397_1831)|Rows(20)|Blks(1)|Size(1217)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530164740163000-0; deleteTS: 1732530164772786000-0 [OBJ(100)-(019362d8-5403-7e5f-a96c-f09a53f9ba91_00000)|Ext(1_758_404_1831)|Rows(20)|Blks(1)|Size(1226)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530164740163000-0; deleteTS: 1732530164772786000-0 [OBJ(010)-(019362d8-540f-76c6-addd-d42e037ac580_00000)|Ext(1_938_498_1894)|Rows(40)|Blks(2)|Size(1500)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530164772786000-0; deleteTS: 1732530165243992000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:48.291160 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:48.291155 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:48.291316 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:48.291368 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:48.291344 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:48.291552 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:48.291499 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:48.291702 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:22:48.291814 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:22:48.301656 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:48.312836 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:48.319249 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:48.319546 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:48.349831 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:48.352309 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:48.367893 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "875ns"}
2024/11/25 18:22:48.368154 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "459.292µs", "checkpointed": "0-0"}
2024/11/25 18:22:48.368350 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "17.5µs"}
2024/11/25 18:22:48.368570 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:48.368694 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:48.368790 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:48.368932 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "655.625µs"}
2024/11/25 18:22:48.369227 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:48.369458 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:48.369543 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "19.438125ms", "err": null}
2024/11/25 18:22:48.369648 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "229.75µs"}
2024/11/25 18:22:48.369748 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "290.208µs"}
2024/11/25 18:22:48.369847 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:48.369802 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:48.369926 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "83.958µs"}
2024/11/25 18:22:48.370006 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "158.25µs"}
2024/11/25 18:22:48.370064 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:48.370129 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35"}
2024/11/25 18:22:48.370638 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:48.371090 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:48.371226 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:48.371360 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:48.371367 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:48.371495 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "140.333µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:48.371619 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "252.041µs"}
2024/11/25 18:22:48.371894 +0800 INFO logtail/mgr.go:169 init waterline to 1732530168371777000-0
2024/11/25 18:22:48.372080 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "to": "PhysicalTime:1732530168371777000 "}
2024/11/25 18:22:48.373043 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:48.373264 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0530235e0"}
2024/11/25 18:22:48.373375 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc053023680"}
2024/11/25 18:22:48.373473 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc053023720"}
2024/11/25 18:22:48.403578 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:22:48.480725 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:48.481064 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:48.482013 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": ""}
2024/11/25 18:22:48.482270 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:48.482983 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530168481650000-0", "minTs": "0-0"}
2024/11/25 18:22:48.483213 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530168481650000 "}
2024/11/25 18:22:48.483899 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:48.484190 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:48.485028 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:48.485609 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530168483698000-0", "minTs": "0-0"}
2024/11/25 18:22:48.485842 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530168483698000 "}
2024/11/25 18:22:48.486393 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:48.486574 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:48.487416 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:48.488125 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530168487595000-0", "minTs": "0-0"}
2024/11/25 18:22:48.488370 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530168487595000 "}
2024/11/25 18:22:48.488907 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:48.489124 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:48.496919 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:48.503261 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:48.509533 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f024060afb3/Active/S:1732530168487595000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc04b2bb7c0"}
2024/11/25 18:22:48.515127 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:48.515268 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530168487595000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:48.515492 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:48.535829 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F024060AFB2][1732530168487595000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:48.534222 UTC}"}
2024/11/25 18:22:48.536432 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F024060AFB2][1732530168487595000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:48.545608 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "9.963292ms", "cn-txn": "cbf29ce484222325180b2f024060afb2/Active/S:1732530168487595000-1", "tn-txn": "ctx[CBF29CE484222325180B2F024060AFB2][1732530168487595000-1->1732530168538523000-0][Committed]: <nil>"}
2024/11/25 18:22:49.003513 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:49.329755 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:22:49.546086 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:49.549326 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530169547620000 "}
2024/11/25 18:22:49.550279 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc054bbabe0"}
2024/11/25 18:22:49.551822 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03e780bb0
2024/11/25 18:22:50.552192 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:50.517807 +0000 UTC, targetTS: 2024-11-25 10:22:49.552009 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-0, iblk-0, irow-0; dobj-0, dblk-0, drow-0};
InmemRows:{visible-40, invisible-0};
checkpoint:{0};
visible objects:   []
invisible objects: []
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:50.553840 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-124]16385-test1", "extra-info": {"a-objs": "3eb110f936fa_0,cc14922da795_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D86AB9768BBD77C6001B1FF95E][1732530170551766000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:50.555053 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-124]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:22:50.590727 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-124]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 40, "tombstone-rows": 0, "duration": "36.506291ms", "extra-info": {"a-objs": "3eb110f936fa_0,cc14922da795_0,", "a-tombstones": "", "to-objs": "6e0a8db6f710_0,"}}
2024/11/25 18:22:50.985897 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:22:51.042905 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:22:51.596270 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:51.581838 +0000 UTC, targetTS: 2024-11-25 10:22:50.596067 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-2, irow-40; dobj-2, dblk-2, drow-40};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-6abb-7d3e-a48c-6e0a8db6f710_00000)|Ext(1_938_515_1894)|Rows(40)|Blks(2)|Size(1517)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530170591568000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d8-62da-7470-ace3-3eb110f936fa_00000)|Ext(1_756_407_1831)|Rows(20)|Blks(1)|Size(1227)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0 [OBJ(100)-(019362d8-62da-75bc-8dd2-cc14922da795_00000)|Ext(1_758_407_1831)|Rows(20)|Blks(1)|Size(1229)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:51.638618 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:22:52.006194 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:22:52.607862 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:52.593786 +0000 UTC, targetTS: 2024-11-25 10:22:51.607532 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-2, irow-40; dobj-2, dblk-2, drow-40};
InmemRows:{visible-0, invisible-3};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-6abb-7d3e-a48c-6e0a8db6f710_00000)|Ext(1_938_515_1894)|Rows(40)|Blks(2)|Size(1517)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530170591568000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d8-62da-7470-ace3-3eb110f936fa_00000)|Ext(1_756_407_1831)|Rows(20)|Blks(1)|Size(1227)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0 [OBJ(100)-(019362d8-62da-75bc-8dd2-cc14922da795_00000)|Ext(1_758_407_1831)|Rows(20)|Blks(1)|Size(1229)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:22:52.609457 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-127]16385-test1", "extra-info": {"a-objs": "", "a-tombstones": "75d63a7eb734_0,"}, "txn-info": "ctx[019362D872C1726D8A08D79C77220352][1732530172607788000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:52.610306 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-127]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:52.636087 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-127]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 3, "duration": "26.314125ms", "extra-info": {"a-objs": "", "a-tombstones": "75d63a7eb734_0,", "to-tombstones": "dc1e0a9cf417_0,"}}
2024/11/25 18:22:52.709775 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:22:53.269699 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:22:53.281061 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:53.371713 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(36,0)36/36]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(109,59)168/168]
2024/11/25 18:22:53.640591 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:53.625691 +0000 UTC, targetTS: 2024-11-25 10:22:52.640365 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-2, irow-40; dobj-2, dblk-2, drow-40};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d8-6abb-7d3e-a48c-6e0a8db6f710_00000)|Ext(1_938_515_1894)|Rows(40)|Blks(2)|Size(1517)|OSize(3138)]; appendable: false; sorted: true; createTS: 1732530170591568000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d8-62da-7470-ace3-3eb110f936fa_00000)|Ext(1_756_407_1831)|Rows(20)|Blks(1)|Size(1227)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0 [OBJ(100)-(019362d8-62da-75bc-8dd2-cc14922da795_00000)|Ext(1_758_407_1831)|Rows(20)|Blks(1)|Size(1229)|OSize(3465)]; appendable: true; sorted: false; createTS: 1732530168538523000-0; deleteTS: 1732530170591568000-0]
visible tombstone: {1 1 3}
invisible tombstone objects: {1 1 3}

2024/11/25 18:22:53.642253 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:53.642386 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:53.642422 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:53.642588 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:53.642739 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:53.642714 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:53.642524 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:53.652604 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:53.657833 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:53.664448 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:53.664791 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:53.681261 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:53.683826 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:53.695731 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "792ns"}
2024/11/25 18:22:53.695904 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "322.667µs", "checkpointed": "0-0"}
2024/11/25 18:22:53.696050 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "14.625µs"}
2024/11/25 18:22:53.696210 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:53.696365 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:53.696440 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:53.696542 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "558.25µs"}
2024/11/25 18:22:53.696772 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:53.697009 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:53.697059 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "15.490209ms", "err": null}
2024/11/25 18:22:53.697078 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:53.697159 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "192.583µs"}
2024/11/25 18:22:53.697257 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "245.583µs"}
2024/11/25 18:22:53.697361 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:53.697384 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:53.697442 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "85.791µs"}
2024/11/25 18:22:53.697514 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf"}
2024/11/25 18:22:53.697522 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "152.25µs"}
2024/11/25 18:22:53.697704 +0800 INFO logtail/mgr.go:169 init waterline to 1732530173697542000-0
2024/11/25 18:22:53.697873 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "to": "PhysicalTime:1732530173697542000 "}
2024/11/25 18:22:53.698031 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:53.698369 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:53.698511 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:53.698866 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:53.698863 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:53.699135 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "298.167µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:53.699284 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "427.291µs"}
2024/11/25 18:22:53.700588 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:53.700831 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc055705ae0"}
2024/11/25 18:22:53.700967 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc055705b80"}
2024/11/25 18:22:53.701078 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc055705c20"}
2024/11/25 18:22:53.808772 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:53.809176 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:53.810377 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": ""}
2024/11/25 18:22:53.810736 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:53.811762 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530173809628000-0", "minTs": "0-0"}
2024/11/25 18:22:53.812053 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530173809628000 "}
2024/11/25 18:22:53.812987 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:53.813309 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:53.814255 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:53.815147 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530173813519000-0", "minTs": "0-0"}
2024/11/25 18:22:53.815482 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530173813519000 "}
2024/11/25 18:22:53.816233 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:53.816479 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:53.817399 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:53.818227 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530173817522000-0", "minTs": "0-0"}
2024/11/25 18:22:53.818512 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530173817522000 "}
2024/11/25 18:22:53.819201 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:53.819460 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:53.828644 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:53.835716 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:53.840704 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f037de892eb/Active/S:1732530173817522000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc057224820"}
2024/11/25 18:22:53.845875 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:53.846016 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530173817522000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:53.846213 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:53.865074 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F037DE892EA][1732530173817522000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:53.862661 UTC}"}
2024/11/25 18:22:53.866203 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F037DE892EA][1732530173817522000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:53.877378 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "12.471375ms", "cn-txn": "cbf29ce484222325180b2f037de892ea/Active/S:1732530173817522000-1", "tn-txn": "ctx[CBF29CE484222325180B2F037DE892EA][1732530173817522000-1->1732530173869001000-0][Committed]: <nil>"}
2024/11/25 18:22:53.877953 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-129]16385-test1", "extra-info": {"a-objs": "a5f9d08198e3_0,3d9b8c1b49b8_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D877B57BB49DF5E8F15C7B7BCB][1732530173877497000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:22:53.878626 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-129]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:22:53.904381 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-129]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 40, "tombstone-rows": 0, "duration": "26.22325ms", "extra-info": {"a-objs": "a5f9d08198e3_0,3d9b8c1b49b8_0,", "a-tombstones": "", "to-objs": "567d18b9a2b3_0,"}}
2024/11/25 18:22:53.908651 +0800 INFO checkpoint/runner.go:1022 Flush-CollectMemUsage {"pressure": 0.0000020954757928848267, "size": "2.197KiB"}
2024/11/25 18:22:53.908895 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 3, "name": "mo_columns"}
2024/11/25 18:22:53.909119 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 2, "name": "mo_tables"}
2024/11/25 18:22:53.909273 +0800 INFO checkpoint/runner.go:1038 Flush-Force {"id": 1, "name": "mo_database"}
2024/11/25 18:22:53.909391 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-132]3-mo_columns", "extra-info": {"a-objs": "f72f38528fd8_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D877D572908F432DD6DB6FCB55][1732530173907512000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:53.909441 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-133]2-mo_tables", "extra-info": {"a-objs": "05b7434b2e00_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D877D574A38CBCCF3189F07E21][1732530173907512000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:53.909640 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-134]1-mo_database", "extra-info": {"a-objs": "f31b8294d098_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D877D576E98F0E52BAB6B63D4B][1732530173907512000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:53.910289 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-134]1-mo_database", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:53.910334 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-133]2-mo_tables", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:53.910557 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-132]3-mo_columns", "sort-key": "__mo_cpkey_col"}
2024/11/25 18:22:53.950860 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-133]2-mo_tables", "aobj-deletes": 0, "aobj-merge-rows": 1, "tombstone-rows": 0, "duration": "41.21225ms", "extra-info": {"a-objs": "05b7434b2e00_0,", "a-tombstones": "", "to-objs": "2e9facd089c8_0,"}}
2024/11/25 18:22:53.953176 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-132]3-mo_columns", "aobj-deletes": 0, "aobj-merge-rows": 4, "tombstone-rows": 0, "duration": "43.599417ms", "extra-info": {"a-objs": "f72f38528fd8_0,", "a-tombstones": "", "to-objs": "3ccbc7cea96c_0,"}}
2024/11/25 18:22:53.955993 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-134]1-mo_database", "aobj-deletes": 0, "aobj-merge-rows": 1, "tombstone-rows": 0, "duration": "46.111958ms", "extra-info": {"a-objs": "f31b8294d098_0,", "a-tombstones": "", "to-objs": "3f78549982db_0,"}}
2024/11/25 18:22:54.308940 +0800 INFO db/db.go:104 [Force Checkpoint] flush takes 400.726917ms: <nil>
2024/11/25 18:22:54.309391 +0800 INFO checkpoint/testutils.go:242 Checkpoint-Start-Force {"entry": "CKP[I][1][ckp 0, truncate 0](0-0->1732530173907512000-1)"}
2024/11/25 18:22:54.312295 +0800 INFO logtail/storage_usage.go:1132 storage usage [I] {"cache mem used": 0.00054163486328125, "applied deletes": "", "storage usage summary when ckp": "\nCKP[I]\t2024-11-25 10:22:54.312175 +0000 UTC\naccumulated size in this ckp:            0.001434mb, "}
2024/11/25 18:22:54.355835 +0800 INFO store/checkpoint.go:53 TRACE-WAL-TRUNCATE-RangeCheckpoint {"group": 11, "lsn": 2}
2024/11/25 18:22:54.359131 +0800 INFO store/checkpoint.go:101 TRACE-WAL-TRUNCATE-CKP-Entry {"group": 11, "lsn": 2}
2024/11/25 18:22:54.359172 +0800 INFO checkpoint/testutils.go:263 Checkpoint-End-Force {"ObjectInfoIDX-Size": 2816, "ObjectInfoIDX-Row": 8, "totalSize": 2816, "totalRow": 8, "cost": "49.824916ms", "entry": "CKP[I][2][ckp 2, truncate 2](0-0->1732530173907512000-1)"}
2024/11/25 18:22:54.359642 +0800 INFO store/checkpoint.go:124 TRACE-WAL-TRUNCATE-Internal-Entry {"duration": "28.541µs"}
2024/11/25 18:22:54.363122 +0800 INFO store/checkpoint.go:148 TRACE-WAL-TRUNCATE {"wait truncating entry takes": "2.819542ms", "get driver lsn takes": "19.791µs", "driver lsn": 2}
2024/11/25 18:22:54.363311 +0800 INFO store/checkpoint.go:172 TRACE-WAL-TRUNCATE-GC-Store {"duration": "14.167µs"}
2024/11/25 18:22:54.367070 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-138]16385-test1", "extra-info": {"a-objs": "", "a-tombstones": "e3e8b517ddfe_0,"}, "txn-info": "ctx[019362D8799E7A218D067570DC40E007][1732530174365723000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:54.367943 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-138]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:22:54.384947 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-138]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 1, "duration": "17.483167ms", "extra-info": {"a-objs": "", "a-tombstones": "e3e8b517ddfe_0,", "to-tombstones": "b8cecb543269_0,"}}
2024/11/25 18:22:54.432891 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:54.474407 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "sendRound": 118}
2024/11/25 18:22:54.584805 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:54.744401 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:22:55.391980 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:55.394041 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530175393459000 "}
2024/11/25 18:22:55.394721 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc058386640"}
2024/11/25 18:22:55.395268 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03e780e30
2024/11/25 18:22:55.818155 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:55.914010 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:56.018819 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:56.334447 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:22:56.396008 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:56.349704 +0000 UTC, targetTS: 2024-11-25 10:22:55.395838 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:22:56.666953 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:22:57.193882 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:22:57.402120 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:22:57.408402 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:57.391723 +0000 UTC, targetTS: 2024-11-25 10:22:56.408213 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:22:57.409199 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:57.409310 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:22:57.409351 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:22:57.409466 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:22:57.409479 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:22:57.409534 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:22:57.409556 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:22:57.419685 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:22:57.424858 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:22:57.431133 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:22:57.431383 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:22:57.450886 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:22:57.452787 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:22:57.466388 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "750ns"}
2024/11/25 18:22:57.466719 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "604.125µs", "checkpointed": "0-0"}
2024/11/25 18:22:57.466943 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "19.042µs"}
2024/11/25 18:22:57.467183 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:22:57.467394 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:22:57.467544 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:22:57.467676 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "815.959µs"}
2024/11/25 18:22:57.468021 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:22:57.468327 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:22:57.468374 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "17.207541ms", "err": null}
2024/11/25 18:22:57.468582 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "284.208µs"}
2024/11/25 18:22:57.468718 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "391.375µs"}
2024/11/25 18:22:57.468800 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:22:57.468878 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "85.417µs"}
2024/11/25 18:22:57.468864 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:22:57.468947 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "146.917µs"}
2024/11/25 18:22:57.469145 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:22:57.469420 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3"}
2024/11/25 18:22:57.469744 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:22:57.469864 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:22:57.469973 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:57.469992 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:22:57.470015 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:22:57.470133 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "124.083µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:22:57.470184 +0800 INFO logtail/mgr.go:169 init waterline to 1732530177470067000-0
2024/11/25 18:22:57.470222 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "208.75µs"}
2024/11/25 18:22:57.470403 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "to": "PhysicalTime:1732530177470067000 "}
2024/11/25 18:22:57.472028 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:22:57.472177 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05844a8c0"}
2024/11/25 18:22:57.472285 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05844a960"}
2024/11/25 18:22:57.472375 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05844aa00"}
2024/11/25 18:22:57.580077 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:22:57.580431 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:22:57.581232 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": ""}
2024/11/25 18:22:57.581501 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:22:57.582298 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530177580043000-0", "minTs": "0-0"}
2024/11/25 18:22:57.582545 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530177580043000 "}
2024/11/25 18:22:57.583159 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:57.583319 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:22:57.584223 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:22:57.584743 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530177584157000-0", "minTs": "0-0"}
2024/11/25 18:22:57.584932 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530177584157000 "}
2024/11/25 18:22:57.585342 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:57.585523 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:22:57.586259 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:22:57.586816 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530177586151000-0", "minTs": "0-0"}
2024/11/25 18:22:57.587260 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530177586151000 "}
2024/11/25 18:22:57.587861 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:57.588046 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:22:57.596052 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:22:57.601012 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:22:57.605674 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f045ebd88f3/Active/S:1732530177586151000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc058587720"}
2024/11/25 18:22:57.611250 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:22:57.611424 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530177586151000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:22:57.611599 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:22:57.635699 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F045EBD88F2][1732530177586151000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:22:57.633115 UTC}"}
2024/11/25 18:22:57.636683 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F045EBD88F2][1732530177586151000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:22:57.647232 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "11.666459ms", "cn-txn": "cbf29ce484222325180b2f045ebd88f2/Active/S:1732530177586151000-1", "tn-txn": "ctx[CBF29CE484222325180B2F045EBD88F2][1732530177586151000-1->1732530177639394000-0][Committed]: <nil>"}
2024/11/25 18:22:57.647856 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-140]16385-test1", "extra-info": {"a-objs": "c9e04b73b135_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D8866F7A218E5014054657D7DF][1732530177646259000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:22:57.648347 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-140]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:22:57.668749 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-140]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 20, "tombstone-rows": 0, "duration": "20.712958ms", "extra-info": {"a-objs": "c9e04b73b135_0,", "a-tombstones": "", "to-objs": "3ca5f7952d46_0,"}}
2024/11/25 18:22:57.828786 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:22:57.924503 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:22:58.269572 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:22:58.404238 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:22:58.677497 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:22:58.680327 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530178678089000 "}
2024/11/25 18:22:58.681100 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc058546280"}
2024/11/25 18:22:58.682138 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:22:59.004180 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:22:59.330270 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:22:59.682449 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:22:59.672274 +0000 UTC, targetTS: 2024-11-25 10:22:58.682354 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:22:59.783382 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:22:59.783441 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:22:59.784258 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:00.784171 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:00.762267 +0000 UTC, targetTS: 2024-11-25 10:22:59.783785 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:00.784731 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05a776780"}
2024/11/25 18:23:00.986476 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:23:01.043605 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:23:01.639132 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:23:01.785437 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:01.786252 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530181786072000 "}
2024/11/25 18:23:01.786727 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:02.006817 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:23:02.469690 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(18,0)18/18]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:02.710269 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:23:02.787686 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:02.780006 +0000 UTC, targetTS: 2024-11-25 10:23:01.787469 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:02.788077 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:02.788134 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:02.788510 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:03.270265 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:23:03.281785 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:03.626260 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "sendRound": 105}
2024/11/25 18:23:03.788290 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:03.760217 +0000 UTC, targetTS: 2024-11-25 10:23:02.788178 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:03.788601 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05ab70780"}
2024/11/25 18:23:04.433578 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:04.475108 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "sendRound": 118}
2024/11/25 18:23:04.585466 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:04.744828 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:04.789068 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:04.791254 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530184790066000 "}
2024/11/25 18:23:04.793333 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:05.794259 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:05.788204 +0000 UTC, targetTS: 2024-11-25 10:23:04.794057 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:05.794716 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:05.794746 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:05.795206 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:05.818778 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:05.914411 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:06.019362 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:06.335122 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:23:06.667862 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:23:06.794944 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:06.776072 +0000 UTC, targetTS: 2024-11-25 10:23:05.794815 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:06.795199 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05afb8d20"}
2024/11/25 18:23:07.194442 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:07.392466 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:07.402745 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:23:07.470390 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(22,0)22/22]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:07.795719 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:07.797694 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530187796020000 "}
2024/11/25 18:23:07.798817 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:07.829363 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:23:07.925165 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:23:08.270332 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:08.404846 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:23:08.800051 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:08.749047 +0000 UTC, targetTS: 2024-11-25 10:23:07.79976 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:08.800669 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:08.800773 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:08.801127 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:09.004668 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:23:09.330827 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:23:09.801078 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:09.782031 +0000 UTC, targetTS: 2024-11-25 10:23:08.800812 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:09.801187 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05b2fa1e0"}
2024/11/25 18:23:10.801525 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:10.802648 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530190802013000 "}
2024/11/25 18:23:10.803259 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:10.987035 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:23:11.044315 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:23:11.639857 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:23:11.803969 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:11.752243 +0000 UTC, targetTS: 2024-11-25 10:23:10.803633 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:11.804601 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:11.804708 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:11.805183 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:12.007728 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:23:12.470840 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(30,0)30/30]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:12.710711 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:23:12.804945 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:12.790213 +0000 UTC, targetTS: 2024-11-25 10:23:11.804754 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:12.805391 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05b74d360"}
2024/11/25 18:23:13.270440 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:23:13.282428 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:13.626495 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "sendRound": 105}
2024/11/25 18:23:13.806172 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:13.808752 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530193808129000 "}
2024/11/25 18:23:13.810252 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:14.434004 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:14.475926 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "sendRound": 118}
2024/11/25 18:23:14.586219 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:14.745048 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:14.811601 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:14.762241 +0000 UTC, targetTS: 2024-11-25 10:23:13.811136 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:14.813498 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:14.813719 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:14.817558 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:15.817758 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:15.80019 +0000 UTC, targetTS: 2024-11-25 10:23:14.817471 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:15.818138 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05bae7e00"}
2024/11/25 18:23:15.819176 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:15.914680 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:16.019842 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:16.336051 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:23:16.668551 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:23:16.818774 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:16.821920 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530196820010000 "}
2024/11/25 18:23:16.823310 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:17.195031 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:17.393128 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:17.403224 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:23:17.470689 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(38,0)38/38]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:17.824092 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:17.772244 +0000 UTC, targetTS: 2024-11-25 10:23:16.823758 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:17.824696 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:17.824722 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:17.825138 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:17.829815 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:23:17.925776 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:23:18.270719 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:18.405548 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:23:18.825104 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:18.810157 +0000 UTC, targetTS: 2024-11-25 10:23:17.824857 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:18.825564 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05bd7f5e0"}
2024/11/25 18:23:19.005244 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:23:19.331250 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:23:19.826349 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:19.829043 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530199828020000 "}
2024/11/25 18:23:19.830668 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:20.831652 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:20.784178 +0000 UTC, targetTS: 2024-11-25 10:23:19.831371 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:20.832233 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:20.832318 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:20.832960 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:20.987435 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:23:21.044735 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:23:21.640513 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:23:21.832497 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:21.824167 +0000 UTC, targetTS: 2024-11-25 10:23:20.832359 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:21.832903 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05c3955e0"}
2024/11/25 18:23:22.008409 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:23:22.470823 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(42,0)42/42]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:22.711346 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:23:22.833549 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:22.836319 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530202833974000 "}
2024/11/25 18:23:22.837828 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:23.270962 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:23:23.283610 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:23.626842 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "sendRound": 105}
2024/11/25 18:23:23.838699 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:23.79817 +0000 UTC, targetTS: 2024-11-25 10:23:22.838492 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:23.839377 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:23.839449 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:23.839929 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:24.434368 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:24.476216 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "sendRound": 118}
2024/11/25 18:23:24.586723 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:24.745599 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:24.839807 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:24.792206 +0000 UTC, targetTS: 2024-11-25 10:23:23.839519 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:24.840213 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05c6aa780"}
2024/11/25 18:23:25.819479 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:25.840817 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:25.843535 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530205841948000 "}
2024/11/25 18:23:25.844982 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:25.915096 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:26.020245 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:26.336584 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:23:26.669039 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:23:26.846160 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:26.812141 +0000 UTC, targetTS: 2024-11-25 10:23:25.845801 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:26.846777 +0800 INFO disttae/logtail_consumer.go:921 [logtail-consumer] send unsubscribe table 16384-16385 request succeed
2024/11/25 18:23:26.846864 +0800 INFO cn-service.logtail-server send unsubscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": {"db_id":16384,"tb_id":16385}}
2024/11/25 18:23:26.847337 +0800 INFO disttae/logtail_consumer.go:1283 [logtail-consumer] unsubscribe tbl[db: 16384, tbl: 16385] succeed
2024/11/25 18:23:27.195542 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:27.393683 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:27.403657 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:23:27.470924 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(50,0)50/50]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(108,59)167/167]
2024/11/25 18:23:27.830060 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:23:27.847122 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:27.798134 +0000 UTC, targetTS: 2024-11-25 10:23:26.846905 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:27.847536 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05c9b3680"}
2024/11/25 18:23:27.926296 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:23:28.271104 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:28.406087 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:23:28.848408 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:28.853431 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d8-85bd-73ff-bd51-2bfa0318aee3", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530208852254000 "}
2024/11/25 18:23:28.855139 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa430
2024/11/25 18:23:29.005823 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:23:29.331920 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:23:29.855720 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:29.822121 +0000 UTC, targetTS: 2024-11-25 10:23:28.855388 +0000 UTC, done: true, subscriberReady: true

2024/11/25 18:23:29.857103 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:29.857427 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:29.858165 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:29.858638 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:29.859137 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:29.859282 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:29.859610 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:29.859730 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:29.859813 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:29.867505 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:29.872625 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:29.880084 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:29.880412 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:29.894351 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:29.896131 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:29.906150 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "708ns"}
2024/11/25 18:23:29.906272 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "181.459µs", "checkpointed": "0-0"}
2024/11/25 18:23:29.906464 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "10.5µs"}
2024/11/25 18:23:29.906621 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:29.906738 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:29.906822 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:29.906929 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "548µs"}
2024/11/25 18:23:29.907178 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:29.907359 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:29.907406 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "12.873166ms", "err": null}
2024/11/25 18:23:29.907405 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:29.907468 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "127.542µs"}
2024/11/25 18:23:29.907554 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "193.958µs"}
2024/11/25 18:23:29.907634 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:29.907680 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:29.907701 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "72.083µs"}
2024/11/25 18:23:29.907933 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "298.958µs"}
2024/11/25 18:23:29.907994 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42"}
2024/11/25 18:23:29.908258 +0800 INFO logtail/mgr.go:169 init waterline to 1732530209908052000-0
2024/11/25 18:23:29.908546 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "to": "PhysicalTime:1732530209908052000 "}
2024/11/25 18:23:29.908542 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:29.908926 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:29.909038 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:29.909121 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:29.909122 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:29.909242 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "128.042µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:29.909309 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "187.875µs"}
2024/11/25 18:23:29.910688 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:29.910840 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05caedcc0"}
2024/11/25 18:23:29.910933 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05caedd60"}
2024/11/25 18:23:29.911016 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05caede00"}
2024/11/25 18:23:30.016566 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:30.016848 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:30.018446 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": ""}
2024/11/25 18:23:30.019780 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:30.020585 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530210020035000-0", "minTs": "0-0"}
2024/11/25 18:23:30.020912 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530210020035000 "}
2024/11/25 18:23:30.021632 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:30.022296 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:30.022675 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:30.023405 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530210022001000-0", "minTs": "0-0"}
2024/11/25 18:23:30.023558 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530210022001000 "}
2024/11/25 18:23:30.024145 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:30.024281 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:30.024603 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:30.025064 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530210023928000-0", "minTs": "0-0"}
2024/11/25 18:23:30.025193 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530210023928000 "}
2024/11/25 18:23:30.027076 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:30.027671 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:30.038865 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:30.042632 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:30.045763 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0bec3ac563/Active/S:1732530210023928000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc052b51400"}
2024/11/25 18:23:30.049531 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:30.049598 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530210023928000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:30.049704 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:30.072034 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0BEC3AC562][1732530210023928000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:30.070549 UTC}"}
2024/11/25 18:23:30.072694 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0BEC3AC562][1732530210023928000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:23:30.080776 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.855792ms", "cn-txn": "cbf29ce484222325180b2f0bec3ac562/Active/S:1732530210023928000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0BEC3AC562][1732530210023928000-1->1732530210074409000-0][Committed]: <nil>"}
2024/11/25 18:23:30.134061 +0800 INFO plan/build_util.go:61 Row lock upgraded to table lock for SQL : insert into `db1`.`test1` values(1,1,1),(2,2,2),(3,3,3),(4,4,4);
2024/11/25 18:23:30.134196 +0800 INFO plan/build_util.go:62 the outcnt stats is 4.000000
2024/11/25 18:23:30.136934 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "insert into `db1`.`test1` values(1,1,1),(2,2,2),(3,3,3),(4,4,4);", "txn-id": "cbf29ce484222325180b2f0bec3ac564", "duration": "4.325291ms", "BatchSize": 0, "retry-times": 0, "AffectedRows": 4}
2024/11/25 18:23:30.987927 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:23:31.045013 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:23:31.170795 +0800 INFO plan/build_util.go:61 Row lock upgraded to table lock for SQL : delete from `db1`.`test1` where `mock_2`=1;
2024/11/25 18:23:31.171060 +0800 INFO plan/build_util.go:62 the outcnt stats is 50.000000
2024/11/25 18:23:31.172310 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:31.174477 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" primary_seqnum:2 ", "To": "PhysicalTime:1732530211174005000 "}
2024/11/25 18:23:31.175166 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05ecb6c80"}
2024/11/25 18:23:31.175806 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc01f90b0b0
2024/11/25 18:23:31.176228 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:23:31.179291 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "delete from `db1`.`test1` where `mock_2`=1;", "txn-id": "cbf29ce484222325180b2f0bec3ac565", "duration": "10.081625ms", "BatchSize": 0, "retry-times": 0, "AffectedRows": 1}
2024/11/25 18:23:31.186689 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-142]16385-test1", "extra-info": {"a-objs": "", "a-tombstones": "c76e8a0b7b0a_0,"}, "txn-info": "ctx[019362D9097274B394689051D15196B4][1732530211186123000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:23:31.187168 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-142]16385-test1", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:23:31.201081 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-142]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 0, "tombstone-rows": 1, "duration": "14.192042ms", "extra-info": {"a-objs": "", "a-tombstones": "c76e8a0b7b0a_0,", "to-tombstones": "cab6a11bdc4b_0,"}}
2024/11/25 18:23:31.640965 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:23:32.008953 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:23:32.245887 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select * from `db1`.`test1` order by `mock_2` desc;", "txn-id": "cbf29ce484222325180b2f0bec3ac566", "duration": "6.540667ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
[col0] = [3]: 4,3,2
[col1] = [3]: 4,3,2
[col2] = [3]: 4,3,2

2024/11/25 18:23:32.293332 +0800 INFO plan/build_util.go:61 Row lock upgraded to table lock for SQL : insert into `db1`.`test1` values(1,1,1);
2024/11/25 18:23:32.293584 +0800 INFO plan/build_util.go:62 the outcnt stats is 1.000000
2024/11/25 18:23:32.298163 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "insert into `db1`.`test1` values(1,1,1);", "txn-id": "cbf29ce484222325180b2f0bec3ac567", "duration": "6.432583ms", "BatchSize": 0, "retry-times": 0, "AffectedRows": 1}
2024/11/25 18:23:32.364961 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select * from `db1`.`test1` order by `mock_2` desc;", "txn-id": "cbf29ce484222325180b2f0bec3ac568", "duration": "5.629208ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
[col0] = [4]: 4,3,2,1
[col1] = [4]: 4,3,2,1
[col2] = [4]: 4,3,2,1

2024/11/25 18:23:32.366033 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:32.366102 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:32.366170 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:32.366208 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:32.366235 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:32.366133 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:32.366287 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:32.376290 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:32.381545 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:32.387515 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:32.387748 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:32.391593 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:32.393630 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:32.429587 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "500ns"}
2024/11/25 18:23:32.430012 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "815.125µs", "checkpointed": "0-0"}
2024/11/25 18:23:32.431502 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "7.208µs"}
2024/11/25 18:23:32.431760 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:32.431838 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:32.431889 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:32.431956 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "1.847416ms"}
2024/11/25 18:23:32.432692 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:32.432901 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "41.084583ms", "err": null}
2024/11/25 18:23:32.434256 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2"}
2024/11/25 18:23:32.434590 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:32.436956 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:32.437053 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05ecb79a0"}
2024/11/25 18:23:32.437105 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05ecb7a40"}
2024/11/25 18:23:32.437289 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05ecb7ae0"}
2024/11/25 18:23:32.438838 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:32.438959 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "472.166µs"}
2024/11/25 18:23:32.438994 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "156.75µs"}
2024/11/25 18:23:32.439054 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:32.439248 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:32.439995 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "749.292µs"}
2024/11/25 18:23:32.440037 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "789.417µs"}
2024/11/25 18:23:32.440192 +0800 INFO logtail/mgr.go:169 init waterline to 1732530212440046000-0
2024/11/25 18:23:32.440291 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "to": "PhysicalTime:1732530212440046000 "}
2024/11/25 18:23:32.440290 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:32.443128 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:32.443489 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:32.443552 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:32.443610 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:32.443703 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "89.875µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:32.443757 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "147.75µs"}
2024/11/25 18:23:32.448442 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:32.448492 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:32.451058 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "stream-id": 1, "remote": ""}
2024/11/25 18:23:32.451175 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:32.451789 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530212443840000-0", "minTs": "0-0"}
2024/11/25 18:23:32.451886 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530212443840000 "}
2024/11/25 18:23:32.453039 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:32.453102 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:32.453278 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:32.453482 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530212443840000-0", "minTs": "0-0"}
2024/11/25 18:23:32.453542 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530212443840000 "}
2024/11/25 18:23:32.454675 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:32.454743 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:32.455325 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:32.455613 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530212443840000-0", "minTs": "0-0"}
2024/11/25 18:23:32.456077 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530212455228000 "}
2024/11/25 18:23:32.457541 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:32.457607 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:32.469672 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:32.475144 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:32.477145 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0c82cb866b/Active/S:1732530212455228000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc060c60460"}
2024/11/25 18:23:32.481757 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:32.481808 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530212455228000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:32.481883 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:32.508110 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0C82CB866A][1732530212455228000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:32.505411 UTC}"}
2024/11/25 18:23:32.508811 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0C82CB866A][1732530212455228000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:32.521295 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "13.569375ms", "cn-txn": "cbf29ce484222325180b2f0c82cb866a/Active/S:1732530212455228000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0C82CB866A][1732530212455228000-1->1732530212511248000-0][Committed]: <nil>"}
2024/11/25 18:23:32.711993 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c9d7-748f-a34d-0475147db796", "stream-id": 1, "remote": "", "sendRound": 233}
2024/11/25 18:23:32.834633 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 0, "rows": 8192}
2024/11/25 18:23:32.836901 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 1, "rows": 8192}
2024/11/25 18:23:32.839079 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 2, "rows": 8192}
2024/11/25 18:23:32.841339 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 3, "rows": 8192}
2024/11/25 18:23:33.019255 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 1, "rows": 8192}
2024/11/25 18:23:33.022433 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 2, "rows": 8192}
2024/11/25 18:23:33.032868 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 3, "rows": 8192}
2024/11/25 18:23:33.040837 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 4, "rows": 8192}
2024/11/25 18:23:33.217966 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 2, "rows": 8192}
2024/11/25 18:23:33.220312 +0800 INFO disttae/txn.go:149 INJECT-LOG-WORKSPACE {"table": "test_reader_table", "db": "test_reader_database", "txn": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "typ": "insert", "offset": 3, "rows": 8192}
2024/11/25 18:23:33.271509 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a95e-7e73-a0d3-a33b184ab35c", "stream-id": 1, "remote": "", "sendRound": 45}
2024/11/25 18:23:33.283980 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2294-7bdb-b962-58d929c00bc9", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:33.333159 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["17d2a2b87db9_0"]}
2024/11/25 18:23:33.333244 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "527.5KiB", "obj-size": "397.1KiB", "blk-cnt": 4, "row-cnt": 32768, "names": ["d60162b916f2_0"]}
2024/11/25 18:23:33.333315 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0c82cb866c/Active/S:1732530212831966000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "264.3KiB", "obj-size": "198.8KiB", "blk-cnt": 2, "row-cnt": 16384, "names": ["7617da54a7ba_0"]}
2024/11/25 18:23:33.398400 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:33.399077 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-0e51-7e92-8548-240fd793d1f2", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530213397969000 "}
2024/11/25 18:23:33.399321 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc02c1df900"}
2024/11/25 18:23:33.399638 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "test_reader_table", "table-id": 16385, "ps": "0xc02c1df9a0", "data": "[__mo_rowid] = [3]: 00000000-0000-0000-0000-000000000000-0-0-0,00000000-0000-0000-0000-000000000000-0-0-0,00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [3]: 1732530213356334000-0,1732530213356334000-0,1732530213356334000-0\n[object_stats] = [3]: binary[154],binary[154],binary[154]\n[db_id] = [3]: 16384,16384,16384\n[table_id] = [3]: 16385,16385,16385\n[create_at] = [3]: 1732530213356334000-0,1732530213356334000-0,1732530213356334000-0\n[delete_at] = [3]: 0-0,0-0,0-0\n[start_ts] = [3]: 1732530212831966000-1,1732530212831966000-1,1732530212831966000-1\n[prepare_ts] = [3]: 1732530213356334000-0,1732530213356334000-0,1732530213356334000-0\n[commit_ts] = [3]: 1732530213356334000-0,1732530213356334000-0,1732530213356334000-0\n"}
2024/11/25 18:23:33.399797 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc023d8d830
2024/11/25 18:23:33.400445 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:33.421204 +0800 INFO engine_util/reader.go:425 LOGREADER-INJECTED-1 {"name": "test_reader_table", "data-len": 1}
2024/11/25 18:23:33.431741 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:33.436908 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:33.442581 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:33.442688 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:33.442984 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:33.442979 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:33.442985 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:33.443048 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:33.443063 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:33.443118 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:33.443231 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:33.445830 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:33.446668 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:33.456318 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "375ns"}
2024/11/25 18:23:33.456393 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "108.083µs", "checkpointed": "0-0"}
2024/11/25 18:23:33.456458 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "3.75µs"}
2024/11/25 18:23:33.456528 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:33.456575 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:33.456608 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:33.456670 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "235.292µs"}
2024/11/25 18:23:33.456792 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:33.456937 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:33.456986 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "11.0525ms", "err": null}
2024/11/25 18:23:33.456993 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:33.457020 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "101.167µs"}
2024/11/25 18:23:33.457073 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "134.625µs"}
2024/11/25 18:23:33.457112 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:33.457155 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "46.667µs"}
2024/11/25 18:23:33.457194 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "81.875µs"}
2024/11/25 18:23:33.457208 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:33.457451 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7"}
2024/11/25 18:23:33.457829 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:33.457923 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:33.457982 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:33.457980 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:33.458046 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "67.459µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:33.458092 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "113.25µs"}
2024/11/25 18:23:33.458353 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:33.458474 +0800 INFO logtail/mgr.go:169 init waterline to 1732530213458399000-0
2024/11/25 18:23:33.458561 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "to": "PhysicalTime:1732530213458399000 "}
2024/11/25 18:23:33.459450 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 10000, "WorkspaceThreshold": 2097152, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:33.459521 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc03ccf4960"}
2024/11/25 18:23:33.459570 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc03ccf4a00"}
2024/11/25 18:23:33.459639 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc03ccf4aa0"}
2024/11/25 18:23:33.563373 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:33.563505 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:33.564374 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "stream-id": 1, "remote": ""}
2024/11/25 18:23:33.564516 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:33.564923 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530213564379000-0", "minTs": "0-0"}
2024/11/25 18:23:33.565055 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530213564379000 "}
2024/11/25 18:23:33.565414 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:33.565530 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:33.566138 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:33.566459 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530213564379000-0", "minTs": "0-0"}
2024/11/25 18:23:33.566599 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530213566221000 "}
2024/11/25 18:23:33.566892 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:33.566998 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:33.567151 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:33.567525 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530213566221000-0", "minTs": "0-0"}
2024/11/25 18:23:33.567655 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530213566221000 "}
2024/11/25 18:23:33.567924 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:33.568037 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:33.573597 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:33.576615 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:33.579211 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0cbfd0dceb/Active/S:1732530213566221000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc036c485a0"}
2024/11/25 18:23:33.582240 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:33.582310 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530213566221000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:33.582401 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:33.616349 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0CBFD0DCEA][1732530213566221000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:33.614785 UTC}"}
2024/11/25 18:23:33.616898 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0CBFD0DCEA][1732530213566221000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:33.625679 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "9.447667ms", "cn-txn": "cbf29ce484222325180b2f0cbfd0dcea/Active/S:1732530213566221000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0CBFD0DCEA][1732530213566221000-1->1732530213618416000-0][Committed]: <nil>"}
2024/11/25 18:23:33.626779 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc03d306000", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530213618416000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 1\n[table_id] = [1]: 2\n[create_at] = [1]: 1732530213618416000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530213566221000-1\n[prepare_ts] = [1]: 1732530213618416000-0\n[commit_ts] = [1]: 1732530213618416000-0\n"}
2024/11/25 18:23:33.627296 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-6231-7ef4-aee9-906b98623d35", "stream-id": 1, "remote": "", "sendRound": 105}
2024/11/25 18:23:33.627281 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc03d306000", "data": "[__mo_rowid] = [1]: 019362d9-12f2-72de-9901-0efe4fc38f06-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530213618416000-0\n[rel_id] = [1]: 16385\n[relname] = [1]: test_reader_table\n[reldatabase] = [1]: test_reader_database\n[reldatabase_id] = [1]: 16384\n[relpersistence] = [1]: \n[relkind] = [1]: \n[rel_comment] = [1]: \n[rel_createsql] = [1]: \n[created_time] = [1]: 2024-11-25 18:23:33.615006\n[creator] = [1]: 0\n[owner] = [1]: 0\n[account_id] = [1]: 0\n[partitioned] = [1]: 0\n[partition_info] = [1]: \n[viewdef] = [1]: \n[constraint] = [1]: binary[27]\n[rel_version] = [1]: 0\n[catalog_version] = [1]: 1\n[extra_info] = [1]: binary[8]\n[__mo_cpkey_col] = [1]: binary[45]\n"}
2024/11/25 18:23:33.678275 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:33.680308 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530213678238000 "}
2024/11/25 18:23:33.680931 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc036c48dc0"}
2024/11/25 18:23:33.681793 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc02a346430
2024/11/25 18:23:33.682346 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:33.791982 +0800 ERROR engine_util/reader.go:414 LOGREADER-ERROR {"name": "test_reader_table", "error": "internal error: mpool out of space, alloc 557056 bytes, cap 1048576"}
2024/11/25 18:23:33.892852 +0800 INFO cn-service.logtail-server send response by segment {"uuid": "", "server-id": "019362d9-1251-7324-9019-b07dbc25b0f7", "chunk-number": 70, "chunk-limit": 16351, "message-size": 1139224}
2024/11/25 18:23:33.901431 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:33.906472 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:33.911999 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:33.912096 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:33.912325 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:33.912370 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:33.912361 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:33.912389 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:33.912373 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:33.912398 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:33.912439 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:33.912526 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:33.912563 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:33.913396 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:33.914020 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:33.921641 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "333ns"}
2024/11/25 18:23:33.921705 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "246.541µs", "checkpointed": "0-0"}
2024/11/25 18:23:33.921768 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "4.958µs"}
2024/11/25 18:23:33.921837 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:33.921873 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:33.921899 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:33.921939 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "195.417µs"}
2024/11/25 18:23:33.922043 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:33.922143 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:33.922173 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "8.730541ms", "err": null}
2024/11/25 18:23:33.922216 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "81.584µs"}
2024/11/25 18:23:33.922223 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:33.922260 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "117.334µs"}
2024/11/25 18:23:33.922309 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:33.922350 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "44.041µs"}
2024/11/25 18:23:33.922343 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:33.922381 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "71.708µs"}
2024/11/25 18:23:33.922570 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f"}
2024/11/25 18:23:33.922808 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:33.922875 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:33.922926 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:33.922928 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:33.922981 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "55.041µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:33.923022 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "94.709µs"}
2024/11/25 18:23:33.923389 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:33.923504 +0800 INFO logtail/mgr.go:169 init waterline to 1732530213923430000-0
2024/11/25 18:23:33.923569 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "to": "PhysicalTime:1732530213923430000 "}
2024/11/25 18:23:33.924347 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 10000, "WorkspaceThreshold": 2097152, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:33.924429 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc011190140"}
2024/11/25 18:23:33.924477 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0111901e0"}
2024/11/25 18:23:33.924523 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc011190280"}
2024/11/25 18:23:34.027336 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:34.027454 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:34.028138 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "stream-id": 1, "remote": ""}
2024/11/25 18:23:34.028262 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:34.028595 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214027393000-0", "minTs": "0-0"}
2024/11/25 18:23:34.028700 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530214027393000 "}
2024/11/25 18:23:34.028954 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.029044 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:34.029890 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:34.030130 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214029448000-0", "minTs": "0-0"}
2024/11/25 18:23:34.030209 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530214029448000 "}
2024/11/25 18:23:34.030400 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.030476 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:34.030952 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:34.031149 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214029448000-0", "minTs": "0-0"}
2024/11/25 18:23:34.031225 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530214029448000 "}
2024/11/25 18:23:34.031421 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.031487 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:34.036179 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:34.038490 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:34.040491 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0cdb88cf6b/Active/S:1732530214029448000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc011190c80"}
2024/11/25 18:23:34.042959 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:34.043018 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530214029448000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.043085 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.081066 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0CDB88CF6A][1732530214029448000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:34.079920 UTC}"}
2024/11/25 18:23:34.081428 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0CDB88CF6A][1732530214029448000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:34.089114 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.123917ms", "cn-txn": "cbf29ce484222325180b2f0cdb88cf6a/Active/S:1732530214029448000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0CDB88CF6A][1732530214029448000-1->1732530214082557000-0][Committed]: <nil>"}
2024/11/25 18:23:34.089957 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc01574eaa0", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214082557000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 1\n[table_id] = [1]: 2\n[create_at] = [1]: 1732530214082557000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530214029448000-1\n[prepare_ts] = [1]: 1732530214082557000-0\n[commit_ts] = [1]: 1732530214082557000-0\n"}
2024/11/25 18:23:34.090316 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc01574eaa0", "data": "[__mo_rowid] = [1]: 019362d9-14c2-7655-a930-8b3c0e8c87d4-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214082557000-0\n[rel_id] = [1]: 16385\n[relname] = [1]: test_reader_table\n[reldatabase] = [1]: test_reader_database\n[reldatabase_id] = [1]: 16384\n[relpersistence] = [1]: \n[relkind] = [1]: \n[rel_comment] = [1]: \n[rel_createsql] = [1]: \n[created_time] = [1]: 2024-11-25 18:23:34.080087\n[creator] = [1]: 0\n[owner] = [1]: 0\n[account_id] = [1]: 0\n[partitioned] = [1]: 0\n[partition_info] = [1]: \n[viewdef] = [1]: \n[constraint] = [1]: binary[27]\n[rel_version] = [1]: 0\n[catalog_version] = [1]: 1\n[extra_info] = [1]: binary[8]\n[__mo_cpkey_col] = [1]: binary[45]\n"}
2024/11/25 18:23:34.097067 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-144]16385-test_reader_table", "extra-info": {"a-objs": "9d98ff242c13_0,", "a-tombstones": "555e1ac6d5f8_0,"}, "txn-info": "ctx[019362D914D07E82A798B44EDF095F4E][1732530214095598000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:23:34.097474 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-144]16385-test_reader_table", "sort-key": "mock_12"}
2024/11/25 18:23:34.106968 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-144]16385-test_reader_table", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:23:34.124825 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-144]16385-test_reader_table", "aobj-deletes": 8, "aobj-merge-rows": 2, "tombstone-rows": 8, "duration": "27.626125ms", "extra-info": {"a-objs": "9d98ff242c13_0,", "a-tombstones": "555e1ac6d5f8_0,", "to-objs": "c5bdf319ea93_0,", "to-tombstones": "dd34a006784c_0,"}}
2024/11/25 18:23:34.140172 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:34.141997 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1422-756a-b66a-e4c1309e6c3f", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530214141404000 "}
2024/11/25 18:23:34.142405 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc0111919a0"}
2024/11/25 18:23:34.143016 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa1b0
2024/11/25 18:23:34.143265 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:34.143639 +0800 INFO disttae/txn_table.go:450 cols in GetColumMetadataScanInfo: mock_12, result len: 1
2024/11/25 18:23:34.154063 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:34.159289 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:34.164906 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:34.165011 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:34.168884 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.168896 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:34.168918 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.168930 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:34.168997 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:34.168995 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:34.169171 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:34.170265 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:34.171229 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:34.227743 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "542ns"}
2024/11/25 18:23:34.227872 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "205.5µs", "checkpointed": "0-0"}
2024/11/25 18:23:34.228399 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "9.209µs"}
2024/11/25 18:23:34.228490 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:34.228540 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:34.228581 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:34.228645 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "461.459µs"}
2024/11/25 18:23:34.230182 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:34.230543 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:34.230660 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "134.292µs"}
2024/11/25 18:23:34.230724 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "182.667µs"}
2024/11/25 18:23:34.230775 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:34.230839 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "68.5µs"}
2024/11/25 18:23:34.230877 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "101.75µs"}
2024/11/25 18:23:34.232248 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "61.896416ms", "err": null}
2024/11/25 18:23:34.232256 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:34.232964 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:34.233040 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:34.233218 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:34.233197 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:34.233225 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:34.233276 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "60.917µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:34.233333 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "115.208µs"}
2024/11/25 18:23:34.233990 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c"}
2024/11/25 18:23:34.234283 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.235554 +0800 INFO logtail/mgr.go:169 init waterline to 1732530214235493000-0
2024/11/25 18:23:34.235659 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "to": "PhysicalTime:1732530214235493000 "}
2024/11/25 18:23:34.236158 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 10000, "WorkspaceThreshold": 2097152, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:34.236261 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc012f906e0"}
2024/11/25 18:23:34.236323 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc012f90780"}
2024/11/25 18:23:34.236381 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc012f90820"}
2024/11/25 18:23:34.340140 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:34.340244 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:34.341293 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "stream-id": 1, "remote": ""}
2024/11/25 18:23:34.341429 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:34.341862 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214341426000-0", "minTs": "0-0"}
2024/11/25 18:23:34.341996 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530214341426000 "}
2024/11/25 18:23:34.342368 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.342499 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:34.342877 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:34.343215 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214341426000-0", "minTs": "0-0"}
2024/11/25 18:23:34.343343 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530214341426000 "}
2024/11/25 18:23:34.343651 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.343754 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:34.343910 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:34.344230 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214343332000-0", "minTs": "0-0"}
2024/11/25 18:23:34.344352 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530214343332000 "}
2024/11/25 18:23:34.344618 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.344720 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:34.350270 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:34.353615 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:34.356503 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0cee108223/Active/S:1732530214343332000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc014fe3040"}
2024/11/25 18:23:34.359871 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:34.359931 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530214343332000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.360034 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.393462 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0CEE108222][1732530214343332000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:34.391829 UTC}"}
2024/11/25 18:23:34.394046 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0CEE108222][1732530214343332000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:34.401455 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.097833ms", "cn-txn": "cbf29ce484222325180b2f0cee108222/Active/S:1732530214343332000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0CEE108222][1732530214343332000-1->1732530214395482000-0][Committed]: <nil>"}
2024/11/25 18:23:34.402393 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_database", "table-id": 1, "ps": "0xc0357aeb40", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214395482000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 1\n[table_id] = [1]: 1\n[create_at] = [1]: 1732530214395482000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530214343332000-1\n[prepare_ts] = [1]: 1732530214395482000-0\n[commit_ts] = [1]: 1732530214395482000-0\n"}
2024/11/25 18:23:34.402775 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_database", "table-id": 1, "ps": "0xc0357aeb40", "data": "[__mo_rowid] = [1]: 019362d9-15fb-725d-996b-b0bfac4064dd-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214395482000-0\n[dat_id] = [1]: 16384\n[datname] = [1]: test_reader_database\n[dat_catalog_name] = [1]: def\n[dat_createsql] = [1]: \n[owner] = [1]: 0\n[creator] = [1]: 0\n[created_time] = [1]: 2024-11-25 18:23:34.391829\n[account_id] = [1]: 0\n[dat_type] = [1]: \n[__mo_cpkey_col] = [1]: binary[25]\n"}
2024/11/25 18:23:34.403562 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc0357aec80", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214395482000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 1\n[table_id] = [1]: 2\n[create_at] = [1]: 1732530214395482000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530214343332000-1\n[prepare_ts] = [1]: 1732530214395482000-0\n[commit_ts] = [1]: 1732530214395482000-0\n"}
2024/11/25 18:23:34.405916 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_tables", "table-id": 2, "ps": "0xc0357aec80", "data": "[__mo_rowid] = [1]: 019362d9-15fb-7441-ad6a-86b66a901ee7-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214395482000-0\n[rel_id] = [1]: 16385\n[relname] = [1]: test_reader_table\n[reldatabase] = [1]: test_reader_database\n[reldatabase_id] = [1]: 16384\n[relpersistence] = [1]: \n[relkind] = [1]: \n[rel_comment] = [1]: \n[rel_createsql] = [1]: \n[created_time] = [1]: 2024-11-25 18:23:34.392038\n[creator] = [1]: 0\n[owner] = [1]: 0\n[account_id] = [1]: 0\n[partitioned] = [1]: 0\n[partition_info] = [1]: \n[viewdef] = [1]: \n[constraint] = [1]: binary[27]\n[rel_version] = [1]: 0\n[catalog_version] = [1]: 1\n[extra_info] = [1]: binary[8]\n[__mo_cpkey_col] = [1]: binary[45]\n"}
2024/11/25 18:23:34.406426 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-OBJ-INS {"table-name": "mo_columns", "table-id": 3, "ps": "0xc0357aedc0", "data": "[__mo_rowid] = [1]: 00000000-0000-0000-0000-000000000000-0-0-0\n[__mo_%1_commit_time] = [1]: 1732530214395482000-0\n[object_stats] = [1]: binary[154]\n[db_id] = [1]: 1\n[table_id] = [1]: 3\n[create_at] = [1]: 1732530214395482000-0\n[delete_at] = [1]: 0-0\n[start_ts] = [1]: 1732530214343332000-1\n[prepare_ts] = [1]: 1732530214395482000-0\n[commit_ts] = [1]: 1732530214395482000-0\n"}
2024/11/25 18:23:34.407361 +0800 INFO logtailreplay/partition_state.go:86 INJECT-TRACE-PS-MEM-INS {"table-name": "mo_columns", "table-id": 3, "ps": "0xc0357aedc0", "data": "[__mo_rowid] = [5]: 019362d9-15fb-759d-a52b-05a535b333d2-0-0-0,019362d9-15fb-759d-a52b-05a535b333d2-0-0-1,019362d9-15fb-759d-a52b-05a535b333d2-0-0-2,019362d9-15fb-759d-a52b-05a535b333d2-0-0-3,019362d9-15fb-759d-a52b-05a535b333d2-0-0-4\n[__mo_%1_commit_time] = [5]: 1732530214395482000-0,1732530214395482000-0,1732530214395482000-0,1732530214395482000-0,1732530214395482000-0\n[att_uniq_name] = [5]: 16385-mock_9,16385-mock_10,16385-mock_11,16385-mock_12,16385-__mo_rowid\n[account_id] = [5]: 0,0,0,0,0\n[att_database_id] = [5]: 16384,16384,16384,16384,16384\n[att_database] = [5]: test_reader_database,test_reader_database,test_reader_database,test_reader_database,test_reader_database\n[att_relname_id] = [5]: 16385,16385,16385,16385,16385\n[att_relname] = [5]: test_reader_table,test_reader_table,test_reader_table,test_reader_table,test_reader_table\n[attname] = [5]: mock_9,mock_10,mock_11,mock_12,__mo_rowid\n[atttyp] = [5]: binary[20],binary[20],binary[20],binary[20],binary[20]\n[attnum] = [5]: 1,2,3,4,5\n[att_length] = [5]: 20,20,20,20,20\n[attnotnull] = [5]: 0,0,0,0,1\n[atthasdef] = [5]: 0,0,0,0,0\n[att_default] = [5]: ,,,,\n[attisdropped] = [5]: 0,0,0,0,0\n[att_constraint_type] = [5]: n,n,n,p,\n[att_is_unsigned] = [5]: 0,0,0,0,0\n[att_is_auto_increment] = [5]: 0,0,0,0,0\n[att_comment] = [5]: ,,,,\n[att_is_hidden] = [5]: 0,0,0,0,1\n[attr_has_update] = [5]: 0,0,0,0,0\n[attr_update] = [5]: ,,,,\n[attr_is_clusterby] = [5]: 0,0,0,0,0\n[attr_seqnum] = [5]: 0,1,2,3,4\n[attr_enum] = [5]: ,,,,\n[__mo_cpkey_col] = [5]: binary[54],binary[55],binary[55],binary[55],binary[58]\n"}
2024/11/25 18:23:34.408968 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-147]16385-test_reader_table", "extra-info": {"a-objs": "a8aa9e618176_0,", "a-tombstones": "22ad45d28449_0,"}, "txn-info": "ctx[019362D916087C2181163432F705FD4D][1732530214407527000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:23:34.409474 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-147]16385-test_reader_table", "sort-key": "mock_12"}
2024/11/25 18:23:34.428696 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-147]16385-test_reader_table", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:23:34.434902 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-277b-7ad1-94f3-46e25ce5079a", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:34.448515 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-147]16385-test_reader_table", "aobj-deletes": 8, "aobj-merge-rows": 2, "tombstone-rows": 8, "duration": "39.407084ms", "extra-info": {"a-objs": "a8aa9e618176_0,", "a-tombstones": "22ad45d28449_0,", "to-objs": "8dd010bec861_0,", "to-tombstones": "8dad82088554_0,"}}
2024/11/25 18:23:34.476705 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-3b7d-7c77-bf75-a1c61700a042", "stream-id": 1, "remote": "", "sendRound": 118}
2024/11/25 18:23:34.506464 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:34.510287 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1559-75a5-bd92-02f9e666c69c", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530214509415000 "}
2024/11/25 18:23:34.511065 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc014fe3e00"}
2024/11/25 18:23:34.512100 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0237aa930
2024/11/25 18:23:34.512440 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:34.571753 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:34.577064 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:34.583480 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:34.583755 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:34.587435 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b21d-715f-94c7-c62f86150d7b", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:34.588549 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.588625 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:34.588603 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:34.588710 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:34.588715 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.588750 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:34.588886 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:34.591587 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:34.593124 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:34.608033 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "708ns"}
2024/11/25 18:23:34.608153 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "1.062875ms", "checkpointed": "0-0"}
2024/11/25 18:23:34.608276 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.583µs"}
2024/11/25 18:23:34.608402 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:34.608472 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:34.608548 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:34.608634 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "398.083µs"}
2024/11/25 18:23:34.608807 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:34.608995 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:34.609114 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "17.379834ms", "err": null}
2024/11/25 18:23:34.609162 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:34.609288 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "314.375µs"}
2024/11/25 18:23:34.609359 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "363.25µs"}
2024/11/25 18:23:34.609384 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:34.609442 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:34.609514 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "79.25µs"}
2024/11/25 18:23:34.609568 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "125.25µs"}
2024/11/25 18:23:34.609861 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655"}
2024/11/25 18:23:34.610208 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.610387 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:34.610602 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:34.610717 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:34.610716 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:34.610851 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "139.167µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:34.610935 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "220.959µs"}
2024/11/25 18:23:34.611128 +0800 INFO logtail/mgr.go:169 init waterline to 1732530214611041000-0
2024/11/25 18:23:34.611264 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "to": "PhysicalTime:1732530214611041000 "}
2024/11/25 18:23:34.612077 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 10000, "WorkspaceThreshold": 2097152, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:34.612205 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc060c61ae0"}
2024/11/25 18:23:34.612293 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc060c61b80"}
2024/11/25 18:23:34.612361 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc060c61c20"}
2024/11/25 18:23:34.717634 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:34.717954 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:34.719652 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "stream-id": 1, "remote": ""}
2024/11/25 18:23:34.719862 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:34.720536 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214718943000-0", "minTs": "0-0"}
2024/11/25 18:23:34.720717 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530214718943000 "}
2024/11/25 18:23:34.721367 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.721521 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:34.722098 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:34.722547 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214721062000-0", "minTs": "0-0"}
2024/11/25 18:23:34.722698 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530214721062000 "}
2024/11/25 18:23:34.723073 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.723189 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:34.724269 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:34.724644 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530214722912000-0", "minTs": "0-0"}
2024/11/25 18:23:34.724801 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530214722912000 "}
2024/11/25 18:23:34.725153 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.725301 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:34.732313 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:34.736492 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:34.740075 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0d0478c683/Active/S:1732530214722912000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc019f5e820"}
2024/11/25 18:23:34.743740 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:34.743813 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530214722912000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:34.743942 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.746078 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-64df-7ca2-a6bb-5579f4e6dba2", "stream-id": 1, "remote": "", "sendRound": 26}
2024/11/25 18:23:34.776443 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0D0478C682][1732530214722912000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:34.771557 UTC}"}
2024/11/25 18:23:34.778473 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0D0478C682][1732530214722912000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:34.804073 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "27.725958ms", "cn-txn": "cbf29ce484222325180b2f0d0478c682/Active/S:1732530214722912000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0D0478C682][1732530214722912000-1->1732530214785752000-0][Committed]: <nil>"}
2024/11/25 18:23:34.812528 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-150]16385-test_reader_table", "extra-info": {"a-objs": "d2519874bfbd_0,", "a-tombstones": "2f7628e6b9e9_0,"}, "txn-info": "ctx[019362D9179C75AD9D70C544F5364399][1732530214811126000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:23:34.813084 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-150]16385-test_reader_table", "sort-key": "mock_12"}
2024/11/25 18:23:34.822289 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-150]16385-test_reader_table", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:23:34.835683 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-150]16385-test_reader_table", "aobj-deletes": 8, "aobj-merge-rows": 2, "tombstone-rows": 8, "duration": "22.985208ms", "extra-info": {"a-objs": "d2519874bfbd_0,", "a-tombstones": "2f7628e6b9e9_0,", "to-objs": "2f49834f7477_0,", "to-tombstones": "c15feb26aef8_0,"}}
2024/11/25 18:23:34.856022 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:34.858856 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-16d1-76a3-8ede-74ba196c4655", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530214857143000 "}
2024/11/25 18:23:34.859478 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc00f7995e0"}
2024/11/25 18:23:34.860197 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc00023fab0
2024/11/25 18:23:34.861017 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:34.872327 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:34.877413 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:34.883269 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:34.883434 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:34.886390 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.886414 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:34.886443 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:34.886421 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:34.886504 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:34.886522 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:34.886674 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:34.888627 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:34.889979 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:34.900986 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "583ns"}
2024/11/25 18:23:34.901072 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "352.625µs", "checkpointed": "0-0"}
2024/11/25 18:23:34.901201 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "7.542µs"}
2024/11/25 18:23:34.901326 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:34.901433 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:34.901509 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:34.901575 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "436.834µs"}
2024/11/25 18:23:34.901768 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:34.901960 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:34.902039 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "96.083µs"}
2024/11/25 18:23:34.902057 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "13.303875ms", "err": null}
2024/11/25 18:23:34.902071 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:34.902106 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "145.791µs"}
2024/11/25 18:23:34.902162 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:34.902209 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "51.083µs"}
2024/11/25 18:23:34.902264 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "102.959µs"}
2024/11/25 18:23:34.902279 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:34.902663 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee"}
2024/11/25 18:23:34.902900 +0800 INFO logtail/mgr.go:169 init waterline to 1732530214902791000-0
2024/11/25 18:23:34.902939 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:34.902972 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:34.903046 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "to": "PhysicalTime:1732530214902791000 "}
2024/11/25 18:23:34.903082 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:34.903187 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:34.903213 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:34.903313 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "107.458µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:34.903381 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "166.917µs"}
2024/11/25 18:23:34.904485 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 10000, "WorkspaceThreshold": 2097152, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:34.904576 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc048644320"}
2024/11/25 18:23:34.904675 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0486443c0"}
2024/11/25 18:23:34.904728 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc048644460"}
2024/11/25 18:23:35.009693 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:35.010306 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:35.013571 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "stream-id": 1, "remote": ""}
2024/11/25 18:23:35.013761 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:35.014299 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530215012631000-0", "minTs": "0-0"}
2024/11/25 18:23:35.014440 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530215012631000 "}
2024/11/25 18:23:35.014845 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:35.015007 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:35.016046 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:35.016388 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530215014643000-0", "minTs": "0-0"}
2024/11/25 18:23:35.018196 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530215014643000 "}
2024/11/25 18:23:35.018491 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:35.018584 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:35.019122 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:35.019383 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530215018594000-0", "minTs": "0-0"}
2024/11/25 18:23:35.019467 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530215018594000 "}
2024/11/25 18:23:35.019671 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:35.020019 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:35.024595 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:35.027627 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:35.031300 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0d15ec03cb/Active/S:1732530215018594000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc037770000"}
2024/11/25 18:23:35.034905 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:35.034987 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530215018594000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:35.035107 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:35.066355 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0D15EC03CA][1732530215018594000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:35.065493 UTC}"}
2024/11/25 18:23:35.066725 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0D15EC03CA][1732530215018594000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:35.073484 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.181167ms", "cn-txn": "cbf29ce484222325180b2f0d15ec03ca/Active/S:1732530215018594000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0D15EC03CA][1732530215018594000-1->1732530215067569000-0][Committed]: <nil>"}
2024/11/25 18:23:35.082306 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-153]16385-test_reader_table", "extra-info": {"a-objs": "cb61f5a1777e_0,", "a-tombstones": "d373f33d2ab6_0,"}, "txn-info": "ctx[019362D918AA71DC8A96773BAD8E117E][1732530215080837000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 2}
2024/11/25 18:23:35.082694 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-153]16385-test_reader_table", "sort-key": "mock_12"}
2024/11/25 18:23:35.097276 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-153]16385-test_reader_table", "sort-key": "__mo_%1_delete_rowid"}
2024/11/25 18:23:35.116792 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-153]16385-test_reader_table", "aobj-deletes": 8, "aobj-merge-rows": 2, "tombstone-rows": 8, "duration": "34.322917ms", "extra-info": {"a-objs": "cb61f5a1777e_0,", "a-tombstones": "d373f33d2ab6_0,", "to-objs": "943d75825f95_0,", "to-tombstones": "739703a8bc69_0,"}}
2024/11/25 18:23:35.177412 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:35.178778 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-17f6-74c2-b07c-20e9e0beaeee", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530215178599000 "}
2024/11/25 18:23:35.179155 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc00e0955e0"}
2024/11/25 18:23:35.179705 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc01f90a1b0
2024/11/25 18:23:35.180514 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:35.186981 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:35.192787 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:35.198263 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:35.198376 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:35.201830 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:35.201910 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:35.202041 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:35.201982 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:35.202004 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:35.202135 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:35.202189 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:35.202060 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:35.202227 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:35.820846 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-2c0b-78fc-bac5-e64bc3649769", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:35.916009 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-b730-7261-8da1-366c20ef11d0", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:36.021558 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-69bb-7128-a18e-1f67cd5aa87c", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:36.260172 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:36.260857 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:36.274744 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "291ns"}
2024/11/25 18:23:36.274839 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "151.208µs", "checkpointed": "0-0"}
2024/11/25 18:23:36.274936 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "5.583µs"}
2024/11/25 18:23:36.275038 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:36.275133 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:36.275209 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:36.275276 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "378.375µs"}
2024/11/25 18:23:36.275390 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:36.275541 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:36.275629 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "15.363625ms", "err": null}
2024/11/25 18:23:36.275655 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "100.75µs"}
2024/11/25 18:23:36.275645 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:36.275698 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "156.416µs"}
2024/11/25 18:23:36.275813 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:36.275871 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:36.275898 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "62.833µs"}
2024/11/25 18:23:36.275984 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "170.875µs"}
2024/11/25 18:23:36.276077 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4"}
2024/11/25 18:23:36.276149 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:36.276248 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:36.276346 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:36.276401 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:36.276418 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:36.276558 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "146.708µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:36.276627 +0800 INFO logtail/mgr.go:169 init waterline to 1732530216276520000-0
2024/11/25 18:23:36.276633 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "216.75µs"}
2024/11/25 18:23:36.276760 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "to": "PhysicalTime:1732530216276520000 "}
2024/11/25 18:23:36.278110 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:36.278182 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0376721e0"}
2024/11/25 18:23:36.278229 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc037672280"}
2024/11/25 18:23:36.278262 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc037672320"}
2024/11/25 18:23:36.337059 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-fe35-7ef0-b802-b374fe424ddf", "stream-id": 1, "remote": "", "sendRound": 72}
2024/11/25 18:23:36.381427 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:36.381507 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:36.382142 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "stream-id": 1, "remote": ""}
2024/11/25 18:23:36.382248 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:36.382493 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216380653000-0", "minTs": "0-0"}
2024/11/25 18:23:36.382566 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530216380653000 "}
2024/11/25 18:23:36.382798 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.382904 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:36.383123 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:36.383311 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216382715000-0", "minTs": "0-0"}
2024/11/25 18:23:36.383389 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530216382715000 "}
2024/11/25 18:23:36.383542 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.383598 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:36.384165 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:36.384387 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216382715000-0", "minTs": "0-0"}
2024/11/25 18:23:36.384463 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530216382715000 "}
2024/11/25 18:23:36.384714 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.384771 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:36.388910 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:36.390641 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:36.392133 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0d67c7852b/Active/S:1732530216382715000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0155c9a40"}
2024/11/25 18:23:36.393937 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:36.393975 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530216382715000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.394047 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:36.433733 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0D67C7852A][1732530216382715000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:36.432985 UTC}"}
2024/11/25 18:23:36.434058 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0D67C7852A][1732530216382715000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:36.440200 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.523417ms", "cn-txn": "cbf29ce484222325180b2f0d67c7852a/Active/S:1732530216382715000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0D67C7852A][1732530216382715000-1->1732530216434978000-0][Committed]: <nil>"}
2024/11/25 18:23:36.543047 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:36.543659 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1d53-7d5d-9dc9-54c0110148f4", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530216542716000 "}
2024/11/25 18:23:36.543955 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc0261a5040"}
2024/11/25 18:23:36.544155 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03bd99ab0
2024/11/25 18:23:36.545081 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:36.555666 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:36.560720 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:36.566041 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:36.566137 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:36.566359 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:36.566385 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:36.566379 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:36.566396 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:36.566408 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:36.566414 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:36.566506 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:36.567461 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:36.568115 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:36.574243 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "416ns"}
2024/11/25 18:23:36.574309 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "274.584µs", "checkpointed": "0-0"}
2024/11/25 18:23:36.574370 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "5.5µs"}
2024/11/25 18:23:36.574438 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:36.574477 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:36.574503 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:36.574543 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "195.833µs"}
2024/11/25 18:23:36.574635 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:36.574767 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:36.574807 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "7.275ms", "err": null}
2024/11/25 18:23:36.574830 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:36.574963 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:36.574995 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "234.5µs"}
2024/11/25 18:23:36.575050 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "282.458µs"}
2024/11/25 18:23:36.575087 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:36.575103 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627"}
2024/11/25 18:23:36.575122 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "37.5µs"}
2024/11/25 18:23:36.575177 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "89.375µs"}
2024/11/25 18:23:36.575292 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:36.575307 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:36.575361 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:36.575408 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:36.575417 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:36.575475 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "61.209µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:36.575520 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "102.667µs"}
2024/11/25 18:23:36.576106 +0800 INFO logtail/mgr.go:169 init waterline to 1732530216576037000-0
2024/11/25 18:23:36.576180 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "to": "PhysicalTime:1732530216576037000 "}
2024/11/25 18:23:36.576193 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:36.576247 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc02979d400"}
2024/11/25 18:23:36.576295 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc02979d4a0"}
2024/11/25 18:23:36.576344 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc02979d540"}
2024/11/25 18:23:36.669539 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-0c73-7a8b-ba0e-71774453ffe2", "stream-id": 1, "remote": "", "sendRound": 6}
2024/11/25 18:23:36.680756 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:36.680823 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:36.681293 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "stream-id": 1, "remote": ""}
2024/11/25 18:23:36.681366 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:36.681591 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216680189000-0", "minTs": "0-0"}
2024/11/25 18:23:36.681654 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530216680189000 "}
2024/11/25 18:23:36.681846 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.681920 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:36.682269 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:36.682444 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216681980000-0", "minTs": "0-0"}
2024/11/25 18:23:36.682506 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530216681980000 "}
2024/11/25 18:23:36.682663 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.682721 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:36.683406 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:36.683565 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530216681980000-0", "minTs": "0-0"}
2024/11/25 18:23:36.683619 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530216681980000 "}
2024/11/25 18:23:36.683744 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.683790 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:36.687905 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:36.689564 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:36.691098 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0d7999b70b/Active/S:1732530216681980000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc027ec32c0"}
2024/11/25 18:23:36.692987 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:36.693029 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530216681980000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:36.693085 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:36.733166 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0D7999B70A][1732530216681980000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:36.732420 UTC}"}
2024/11/25 18:23:36.733431 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0D7999B70A][1732530216681980000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:36.738461 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "5.341916ms", "cn-txn": "cbf29ce484222325180b2f0d7999b70a/Active/S:1732530216681980000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0D7999B70A][1732530216681980000-1->1732530216734246000-0][Committed]: <nil>"}
2024/11/25 18:23:36.799202 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:36.799483 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1e7e-7ecd-951f-5d790d0b4627", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530216798192000 "}
2024/11/25 18:23:36.799691 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc0135445a0"}
2024/11/25 18:23:36.799831 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc04664e1b0
2024/11/25 18:23:36.800192 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:36.808182 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0d7999b70c/Active/S:1732530216790197000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "2.252KiB", "obj-size": "991B", "blk-cnt": 1, "row-cnt": 5, "names": ["ae879f060ba2_0"]}
2024/11/25 18:23:36.873233 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:36.878291 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:36.883915 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:36.884055 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:36.884426 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:36.884445 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:36.884466 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:36.884488 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:36.884527 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:36.884572 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:36.884652 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:36.885700 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:36.886707 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:36.895791 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "417ns"}
2024/11/25 18:23:36.895875 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "126.792µs", "checkpointed": "0-0"}
2024/11/25 18:23:36.895977 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "4.834µs"}
2024/11/25 18:23:36.896065 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:36.896130 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:36.896187 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:36.896240 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "300.875µs"}
2024/11/25 18:23:36.896368 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:36.896577 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:36.896654 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "10.827334ms", "err": null}
2024/11/25 18:23:36.896668 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "109.167µs"}
2024/11/25 18:23:36.896670 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:36.896729 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "150.166µs"}
2024/11/25 18:23:36.896791 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:36.896836 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "50µs"}
2024/11/25 18:23:36.896880 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "89.167µs"}
2024/11/25 18:23:36.896994 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:36.897077 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9"}
2024/11/25 18:23:36.897345 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:36.897489 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:36.897593 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:36.897663 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:36.897663 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:36.897758 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "88.375µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:36.897833 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "170.875µs"}
2024/11/25 18:23:36.897844 +0800 INFO logtail/mgr.go:169 init waterline to 1732530216897699000-0
2024/11/25 18:23:36.897940 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "to": "PhysicalTime:1732530216897699000 "}
2024/11/25 18:23:36.898721 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:36.898807 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc030c7eaa0"}
2024/11/25 18:23:36.898866 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc030c7eb40"}
2024/11/25 18:23:36.898909 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc030c7ebe0"}
2024/11/25 18:23:37.002290 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:37.002389 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:37.002875 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "stream-id": 1, "remote": ""}
2024/11/25 18:23:37.002970 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:37.003278 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217001835000-0", "minTs": "0-0"}
2024/11/25 18:23:37.003376 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530217001835000 "}
2024/11/25 18:23:37.003618 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.003703 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:37.003825 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:37.004042 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217003728000-0", "minTs": "0-0"}
2024/11/25 18:23:37.004136 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530217003728000 "}
2024/11/25 18:23:37.004322 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.004401 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:37.004993 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:37.005205 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217003728000-0", "minTs": "0-0"}
2024/11/25 18:23:37.005289 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530217003728000 "}
2024/11/25 18:23:37.005481 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.005551 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:37.010034 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:37.012044 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:37.013869 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0d8ccbcedb/Active/S:1732530217003728000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc0335e97c0"}
2024/11/25 18:23:37.016151 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:37.016199 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530217003728000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.016285 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:37.055283 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0D8CCBCEDA][1732530217003728000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:37.054106 UTC}"}
2024/11/25 18:23:37.055765 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0D8CCBCEDA][1732530217003728000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:37.062620 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.434667ms", "cn-txn": "cbf29ce484222325180b2f0d8ccbceda/Active/S:1732530217003728000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0D8CCBCEDA][1732530217003728000-1->1732530217056944000-0][Committed]: <nil>"}
2024/11/25 18:23:37.166360 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:37.167606 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-1fc0-7f23-b9fb-2fd25836fbc9", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530217165846000 "}
2024/11/25 18:23:37.168098 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc04acb7400"}
2024/11/25 18:23:37.168513 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc0071cd5b0
2024/11/25 18:23:37.169460 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:37.195926 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-bc6b-79e3-80ad-f4ea58018fe9", "stream-id": 1, "remote": "", "sendRound": 27}
2024/11/25 18:23:37.239878 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:37.245135 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:37.251484 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:37.251968 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:37.252969 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:37.252985 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:37.253053 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:37.253215 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:37.253223 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:37.253299 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:37.253424 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:37.255914 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:37.257630 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:37.271565 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "667ns"}
2024/11/25 18:23:37.271674 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "1.251416ms", "checkpointed": "0-0"}
2024/11/25 18:23:37.271795 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.166µs"}
2024/11/25 18:23:37.271906 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:37.271983 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:37.272130 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:37.272213 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "465.834µs"}
2024/11/25 18:23:37.272383 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:37.272644 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:37.272750 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "16.637833ms", "err": null}
2024/11/25 18:23:37.272792 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "173.25µs"}
2024/11/25 18:23:37.272758 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:37.272868 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "223.5µs"}
2024/11/25 18:23:37.272935 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:37.272994 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "62.708µs"}
2024/11/25 18:23:37.273021 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:37.273061 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "125.209µs"}
2024/11/25 18:23:37.273201 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f"}
2024/11/25 18:23:37.273526 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:37.273634 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:37.273740 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:37.273838 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:37.273846 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:37.273911 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "78.042µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:37.273988 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "150.042µs"}
2024/11/25 18:23:37.274541 +0800 INFO logtail/mgr.go:169 init waterline to 1732530217274451000-0
2024/11/25 18:23:37.274694 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "to": "PhysicalTime:1732530217274451000 "}
2024/11/25 18:23:37.275231 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:37.275348 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0553e83c0"}
2024/11/25 18:23:37.275470 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0553e8460"}
2024/11/25 18:23:37.275539 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0553e8500"}
2024/11/25 18:23:37.380773 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:37.381191 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:37.382365 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "stream-id": 1, "remote": ""}
2024/11/25 18:23:37.382630 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:37.383513 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217382493000-0", "minTs": "0-0"}
2024/11/25 18:23:37.383757 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530217382493000 "}
2024/11/25 18:23:37.384481 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.384662 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:37.385347 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:37.385780 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217384244000-0", "minTs": "0-0"}
2024/11/25 18:23:37.385949 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530217384244000 "}
2024/11/25 18:23:37.386299 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.386411 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:37.387510 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:37.388094 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217386253000-0", "minTs": "0-0"}
2024/11/25 18:23:37.388345 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530217386253000 "}
2024/11/25 18:23:37.388817 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.388980 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:37.394149 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-7701-75ef-9278-138048e95adf", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:37.396382 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:37.401283 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:37.404164 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-36bb-7d71-bccf-f2aef58ccbf2", "stream-id": 1, "remote": "", "sendRound": 4}
2024/11/25 18:23:37.404925 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0da337c0a3/Active/S:1732530217386253000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc052ada3c0"}
2024/11/25 18:23:37.409048 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:37.409143 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530217386253000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.409254 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:37.434199 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0DA337C0A2][1732530217386253000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:37.432880 UTC}"}
2024/11/25 18:23:37.434732 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0DA337C0A2][1732530217386253000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:37.441604 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.483209ms", "cn-txn": "cbf29ce484222325180b2f0da337c0a2/Active/S:1732530217386253000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0DA337C0A2][1732530217386253000-1->1732530217435912000-0][Committed]: <nil>"}
2024/11/25 18:23:37.504391 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0da337c0a4/Active/S:1732530217492454000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "2.349KiB", "obj-size": "1.042KiB", "blk-cnt": 1, "row-cnt": 10, "names": ["cfae82dcceda_0"]}
2024/11/25 18:23:37.552397 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:37.553103 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2139-70fa-96c6-500fb587cc5f", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530217552354000 "}
2024/11/25 18:23:37.553648 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc003143c20"}
2024/11/25 18:23:37.553880 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc047fccbb0
2024/11/25 18:23:37.554351 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:37.573281 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0da337c0a5/Active/S:1732530217544444000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "2.252KiB", "obj-size": "997B", "blk-cnt": 1, "row-cnt": 5, "names": ["19ef42df8f32_0"]}
2024/11/25 18:23:37.573423 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Tombstone {"txn-id": "cbf29ce484222325180b2f0da337c0a5/Active/S:1732530217544444000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "1.759KiB", "obj-size": "865B", "blk-cnt": 1, "row-cnt": 5, "names": ["4b00b655d6d3_0"]}
2024/11/25 18:23:37.641005 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:37.646286 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:37.652032 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:37.652170 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:37.652613 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:37.652628 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:37.652653 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:37.652818 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:37.652883 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:37.652899 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:37.653024 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:37.654641 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:37.656054 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:37.671064 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "708ns"}
2024/11/25 18:23:37.671198 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "195.958µs", "checkpointed": "0-0"}
2024/11/25 18:23:37.671316 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "11.375µs"}
2024/11/25 18:23:37.671439 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:37.671512 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:37.671568 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:37.671637 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "368.875µs"}
2024/11/25 18:23:37.671988 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:37.672367 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:37.672510 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "173.417µs"}
2024/11/25 18:23:37.672532 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "17.763292ms", "err": null}
2024/11/25 18:23:37.672578 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "208.833µs"}
2024/11/25 18:23:37.672584 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:37.672648 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:37.672707 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "66.333µs"}
2024/11/25 18:23:37.672761 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "111.875µs"}
2024/11/25 18:23:37.672957 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:37.673220 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47"}
2024/11/25 18:23:37.673646 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:37.673663 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:37.673739 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:37.673822 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:37.673825 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:37.673916 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "96.625µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:37.674001 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "176.75µs"}
2024/11/25 18:23:37.674981 +0800 INFO logtail/mgr.go:169 init waterline to 1732530217674891000-0
2024/11/25 18:23:37.675323 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "to": "PhysicalTime:1732530217674891000 "}
2024/11/25 18:23:37.681062 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:37.681214 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0582d12c0"}
2024/11/25 18:23:37.681293 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0582d1360"}
2024/11/25 18:23:37.681360 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0582d1400"}
2024/11/25 18:23:37.789474 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:37.789624 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:37.790317 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "stream-id": 1, "remote": ""}
2024/11/25 18:23:37.790476 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:37.790986 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217788889000-0", "minTs": "0-0"}
2024/11/25 18:23:37.791149 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530217788889000 "}
2024/11/25 18:23:37.791572 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.791690 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:37.792337 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:37.792626 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217790834000-0", "minTs": "0-0"}
2024/11/25 18:23:37.792727 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530217790834000 "}
2024/11/25 18:23:37.792991 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.793091 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:37.793442 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:37.793752 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530217792704000-0", "minTs": "0-0"}
2024/11/25 18:23:37.793893 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530217792704000 "}
2024/11/25 18:23:37.794142 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.794249 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:37.799730 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:37.803459 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:37.806259 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0dbb115013/Active/S:1732530217792704000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc054e59040"}
2024/11/25 18:23:37.809841 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:37.809928 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530217792704000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:37.810050 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:37.830716 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1068-7ca6-b400-0d2ef616f14c", "stream-id": 1, "remote": "", "sendRound": 11}
2024/11/25 18:23:37.842532 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0DBB115012][1732530217792704000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:37.841194 UTC}"}
2024/11/25 18:23:37.843142 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0DBB115012][1732530217792704000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:37.850644 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.211709ms", "cn-txn": "cbf29ce484222325180b2f0dbb115012/Active/S:1732530217792704000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0DBB115012][1732530217792704000-1->1732530217844630000-0][Committed]: <nil>"}
2024/11/25 18:23:37.908891 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0dbb115014/Active/S:1732530217900898000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "1.917KiB", "obj-size": "896B", "blk-cnt": 1, "row-cnt": 30, "names": ["ab33a4690c2f_0"]}
2024/11/25 18:23:37.927014 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-377d-7822-bcf2-c6f9b2af021e", "stream-id": 1, "remote": "", "sendRound": 12}
2024/11/25 18:23:37.953449 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:37.954276 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-22c9-707d-a944-2f57e36e9d47", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:1 ", "To": "PhysicalTime:1732530217952880000 "}
2024/11/25 18:23:37.954787 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05a2bab40"}
2024/11/25 18:23:37.955069 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc047fcd0b0
2024/11/25 18:23:37.955492 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:38.016568 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Tombstone {"txn-id": "cbf29ce484222325180b2f0dbb115016/Active/S:1732530218004888000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "1.985KiB", "obj-size": "985B", "blk-cnt": 1, "row-cnt": 10, "names": ["9c9fb16af070_0"]}
2024/11/25 18:23:38.082660 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Tombstone {"txn-id": "cbf29ce484222325180b2f0dbb115017/Active/S:1732530218072917000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "1.985KiB", "obj-size": "989B", "blk-cnt": 1, "row-cnt": 10, "names": ["3e8f7bd030a5_0"]}
2024/11/25 18:23:38.154015 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:38.159137 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:38.165415 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:38.165752 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:38.166676 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.166707 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:38.166782 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:38.166881 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:38.166914 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:38.166908 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.167070 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:38.170058 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:38.171601 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:38.198947 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "542ns"}
2024/11/25 18:23:38.199069 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "220.25µs", "checkpointed": "0-0"}
2024/11/25 18:23:38.199190 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "8.917µs"}
2024/11/25 18:23:38.199296 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:38.199384 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:38.199437 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:38.199490 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "342.709µs"}
2024/11/25 18:23:38.199846 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:38.200465 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:38.200567 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "129.041µs"}
2024/11/25 18:23:38.200620 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "157.375µs"}
2024/11/25 18:23:38.200673 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "30.43725ms", "err": null}
2024/11/25 18:23:38.200731 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:38.200679 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:38.200797 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "71.042µs"}
2024/11/25 18:23:38.200909 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "177.5µs"}
2024/11/25 18:23:38.201181 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:38.201379 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85"}
2024/11/25 18:23:38.201705 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:38.201776 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:38.201796 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:38.201851 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:38.201859 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:38.201928 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "74.042µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:38.202113 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "254.625µs"}
2024/11/25 18:23:38.202521 +0800 INFO logtail/mgr.go:169 init waterline to 1732530218202451000-0
2024/11/25 18:23:38.202900 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "to": "PhysicalTime:1732530218202451000 "}
2024/11/25 18:23:38.206311 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:38.206448 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc052fb3d60"}
2024/11/25 18:23:38.206558 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc052fb3e00"}
2024/11/25 18:23:38.206653 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc052fb3ea0"}
2024/11/25 18:23:38.271649 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-5356-79fa-9cc9-1e049ac28995", "stream-id": 1, "remote": "", "sendRound": 76}
2024/11/25 18:23:38.310802 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:38.310945 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:38.311620 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "stream-id": 1, "remote": ""}
2024/11/25 18:23:38.311774 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:38.312206 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218310224000-0", "minTs": "0-0"}
2024/11/25 18:23:38.312344 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530218310224000 "}
2024/11/25 18:23:38.312768 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.312884 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:38.313562 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:38.313840 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218312280000-0", "minTs": "0-0"}
2024/11/25 18:23:38.313953 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530218312280000 "}
2024/11/25 18:23:38.314190 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.314293 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:38.314639 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:38.314926 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218314305000-0", "minTs": "0-0"}
2024/11/25 18:23:38.315049 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530218314305000 "}
2024/11/25 18:23:38.315292 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.315389 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:38.320854 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:38.323977 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:38.326754 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0dda8c0f23/Active/S:1732530218314305000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc058587c20"}
2024/11/25 18:23:38.329848 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:38.329914 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530218314305000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.330017 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:38.364061 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0DDA8C0F22][1732530218314305000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:38.362811 UTC}"}
2024/11/25 18:23:38.364550 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0DDA8C0F22][1732530218314305000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:38.372875 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "8.891875ms", "cn-txn": "cbf29ce484222325180b2f0dda8c0f22/Active/S:1732530218314305000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0DDA8C0F22][1732530218314305000-1->1732530218365840000-0][Committed]: <nil>"}
2024/11/25 18:23:38.406544 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-398f-7524-975d-a0402ff95da6", "stream-id": 1, "remote": "", "sendRound": 10}
2024/11/25 18:23:38.425022 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0dda8c0f24", "before": 2, "after": 1}
2024/11/25 18:23:38.425205 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0dda8c0f24", "before": 1, "after": 1}
2024/11/25 18:23:38.475056 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:38.476509 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-24d9-7416-a17b-83786a606b85", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530218476228000 "}
2024/11/25 18:23:38.477095 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05ec00280"}
2024/11/25 18:23:38.477520 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03ba5a430
2024/11/25 18:23:38.478135 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:38.488938 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:38.494102 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:38.499926 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:38.500126 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:38.500760 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.500767 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:38.500802 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.500886 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:38.500939 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:38.500988 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:38.501091 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:38.502591 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:38.503895 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:38.520103 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "709ns"}
2024/11/25 18:23:38.520213 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "201.25µs", "checkpointed": "0-0"}
2024/11/25 18:23:38.520324 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "10.583µs"}
2024/11/25 18:23:38.520432 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:38.520502 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:38.520607 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:38.520675 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "404.125µs"}
2024/11/25 18:23:38.520861 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:38.521489 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:38.521610 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "160.333µs"}
2024/11/25 18:23:38.521614 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "18.879167ms", "err": null}
2024/11/25 18:23:38.521624 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:38.521711 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "218.625µs"}
2024/11/25 18:23:38.521762 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:38.521809 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "54.584µs"}
2024/11/25 18:23:38.521851 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "89.25µs"}
2024/11/25 18:23:38.521935 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:38.522426 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84"}
2024/11/25 18:23:38.522801 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:38.522816 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:38.522908 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:38.522989 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:38.523000 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:38.523086 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "89µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:38.523188 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "188.917µs"}
2024/11/25 18:23:38.523649 +0800 INFO logtail/mgr.go:169 init waterline to 1732530218523589000-0
2024/11/25 18:23:38.523768 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "to": "PhysicalTime:1732530218523589000 "}
2024/11/25 18:23:38.526719 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:38.526821 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05834c3c0"}
2024/11/25 18:23:38.526878 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05834c460"}
2024/11/25 18:23:38.527202 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05834c500"}
2024/11/25 18:23:38.631833 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:38.631973 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:38.632712 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "stream-id": 1, "remote": ""}
2024/11/25 18:23:38.632894 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:38.633347 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218631348000-0", "minTs": "0-0"}
2024/11/25 18:23:38.633494 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530218631348000 "}
2024/11/25 18:23:38.633863 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.634025 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:38.634749 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:38.635036 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218633607000-0", "minTs": "0-0"}
2024/11/25 18:23:38.635151 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530218633607000 "}
2024/11/25 18:23:38.635431 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.635543 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:38.635864 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:38.636271 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218635364000-0", "minTs": "0-0"}
2024/11/25 18:23:38.636395 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530218635364000 "}
2024/11/25 18:23:38.636715 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.636816 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:38.642067 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:38.645384 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:38.648067 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0dedae3103/Active/S:1732530218635364000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc05eb046e0"}
2024/11/25 18:23:38.651243 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:38.651299 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530218635364000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.651412 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:38.685281 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0DEDAE3102][1732530218635364000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:38.683867 UTC}"}
2024/11/25 18:23:38.685721 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0DEDAE3102][1732530218635364000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:38.692931 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.741ms", "cn-txn": "cbf29ce484222325180b2f0dedae3102/Active/S:1732530218635364000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0DEDAE3102][1732530218635364000-1->1732530218687125000-0][Committed]: <nil>"}
2024/11/25 18:23:38.763945 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0dedae3104", "before": 2, "after": 1}
2024/11/25 18:23:38.764170 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:38.764606 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2619-7ee8-984a-848044fb7d84", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530218763560000 "}
2024/11/25 18:23:38.764989 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05ec01860"}
2024/11/25 18:23:38.765199 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc046be4430
2024/11/25 18:23:38.767694 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:38.768126 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0dedae3104", "before": 1, "after": 1}
2024/11/25 18:23:38.777111 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0dedae3104/Active/S:1732530218743578000-1", "table-id": 16385, "table-name": "test_table", "obj-cnt": 1, "obj-osize": "2.252KiB", "obj-size": "986B", "blk-cnt": 1, "row-cnt": 5, "names": ["e5f819c6f8c3_0"]}
2024/11/25 18:23:38.845044 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:38.850158 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:38.856039 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:38.856245 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:38.856753 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:38.856780 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:38.856767 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.856818 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:38.856892 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:38.856840 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:38.857001 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:38.857084 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:38.857144 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:38.859506 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:38.860775 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:38.871212 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "667ns"}
2024/11/25 18:23:38.871306 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "139.875µs", "checkpointed": "0-0"}
2024/11/25 18:23:38.871444 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "6.833µs"}
2024/11/25 18:23:38.871575 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:38.871644 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:38.871697 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:38.871765 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "375.25µs"}
2024/11/25 18:23:38.871952 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:38.872127 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:38.872215 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:38.872242 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "141.666µs"}
2024/11/25 18:23:38.872221 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "12.571375ms", "err": null}
2024/11/25 18:23:38.872333 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "205.334µs"}
2024/11/25 18:23:38.872422 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:38.872481 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "67.167µs"}
2024/11/25 18:23:38.872541 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "119.75µs"}
2024/11/25 18:23:38.872615 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:38.872806 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7"}
2024/11/25 18:23:38.873094 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:38.873115 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:38.873151 +0800 INFO logtail/mgr.go:169 init waterline to 1732530218873032000-0
2024/11/25 18:23:38.873176 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:38.873248 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:38.873246 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:38.873278 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "to": "PhysicalTime:1732530218873032000 "}
2024/11/25 18:23:38.873331 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "90.583µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:38.873399 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "153.75µs"}
2024/11/25 18:23:38.874600 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:38.874737 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc0572b7860"}
2024/11/25 18:23:38.874822 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc0572b7900"}
2024/11/25 18:23:38.874881 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc0572b79a0"}
2024/11/25 18:23:38.979033 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:38.979143 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:38.979736 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "stream-id": 1, "remote": ""}
2024/11/25 18:23:38.979863 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:38.980285 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218979026000-0", "minTs": "0-0"}
2024/11/25 18:23:38.980414 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530218979026000 "}
2024/11/25 18:23:38.980766 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.980872 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:38.981718 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:38.982022 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218981022000-0", "minTs": "0-0"}
2024/11/25 18:23:38.982157 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530218981022000 "}
2024/11/25 18:23:38.982455 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.982546 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:38.982768 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:38.983039 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530218981022000-0", "minTs": "0-0"}
2024/11/25 18:23:38.983152 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530218981022000 "}
2024/11/25 18:23:38.983454 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.983546 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:38.988464 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:38.991294 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:38.993926 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0e028f6803/Active/S:1732530218981022000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc05ec01ea0"}
2024/11/25 18:23:38.996800 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:38.996860 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530218981022000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:38.996947 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.006280 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-6ed0-75c4-9b17-8568f83564a5", "stream-id": 1, "remote": "", "sendRound": 227}
2024/11/25 18:23:39.032729 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0E028F6802][1732530218981022000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:39.031557 UTC}"}
2024/11/25 18:23:39.033193 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0E028F6802][1732530218981022000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_database:16385-test_table"}
2024/11/25 18:23:39.040047 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.402667ms", "cn-txn": "cbf29ce484222325180b2f0e028f6802/Active/S:1732530218981022000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0E028F6802][1732530218981022000-1->1732530219034320000-0][Committed]: <nil>"}
2024/11/25 18:23:39.143870 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:39.145482 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2778-7a16-ae89-221d6eb3d3d7", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_database\" tb_name:\"test_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530219145028000 "}
2024/11/25 18:23:39.146126 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc053023e00"}
2024/11/25 18:23:39.146676 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc03ba5a6b0
2024/11/25 18:23:39.146940 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_table] succeed
2024/11/25 18:23:39.147918 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0e028f6805", "before": 2, "after": 1}
2024/11/25 18:23:39.148165 +0800 INFO disttae/types.go:729 RollbackLastStatement {"txn": "cbf29ce484222325180b2f0e028f6805", "before": 2, "after": 1}
2024/11/25 18:23:39.211308 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:39.216538 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:39.222237 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:39.222422 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:39.222892 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.222894 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:39.222985 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:39.223139 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:39.223143 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.223235 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:39.223329 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:39.223389 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:39.223452 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:39.224951 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:39.226644 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:39.237127 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "709ns"}
2024/11/25 18:23:39.237257 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "228.417µs", "checkpointed": "0-0"}
2024/11/25 18:23:39.237386 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "10.375µs"}
2024/11/25 18:23:39.237515 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:39.237601 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:39.237660 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:39.237759 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "433.083µs"}
2024/11/25 18:23:39.237951 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:39.238229 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:39.238291 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "13.123792ms", "err": null}
2024/11/25 18:23:39.238307 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:39.238347 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "145.334µs"}
2024/11/25 18:23:39.238426 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "196µs"}
2024/11/25 18:23:39.238504 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:39.238512 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:39.238570 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "71.167µs"}
2024/11/25 18:23:39.238624 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "120.75µs"}
2024/11/25 18:23:39.238655 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14"}
2024/11/25 18:23:39.238982 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.239182 +0800 INFO logtail/mgr.go:169 init waterline to 1732530219239043000-0
2024/11/25 18:23:39.239316 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "to": "PhysicalTime:1732530219239043000 "}
2024/11/25 18:23:39.239376 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:39.239525 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:39.239630 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:39.239628 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:39.239727 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "103.625µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:39.239810 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "183.083µs"}
2024/11/25 18:23:39.240697 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:39.240845 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05a5952c0"}
2024/11/25 18:23:39.240938 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05a595360"}
2024/11/25 18:23:39.241004 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05a595400"}
2024/11/25 18:23:39.332755 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-c185-7c15-a3f7-4b29f4264f57", "stream-id": 1, "remote": "", "sendRound": 43}
2024/11/25 18:23:39.345838 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:39.345961 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:39.346574 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "stream-id": 1, "remote": ""}
2024/11/25 18:23:39.346711 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:39.347130 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219345167000-0", "minTs": "0-0"}
2024/11/25 18:23:39.347260 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530219345167000 "}
2024/11/25 18:23:39.347670 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.347788 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:39.348635 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:39.348921 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219347050000-0", "minTs": "0-0"}
2024/11/25 18:23:39.349026 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530219347050000 "}
2024/11/25 18:23:39.349277 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.349375 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:39.349664 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:39.349918 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219348971000-0", "minTs": "0-0"}
2024/11/25 18:23:39.350037 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530219348971000 "}
2024/11/25 18:23:39.350315 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.350410 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:39.355766 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:39.358536 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:39.361102 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0e185e46db/Active/S:1732530219348971000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc04ac7caa0"}
2024/11/25 18:23:39.364025 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:39.364090 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530219348971000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.364180 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.398716 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0E185E46DA][1732530219348971000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:39.397501 UTC}"}
2024/11/25 18:23:39.399181 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0E185E46DA][1732530219348971000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:39.406019 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.398708ms", "cn-txn": "cbf29ce484222325180b2f0e185e46da/Active/S:1732530219348971000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0E185E46DA][1732530219348971000-1->1732530219400413000-0][Committed]: <nil>"}
2024/11/25 18:23:39.476302 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0e185e46dc/Active/S:1732530219457140000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "8.808KiB", "obj-size": "4.909KiB", "blk-cnt": 1, "row-cnt": 149, "names": ["71445c67d62a_0"]}
2024/11/25 18:23:39.509601 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:39.510213 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-28e6-789b-9234-60f59f2f9e14", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530219509140000 "}
2024/11/25 18:23:39.510518 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05c33aa00"}
2024/11/25 18:23:39.510726 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc04664f830
2024/11/25 18:23:39.511653 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:39.522383 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:39.527464 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:39.533037 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:39.533143 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:39.533489 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.533521 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:39.533524 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.533572 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:39.533543 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:39.533579 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:39.533652 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:39.535018 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:39.536089 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100\n  scan-interval = \"5s\"\n  checkpoint-incremental-interval = \"1m0s\"\n  checkpoint-global-interval = 100\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 0\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:39.542349 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "500ns"}
2024/11/25 18:23:39.542422 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "126.792µs", "checkpointed": "0-0"}
2024/11/25 18:23:39.542515 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "15.541µs"}
2024/11/25 18:23:39.542609 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:39.542670 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:39.542738 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:39.542795 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "317.75µs"}
2024/11/25 18:23:39.542919 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:39.543011 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:39.543044 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "7.93125ms", "err": null}
2024/11/25 18:23:39.543055 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:39.543094 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "96.875µs"}
2024/11/25 18:23:39.543159 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "148.041µs"}
2024/11/25 18:23:39.543188 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:39.543209 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:39.543271 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "66.042µs"}
2024/11/25 18:23:39.543290 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b"}
2024/11/25 18:23:39.543318 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "108.958µs"}
2024/11/25 18:23:39.543527 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.543851 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:39.543942 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:39.544009 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:39.544014 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:39.544083 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "72.083µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:39.544129 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "115µs"}
2024/11/25 18:23:39.544568 +0800 INFO logtail/mgr.go:169 init waterline to 1732530219544463000-0
2024/11/25 18:23:39.544697 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "to": "PhysicalTime:1732530219544463000 "}
2024/11/25 18:23:39.545399 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 1, "WorkspaceThreshold": 1, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:39.545503 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05c6ba960"}
2024/11/25 18:23:39.545559 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05c6baa00"}
2024/11/25 18:23:39.545617 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05c6baaa0"}
2024/11/25 18:23:39.651350 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:39.651478 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:39.651839 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "stream-id": 1, "remote": ""}
2024/11/25 18:23:39.651942 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:39.652212 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219650420000-0", "minTs": "0-0"}
2024/11/25 18:23:39.652310 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530219650420000 "}
2024/11/25 18:23:39.652576 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.652693 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:39.652835 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:39.653081 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219652369000-0", "minTs": "0-0"}
2024/11/25 18:23:39.653168 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530219652369000 "}
2024/11/25 18:23:39.653394 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.653488 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:39.653957 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:39.654231 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219652369000-0", "minTs": "0-0"}
2024/11/25 18:23:39.654329 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530219652369000 "}
2024/11/25 18:23:39.654538 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.654604 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:39.658965 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:39.660970 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:39.662922 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0e2a8543c3/Active/S:1732530219652369000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc05c85cdc0"}
2024/11/25 18:23:39.665206 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:39.665262 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530219652369000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.665333 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.703899 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0E2A8543C2][1732530219652369000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:test_reader_database CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:39.702731 UTC}"}
2024/11/25 18:23:39.704305 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0E2A8543C2][1732530219652369000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-test_reader_database:16385-test_reader_table"}
2024/11/25 18:23:39.710931 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "7.099667ms", "cn-txn": "cbf29ce484222325180b2f0e2a8543c2/Active/S:1732530219652369000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0E2A8543C2][1732530219652369000-1->1732530219705387000-0][Committed]: <nil>"}
2024/11/25 18:23:39.776704 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Data {"txn-id": "cbf29ce484222325180b2f0e2a8543c4/Active/S:1732530219762431000-1", "table-id": 16385, "table-name": "test_reader_table", "obj-cnt": 1, "obj-osize": "8.851KiB", "obj-size": "4.938KiB", "blk-cnt": 1, "row-cnt": 150, "names": ["c418a255b701_0"]}
2024/11/25 18:23:39.814871 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:39.815527 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2a17-736e-9b7f-d5d007b4980b", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"test_reader_database\" tb_name:\"test_reader_table\" primary_seqnum:3 ", "To": "PhysicalTime:1732530219814430000 "}
2024/11/25 18:23:39.815901 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05eb1e8c0"}
2024/11/25 18:23:39.816153 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc05a2a6430
2024/11/25 18:23:39.816913 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test_reader_table] succeed
2024/11/25 18:23:39.827769 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:39.832877 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:39.838719 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:39.838865 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
2024/11/25 18:23:39.839351 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.839381 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:39.839431 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:39.839476 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:39.839495 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:39.839460 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:39.839521 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:39.839605 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:39.839751 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:39.841525 +0800 INFO db/open.go:74 open-tae {"operation": "Start", "operand": "open"}
2024/11/25 18:23:39.842918 +0800 INFO db/open.go:101 open-tae {"operation": "Config", "toml": "BulkTomestoneTxnThreshold = 10000\nMaxMessageSize = 0\nTransferTableTTL = \"1m0s\"\nIncrementalDedup = false\nIsStandalone = false\nLogStoreT = \"batchstore\"\n\n[storage-cfg]\n  block-max-rows = 8192\n  object-max-blocks = 256\n\n[checkpoint-cfg]\n  flush-inerterval = \"1m0s\"\n  transfer-interval = \"5s\"\n  metadata-check-inerterval = \"0s\"\n  checkpoint-min-count = 100000000\n  scan-interval = \"1h0m0s\"\n  checkpoint-incremental-interval = \"1h0m0s\"\n  checkpoint-global-interval = 10000000\n  overall-flush-mem-control = 1073741824\n  ForceUpdateGlobalInterval = false\n  GlobalVersionInterval = \"1h0m0s\"\n  GCCheckpointInterval = \"1m0s\"\n  DisableGCCheckpoint = false\n  ReservedWALEntryCount = 0\n  BlockRows = 10\n  Size = 0\n\n[scheduler-cfg]\n  io-workers = 16\n  async-workers = 6\n\n[gc-cfg]\n  gc-ttl = \"1h0m0s\"\n  scan-gc-interval = \"30m0s\"\n  disable-gc = false\n  check-gc = false\n  cache-size = 0\n  gc-merge-count = 40\n  gc-estimate-rows = 0\n  gc-probility = 0.0\n  gc-delete-timeout = \"10m0s\"\n  gc-delete-batch-size = 1000\n\n[LogtailCfg]\n  page-size = 256\n\n[MergeCfg]\n  CNMergeMemControlHint = 8589934592\n  CNTakeOverAll = false\n  CNTakeOverExceed = 83886080000\n  CNStandaloneTake = false\n  DisableZMBasedMerge = false\n\n[CatalogCfg]\n  GCInterval = \"3m0s\"\n  DisableGC = false\n"}
2024/11/25 18:23:39.851268 +0800 INFO checkpoint/replay.go:353 open-tae {"replay": "checkpoint-catalog", "cost": "708ns"}
2024/11/25 18:23:39.851372 +0800 INFO db/open.go:220 open-tae {"operation": "replay", "operand": "checkpoints", "cost": "461.958µs", "checkpointed": "0-0"}
2024/11/25 18:23:39.851473 +0800 INFO batchstoredriver/store.go:278 open-tae {"operation": "replay", "operand": "wal", "backend": "batchstore", "apply cost": "0s", "read cost": "7.959µs"}
2024/11/25 18:23:39.851580 +0800 INFO db/replay.go:123 open-tae {"operation": "replay", "operand": "wal", "apply logentries cost": "0s", "read count": 0, "apply count": 0}
2024/11/25 18:23:39.851660 +0800 INFO txnbase/txnmgr.go:151 init ts to 0-0
2024/11/25 18:23:39.851709 +0800 INFO logtail/storage_usage.go:806 [storage usage] replay: {"remove old deleted db/tbl": "", "delayed tbl": 0}
2024/11/25 18:23:39.851782 +0800 INFO db/open.go:233 open-tae {"operation": "replay", "operand": "wal", "cost": "352.959µs"}
2024/11/25 18:23:39.851959 +0800 INFO v3/deleter.go:52 GC-Worker-Init {"delete-timeout": "10m0s", "delete-batch-size": 1000}
2024/11/25 18:23:39.852236 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-replay-1"}
2024/11/25 18:23:39.852300 +0800 INFO db/open.go:88 open-tae {"operation": "End", "operand": "open", "cost": "10.6675ms", "err": null}
2024/11/25 18:23:39.852308 +0800 INFO db/open.go:377 tae metrics task started
2024/11/25 18:23:39.852503 +0800 INFO rpc/handle.go:182 GC-RPC-Cache {"total": 0, "deleted": 0}
2024/11/25 18:23:39.852562 +0800 INFO v3/checkpoint.go:279 GC-REPLAY-TRACE {"task": "gc-replay-1", "duration": "348.291µs"}
2024/11/25 18:23:39.852636 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-replay-1", "duration": "399.083µs"}
2024/11/25 18:23:39.852657 +0800 INFO cn-service.logtail-server start logtail service {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a"}
2024/11/25 18:23:39.852696 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-try-gc-2"}
2024/11/25 18:23:39.852766 +0800 INFO v3/checkpoint.go:898 GC-TRACE-TRY-GC {"task": "gc-try-gc-2", "duration": "74.625µs"}
2024/11/25 18:23:39.852812 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-try-gc-2", "duration": "116.375µs"}
2024/11/25 18:23:39.852957 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:39.852992 +0800 INFO logtail/mgr.go:169 init waterline to 1732530219852867000-0
2024/11/25 18:23:39.853092 +0800 INFO cn-service.logtail-server init waterline {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "to": "PhysicalTime:1732530219852867000 "}
2024/11/25 18:23:39.853388 +0800 INFO dbutils/runtime.go:313 VectorPool[trasient-vector-pool][0/512]: FixSizedVec[0/307] VarlenVec[0/205], Reset/Hit/totalStats:[0/(0,0)0/0]
VectorPool[small-vector-pool][0/10240]: FixSizedVec[0/6144] VarlenVec[0/4096], Reset/Hit/totalStats:[0/(0,0)0/0]
2024/11/25 18:23:39.853515 +0800 INFO v3/diskcleaner.go:53 GC-Send-Intents
2024/11/25 18:23:39.853597 +0800 INFO db/open.go:324 LogtailStats: Compact[0|0]
2024/11/25 18:23:39.853594 +0800 INFO v3/checkpoint.go:241 GC-Task-Started {"task": "gc-process-3"}
2024/11/25 18:23:39.853689 +0800 INFO v3/checkpoint.go:1393 GC-TRACE-PROCESS {"task": "gc-process-3", "duration": "97.417µs", "start-scan-watermark": "nil", "end-scan-watermark": "nil", "start-gc-watermark": "nil", "end-gc-watermark": "nil"}
2024/11/25 18:23:39.853748 +0800 INFO v3/checkpoint.go:248 GC-Task-Done {"task": "gc-process-3", "duration": "154.958µs"}
2024/11/25 18:23:39.854613 +0800 INFO disttae/engine.go:155 INIT-ENGINE-CONFIG {"InsertEntryMaxCount": 5000, "WorkspaceThreshold": 1048576, "CNTransferTxnLifespanThreshold": "5s"}
2024/11/25 18:23:39.854710 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 1, "service": "", "addr": "0xc05b4619a0"}
2024/11/25 18:23:39.854808 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 2, "service": "", "addr": "0xc05b461a40"}
2024/11/25 18:23:39.854869 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 3, "service": "", "addr": "0xc05b461ae0"}
2024/11/25 18:23:39.959193 +0800 INFO disttae/logtail_consumer.go:1549 [logtail-consumer] try to get logtail service address
2024/11/25 18:23:39.959320 +0800 INFO disttae/logtail_consumer.go:1552 [logtail-consumer] got logtail service address: fake address for ut
2024/11/25 18:23:39.959774 +0800 INFO cn-service.logtail-server initialize new session for morpc stream {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "stream-id": 1, "remote": ""}
2024/11/25 18:23:39.959919 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "table": "db_id:1 tb_id:1 "}
2024/11/25 18:23:39.960296 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219958841000-0", "minTs": "0-0"}
2024/11/25 18:23:39.960408 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:1 db_name:\"mo_catalog\" tb_name:\"mo_database\" primary_seqnum:9 ", "To": "PhysicalTime:1732530219958841000 "}
2024/11/25 18:23:39.960787 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.960916 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 1] succeed
2024/11/25 18:23:39.961810 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "table": "db_id:1 tb_id:2 "}
2024/11/25 18:23:39.962095 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219960833000-0", "minTs": "0-0"}
2024/11/25 18:23:39.962204 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:2 db_name:\"mo_catalog\" tb_name:\"mo_tables\" primary_seqnum:19 ", "To": "PhysicalTime:1732530219960833000 "}
2024/11/25 18:23:39.962427 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.962517 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 2] succeed
2024/11/25 18:23:39.962849 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "table": "db_id:1 tb_id:3 "}
2024/11/25 18:23:39.963148 +0800 INFO logtail/table.go:349 [logtail] fetch with too small ts {"ts": "1732530219962818000-0", "minTs": "0-0"}
2024/11/25 18:23:39.963272 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "stream-id": 1, "remote": "", "table": "db_id:1 tb_id:3 db_name:\"mo_catalog\" tb_name:\"mo_columns\" primary_seqnum:24 ", "To": "PhysicalTime:1732530219962818000 "}
2024/11/25 18:23:39.963521 +0800 INFO cache/catalog.go:65 FIND_TABLE CACHE update serve range {"start": "0-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.963604 +0800 INFO disttae/logtail_consumer.go:1258 [logtail-consumer] subscribe tbl[db: 1, tbl: 3] succeed
2024/11/25 18:23:39.968758 +0800 INFO disttae/logtail_consumer.go:739 FIND_TABLE read mo_catalog.mo_databases [][0] rows
2024/11/25 18:23:39.972010 +0800 INFO disttae/logtail_consumer.go:753 FIND_TABLE read mo_catalog.mo_tables [][0] rows
2024/11/25 18:23:39.974778 +0800 INFO disttae/txn_table.go:1869 open partition state for mo_columns {"txn": "cbf29ce484222325180b2f0e3cf6ab73/Active/S:1732530219962818000-0", "desc": "PartitionState(tid:3) objLen 0, rowsLen 58", "pointer": "0xc05ec91b80"}
2024/11/25 18:23:39.977917 +0800 INFO disttae/logtail_consumer.go:769 FIND_TABLE read mo_catalog.mo_columns [][0] rows
2024/11/25 18:23:39.977992 +0800 INFO cache/catalog.go:75 FIND_TABLE CACHE update serve range (by start) {"start": "1732530219962818000-0", "end": "9223372036854775807-4294967295"}
2024/11/25 18:23:39.978088 +0800 INFO cn-service txn client status changed to normal {"uuid": ""}
2024/11/25 18:23:40.012845 +0800 INFO rpc/handle.go:585 PreCommit-CreateDB {"txn": "ctx[CBF29CE484222325180B2F0E3CF6AB72][1732530219962818000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{DatabaseId:16384 Name:db1 CreateSql: DatTyp: Owner:0 Creator:0 AccountId:0 CreatedTime:2024-11-25 10:23:40.011433 UTC}"}
2024/11/25 18:23:40.013378 +0800 INFO rpc/handle.go:659 PreCommit-CreateTBL {"txn": "ctx[CBF29CE484222325180B2F0E3CF6AB72][1732530219962818000-1->9223372036854775807-4294967295][Active]: <nil>", "i/cnt": "1/1", "cmd": "{aid-0,uid-0,rid-0}: 16384-db1:16385-test1"}
2024/11/25 18:23:40.019465 +0800 INFO rpc/handle.go:441 HandleCommit-With-DDL {"commit-latency": "6.79425ms", "cn-txn": "cbf29ce484222325180b2f0e3cf6ab72/Active/S:1732530219962818000-1", "tn-txn": "ctx[CBF29CE484222325180B2F0E3CF6AB72][1732530219962818000-1->1732530220014757000-0][Committed]: <nil>"}
2024/11/25 18:23:40.024087 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-156]16385-test1", "extra-info": {"a-objs": "c03211c7ee60_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D92BF77E53B6E524A2F3BAAF59][1732530220022990000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:23:40.024368 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-156]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:23:40.046824 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-156]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "22.613125ms", "extra-info": {"a-objs": "c03211c7ee60_0,", "a-tombstones": "", "to-objs": "3f423b04ef80_0,"}}
2024/11/25 18:23:40.052718 +0800 INFO jobs/flushTableTail.go:295 [FLUSH-START] {"task": "[FT-158]16385-test1", "extra-info": {"a-objs": "3651f6e3fe77_0,", "a-tombstones": ""}, "txn-info": "ctx[019362D92C1478BA986D075C2B26FEC4][1732530220050880000-0->9223372036854775807-4294967295][Active]: <nil>", "aobj-ndv": 1}
2024/11/25 18:23:40.052982 +0800 INFO jobs/flushTableTail.go:511 [FLUSH-STEP] {"task": "[FT-158]16385-test1", "sort-key": "mock_2"}
2024/11/25 18:23:40.067796 +0800 INFO jobs/flushTableTail.go:438 [FLUSH-END] {"task": "[FT-158]16385-test1", "aobj-deletes": 0, "aobj-merge-rows": 10, "tombstone-rows": 0, "duration": "14.961333ms", "extra-info": {"a-objs": "3651f6e3fe77_0,", "a-tombstones": "", "to-objs": "aa6916650c44_0,"}}
2024/11/25 18:23:40.174458 +0800 INFO cn-service.logtail-server handle subscription asynchronously {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "table": "db_id:16384 tb_id:16385 "}
2024/11/25 18:23:40.177006 +0800 INFO cn-service.logtail-server send subscription response {"uuid": "", "server-id": "019362d9-2b4c-78b6-a9da-1c50aee4462a", "stream-id": 1, "remote": "", "table": "db_id:16384 tb_id:16385 db_name:\"db1\" tb_name:\"test1\" ", "To": "PhysicalTime:1732530220175092000 "}
2024/11/25 18:23:40.177696 +0800 INFO logtailreplay/partition_state.go:659 PS-CREATED {"table-id": 16385, "service": "", "addr": "0xc05edc2140"}
2024/11/25 18:23:40.178304 +0800 INFO disttae/logtail_consumer.go:1269  [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385] resp received, 0xc052ad0e30
2024/11/25 18:23:40.178463 +0800 INFO disttae/logtail_consumer.go:403 [logtail-consumer] subscribe tbl[db: 16384, tbl: 16385, test1] succeed
2024/11/25 18:23:40.181591 +0800 INFO mergesort/task.go:223 [MERGE-START] {"task": "[MT-160]-16385-test1", "txn-info": "ctx[019362D92C9573D483105C2277EFECE2][1732530220180969000-0->9223372036854775807-4294967295][Active]: <nil>", "host": "TN", "timestamp": "1732530220180969000-0", "from-objs": "3f423b04ef80_0(1, 1.216KiB)Rows(10),aa6916650c44_0(1, 1.216KiB)Rows(10),", "from-size": "2.432KiB", "est-size": "400B", "num-obj": 2, "num-blk": 2, "rows": 20}
2024/11/25 18:23:40.190004 +0800 INFO mergesort/task.go:259 [MERGE-END] {"task": "[MT-160]-16385-test1", "to-objs": "7addd47dc519_0(1, 1.255KiB)Rows(20),", "to-size": "1.255KiB", "duration": "8.528959ms"}
2024/11/25 18:23:40.204257 +0800 INFO txnentries/mergeobjects.go:445 [MERGE-PREPARE-COMMIT] {"table-id": 16385, "task": "[MT-160]-16385-test1", "total-transfer": 0, "in-queue-transfer": 0, "total-cost": "34.708µs", "this-tran-cost": "3.167µs", "commit-ts": "1732530220204071000-0"}
2024/11/25 18:23:40.988519 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1778-7abe-81f2-3c34b8c37235", "stream-id": 1, "remote": "", "sendRound": 38}
2024/11/25 18:23:41.046656 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d7-a177-75df-b179-c33acc6f8bed", "stream-id": 1, "remote": "", "sendRound": 41}
2024/11/25 18:23:41.208637 +0800 INFO testutil/disttae_engine.go:241 wait logtail, latestAppliedTS: 2024-11-25 10:23:41.200883 +0000 UTC, targetTS: 2024-11-25 10:23:40.208387 +0000 UTC, done: true, subscriberReady: true

dataObjects:{iobj-1, iblk-1, irow-20; dobj-4, dblk-4, drow-40};
InmemRows:{visible-0, invisible-0};
checkpoint:{0};
visible objects:   [[OBJ(010)-(019362d9-2c95-758d-a69a-7addd47dc519_00000)|Ext(1_348_230_839)|Rows(20)|Blks(1)|Size(642)|OSize(1285)]; appendable: false; sorted: true; createTS: 1732530220204071000-0; deleteTS: 0-0]
invisible objects: [[OBJ(100)-(019362d9-2bf3-7e21-838c-c03211c7ee60_00000)|Ext(1_474_299_1335)|Rows(10)|Blks(1)|Size(837)|OSize(2305)]; appendable: true; sorted: false; createTS: 1732530220020018000-0; deleteTS: 1732530220047077000-0 [OBJ(010)-(019362d9-2bf8-7766-92b1-3f423b04ef80_00000)|Ext(1_308_230_839)|Rows(10)|Blks(1)|Size(602)|OSize(1245)]; appendable: false; sorted: true; createTS: 1732530220047077000-0; deleteTS: 1732530220204071000-0 [OBJ(100)-(019362d9-2c12-73d8-bafc-3651f6e3fe77_00000)|Ext(1_484_299_1335)|Rows(10)|Blks(1)|Size(847)|OSize(2305)]; appendable: true; sorted: false; createTS: 1732530220050379000-0; deleteTS: 1732530220067990000-0 [OBJ(010)-(019362d9-2c15-71b5-98c1-aa6916650c44_00000)|Ext(1_315_233_839)|Rows(10)|Blks(1)|Size(612)|OSize(1245)]; appendable: false; sorted: true; createTS: 1732530220067990000-0; deleteTS: 1732530220204071000-0]
visible tombstone: {0 0 0}
invisible tombstone objects: {0 0 0}

2024/11/25 18:23:41.305817 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select count(*) from `db1`.`test1`;", "txn-id": "cbf29ce484222325180b2f0e3cf6ab76", "duration": "2.384291ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:23:41.313969 +0800 INFO disttae/transfer.go:154 CN-TRANSFER-TOMBSTONE-OBJ {"newDataObjects": 1, "deletedObjects": 2, "origin-tombstoneObjects": 1, "coarse-tombstoneObjects": 1, "txn-id": "cbf29ce484222325180b2f0e3cf6ab74/Active/S:1732530221303024000-1", "table": "db1(16384)-test1(16385)", "time-spent": "7.812208ms", "transferred-row-cnt": 20, "new-files": "e019c8aa2d15_0", "from": "1732530220121185000-1", "to": "1732530221303024000-1", "transferred obj": "map[3f423b04ef80_0:10 aa6916650c44_0:10]"}
2024/11/25 18:23:41.314308 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Tombstone {"txn-id": "cbf29ce484222325180b2f0e3cf6ab74/Active/S:1732530221303024000-1", "table-id": 16385, "table-name": "test1", "obj-cnt": 1, "obj-osize": "2.22KiB", "obj-size": "1.085KiB", "blk-cnt": 1, "row-cnt": 20, "names": ["a4e6288f6797_0"]}
2024/11/25 18:23:41.314435 +0800 INFO rpc/utils.go:149 CN-COMMIT-S3-Tombstone {"txn-id": "cbf29ce484222325180b2f0e3cf6ab74/Active/S:1732530221303024000-1", "table-id": 16385, "table-name": "test1", "obj-cnt": 1, "obj-osize": "2.22KiB", "obj-size": "1.043KiB", "blk-cnt": 1, "row-cnt": 20, "names": ["e019c8aa2d15_0"]}
2024/11/25 18:23:41.323429 +0800 INFO txnimpl/table.go:383 TN-TRANSFER-TOMBSTONE-FILES {"table": "test1", "phase": "Phase_Freeze", "from": "0-1", "to": "1732530221315400000-0", "s-cnt": 4, "txn": "ctx[CBF29CE484222325180B2F0E3CF6AB74][1732530221303024000-1->9223372036854775807-4294967295][Active]: <nil>"}
2024/11/25 18:23:41.382318 +0800 INFO compile/sql_executor.go:369 sql_executor exec {"sql": "select count(*) from `db1`.`test1`;", "txn-id": "cbf29ce484222325180b2f0e3cf6ab77", "duration": "2.917375ms", "BatchSize": 1, "retry-times": 0, "AffectedRows": 0}
2024/11/25 18:23:41.382676 +0800 ERROR disttae/logtail_consumer.go:562 [logtail-consumer] receive an error from log tail client, err: context canceled
2024/11/25 18:23:41.382715 +0800 INFO disttae/logtail_consumer.go:931 [logtail-consumer] unsubscribe process exit.
2024/11/25 18:23:41.382761 +0800 ERROR disttae/logtail_consumer.go:617 [logtail-consumer] receive one logtail failed, err: context canceled
2024/11/25 18:23:41.382779 +0800 INFO disttae/logtail_consumer.go:672 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:41.382658 +0800 INFO disttae/logtail_consumer.go:1000 [logtail-consumer] GC partition_state process exit.
2024/11/25 18:23:41.382809 +0800 INFO db/open.go:384 tae metrics task exit
2024/11/25 18:23:41.382808 +0800 INFO disttae/logtail_consumer.go:261 [logtail-consumer] logtail consumer stopped
2024/11/25 18:23:41.382932 +0800 INFO disttae/logtail_consumer.go:606 [logtail-consumer] logtail receiver paused
2024/11/25 18:23:41.383115 +0800 INFO disttae/logtail_consumer.go:647 [logtail-consumer] reconnect signal is received
2024/11/25 18:23:41.393047 +0800 INFO gc/manager.go:152 gc-loop is going to exit
2024/11/25 18:23:41.398237 +0800 INFO db/scanner.go:56 DBScanner Stopped
2024/11/25 18:23:41.403914 +0800 INFO db/scheduler.go:86 TaskScheduler Stopped
2024/11/25 18:23:41.404072 +0800 INFO txnbase/txnmgr.go:622 [Stop] {"txnmgr": {}}
PASS
2024/11/25 18:23:41.647605 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-1e9e-793b-a363-d2778f79c572", "stream-id": 1, "remote": "", "sendRound": 16}
2024/11/25 18:23:42.010358 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d8-210b-7c87-bbd5-95685912428a", "stream-id": 1, "remote": "", "sendRound": 9}
2024/11/25 18:23:42.359226 +0800 INFO cn-service.logtail-server send logtail channel blocked {"uuid": "", "server-id": "019362d9-0473-7b69-9e1b-00bfab317d42", "stream-id": 1, "remote": "", "sendRound": 52}
ok  	github.com/matrixorigin/matrixone/pkg/vm/engine/test	120.188s
